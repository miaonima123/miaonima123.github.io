<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ES6 | My Web Blog</title><meta name="keywords" content="JavaScript新语法"><meta name="author" content="Mc,1148567490@qq.com"><meta name="copyright" content="Mc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="JavaScript的ES6怎么来的 ECMAScript 和 JavaScript  ECMA 是标准，JS 是实现 ECMAScript 简称 ECMA 或 ES   历史版本  1996, ES1.0 Netscape 将 JS 提交给 ECMA 组织，ES 正式出现  1999, ES3.0 被广泛支持  2011, ES5.1 成为 ISO 国际标准  2015, ES6.0 正式发布">
<meta property="og:type" content="article">
<meta property="og:title" content="ES6">
<meta property="og:url" content="https://mcweblog.com/2019/06/28/ES6/index.html">
<meta property="og:site_name" content="My Web Blog">
<meta property="og:description" content="JavaScript的ES6怎么来的 ECMAScript 和 JavaScript  ECMA 是标准，JS 是实现 ECMAScript 简称 ECMA 或 ES   历史版本  1996, ES1.0 Netscape 将 JS 提交给 ECMA 组织，ES 正式出现  1999, ES3.0 被广泛支持  2011, ES5.1 成为 ISO 国际标准  2015, ES6.0 正式发布">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://miaochen.mcweblog.com/img%2Fwq5m26.png">
<meta property="article:published_time" content="2019-06-28T07:21:50.000Z">
<meta property="article:modified_time" content="2022-05-19T13:05:20.425Z">
<meta property="article:author" content="Mc">
<meta property="article:tag" content="JavaScript新语法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://miaochen.mcweblog.com/img%2Fwq5m26.png"><link rel="shortcut icon" href="https://miaochen.mcweblog.com/img%2Ffav.png"><link rel="canonical" href="https://mcweblog.com/2019/06/28/ES6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9674ba6a680d75df31ead929ddeeae4e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ES6',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-19 21:05:20'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.1"><link rel="alternate" href="/atom.xml" title="My Web Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://miaochen.mcweblog.com/img%2F2020_09_11_22_32_IMG_6232.JPG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://miaochen.mcweblog.com/img%2Fwq5m26.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">My Web Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ES6<a class="post-edit-link" href="null_posts/ES6.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-06-28T07:21:50.000Z" title="发表于 2019-06-28 15:21:50">2019-06-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-05-19T13:05:20.425Z" title="更新于 2022-05-19 21:05:20">2022-05-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">42.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>163分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ES6"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="JavaScript的ES6怎么来的"><a href="#JavaScript的ES6怎么来的" class="headerlink" title="JavaScript的ES6怎么来的"></a>JavaScript的ES6怎么来的</h2><ul>
<li><p>ECMAScript 和 JavaScript</p>
<ul>
<li>ECMA 是标准，JS 是实现</li>
<li>ECMAScript 简称 ECMA 或 ES</li>
</ul>
</li>
<li><p>历史版本</p>
<ul>
<li><p>1996, ES1.0 Netscape 将 JS 提交给 ECMA 组织，ES 正式出现</p>
</li>
<li><p>1999, ES3.0 被广泛支持</p>
</li>
<li><p>2011, ES5.1 成为 ISO 国际标准</p>
</li>
<li><p>2015, ES6.0 正式发布</p>
<span id="more"></span></li>
</ul>
</li>
</ul>
<h2 id="ES6兼容性"><a href="#ES6兼容性" class="headerlink" title="ES6兼容性"></a>ES6兼容性</h2><ul>
<li><p>ES6(ES2015) 支持的环境 IE10+, Chrome, FireFox, 移动端, NodeJS</p>
</li>
<li><p>解决不兼容办法，编译、转换</p>
<ul>
<li>在线转换</li>
<li>或者提前编译</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.babeljs.cn/">Babel 中文网</a></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/01/babel.html">Babel 入门教程 阮一峰</a></p>
</li>
<li><p>Babel 是一个 JavaScript 编译器</p>
</li>
<li><p>SystemJS是一个体积小的打包工具</p>
</li>
<li><p>一个广泛使用的转码器，可以将ES6代码转为ES5代码，从而在现有环境执行</p>
</li>
<li><p>现在就用 ES6 编写程序，而不用担心现有环境是否支持</p>
<ul>
<li>```html<script src="browser.js"></script>
<script text/babel>es6等语句</script>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## let和const以及var声明区别</span><br><span class="line"></span><br><span class="line">**变量提升：使用`var`声明变量，变量的创建并不在声明变量的地方，而是会在当前作用域的顶部。**</span><br><span class="line"></span><br><span class="line">如果声明在函数内，则变量的创建则会在函数作用域的顶部；如果声明不在函数内，则会提升到全局作用域的顶部。</span><br><span class="line"></span><br><span class="line">&gt; 示例</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">function getValue(condition)&#123;</span><br><span class="line">	if(condition)&#123;</span><br><span class="line">		var value = &quot;yes&quot;;</span><br><span class="line">		return value;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//value 在此处可访问，值为 undefined</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line">	//value 在此处可访问，值为 undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>等价于（var变量提升到当前函数作用域的顶部）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getValue</span>(<span class="params">condition</span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> value;</span><br><span class="line">	<span class="keyword">if</span>(condition)&#123;</span><br><span class="line">		value = <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">//value 在此处可访问，值为 undefined</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//value 在此处可访问，值为 undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>由变量提升会带来循环变量过度共享的问题</p>
</blockquote>
<h3 id="let声明"><a href="#let声明" class="headerlink" title="let声明"></a>let声明</h3><p>与var声明变量语法一致，但是let声明变量不会<strong>变量提升</strong>，变量的作用域只会限制在当前代码块中。由于let变量并不会提升到代码块的顶部，因此，要想让整个代码块能给访问到let变量，需要将let声明指定到代码块的顶部。</p>
<blockquote>
<p>示例</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getValue</span>(<span class="params">condition</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(condition)&#123;</span><br><span class="line">		<span class="keyword">let</span> value = <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">//value 在此处不可访问</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//value 在此处不可访问</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<blockquote>
<p>let变量禁止重复声明：如果一个标识符已经在代码块内部中被定义，那么使用let以同样的标识符声明变量则会报错</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">示例：</span><br><span class="line"><span class="keyword">var</span> count = <span class="number">43</span>；</span><br><span class="line"><span class="keyword">let</span> count; <span class="comment">//重复声明，报错</span></span><br></pre></td></tr></table></figure>

<h3 id="const声明"><a href="#const声明" class="headerlink" title="const声明"></a>const声明</h3><blockquote>
<p>const声明基本变量</p>
</blockquote>
<p><strong>const声明：使用const声明一个常量，一旦设置之后就不能再被修改，否则会报错。也就是说，使用const声明变量后要立即初始化</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> type;</span><br><span class="line">type=<span class="string">&#x27;TEST&#x27;</span>; <span class="comment">//Uncaught SyntaxError: Missing initializer in const declaration</span></span><br><span class="line"></span><br><span class="line">正确的为：</span><br><span class="line"><span class="keyword">const</span> type=<span class="string">&#x27;TEST&#x27;</span></span><br><span class="line">-----------------------------</span><br><span class="line"><span class="keyword">const</span> type=<span class="string">&#x27;TEST&#x27;</span></span><br><span class="line">type = <span class="string">&#x27;DEBUG&#x27;</span> <span class="comment">//ObjectMethod.html:244 Uncaught TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>const声明对象</p>
</blockquote>
<p><strong>const只会阻止变量绑定以及变量的修改，但是不会阻止对象成员变量的修改。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;<span class="attr">name</span>:<span class="string">&#x27;nancy&#x27;</span>&#125;;</span><br><span class="line">person.<span class="property">name</span>= <span class="string">&#x27;nike&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">//nike</span></span><br><span class="line">person = &#123;&#125;; <span class="comment">//Uncaught TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>

<h3 id="let与const的比较"><a href="#let与const的比较" class="headerlink" title="let与const的比较"></a>let与const的比较</h3><blockquote>
<p>相同点</p>
</blockquote>
<ol>
<li><p><strong>不存在变量提升</strong>：let与const声明变量都不会存在<strong>变量提升</strong>，都只在块级作用域内，如果试图在代码块外访问let或者const变量都会报错；</p>
</li>
<li><p><strong>禁止重复声明</strong>：如果在同一作用域内，禁止let或者const使用以被定义的标识符声明变量；</p>
</li>
<li><p><strong>都具有暂时性死区（temporal dead zone，TDZ ）</strong>：使用let或者const声明变量，如果在声明处之前访问变量会报错。在变量当前作用域的块内，变量声明处之前被称之为TDZ。</p>
</li>
<li><p><strong>不会覆盖全局对象上的属性</strong>：let变量或者const变量会在全局作用域上创建新的变量，但是不会绑定到全局对象上（浏览器则是window对象），而var变量在全局作用域上会绑定到全局对象，也就是说，var全局变量可能会无意覆盖掉全局对象上的一些属性。</p>
<p>var RegExp = ‘hello’;</p>
<pre><code>console.log(window.RegExp);        //hello
</code></pre>
<h2 id="console-log-window-RegExp-RegExp-RegExp覆盖掉window对象中的RegExp属性"><a href="#console-log-window-RegExp-RegExp-RegExp覆盖掉window对象中的RegExp属性" class="headerlink" title="console.log(window.RegExp===RegExp); //RegExp覆盖掉window对象中的RegExp属性"></a>console.log(window.RegExp===RegExp); //RegExp覆盖掉window对象中的RegExp属性</h2><p>​    let RegExp = ‘hello’;<br>​    console.log(window.RegExp);<br>​    console.log(window.RegExp===RegExp); //false</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getValue</span>(<span class="params">condition</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(condition)&#123;</span><br><span class="line">		<span class="comment">//value的TDZ</span></span><br><span class="line">		<span class="keyword">let</span> value = <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>不同点</p>
</blockquote>
<ol>
<li><p>const不能再赋值，let声明的变量可以重复赋值;</p>
<p>​    </p>
</li>
</ol>
<h3 id="块级绑定的使用场景"><a href="#块级绑定的使用场景" class="headerlink" title="块级绑定的使用场景"></a>块级绑定的使用场景</h3><ol>
<li><p>循环内的let声明</p>
<p>在循环中使用var变量，由于var变量存在变量提升，每次迭代共享同一个var变量。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//输出5</span></span><br><span class="line">	&#125;,<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//输出5</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>解决方法：将var变量改为let变量</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将var改成let之后</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i) <span class="comment">// 0,1,2,3,4</span></span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)<span class="comment">//Uncaught ReferenceError: i is not defined i无法污染外部函数</span></span><br></pre></td></tr></table></figure>

<p>let变量不会变量提升，let变量作用域不会逃离出for循环外，因此不会污染外部函数。而在for循环中也不会每次迭代都共享同一变量，而是会分别使用let变量副本。</p>
</li>
<li><p>循环内const声明</p>
<p>在普通的for循环中使用const变量，由于const变量不可修改，因此会报错。而在for-in或者for-of循环中可以使用const变量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let arr = [1,2,3,4];</span><br><span class="line">for(const item of arr)&#123;</span><br><span class="line">	console.log(item); //输出1,2,3,4</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.var变量提升</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getValue</span>(<span class="params">condition</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(condition)&#123;</span><br><span class="line">		<span class="comment">//value的TDZ</span></span><br><span class="line">		<span class="keyword">let</span> value = <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getValue</span>(<span class="literal">false</span>));</span><br><span class="line"><span class="keyword">const</span> type=<span class="string">&#x27;TEST&#x27;</span></span><br><span class="line">type = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(type);	</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.const声明对象，可以修改成员</span></span><br><span class="line"><span class="keyword">const</span> person = &#123;<span class="attr">name</span>:<span class="string">&#x27;nancy&#x27;</span>&#125;;</span><br><span class="line">person.<span class="property">name</span>= <span class="string">&#x27;nike&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>);</span><br><span class="line">person = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">	&#125;,<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.const变量可以用于for-in和for-of循环</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> arr)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//let和const变量不会覆盖全局对象上的属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">RegExp</span> = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">RegExp</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">RegExp</span>===<span class="title class_">RegExp</span>);</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol>
<li>let和const变量都不会进行提升，并且只会在声明它们的代码块内部存在。由于变量能够在必要位置被准确声明，其表现更加接近其他语言；</li>
<li>块级绑定存在暂时性死区（TDZ ） ，试图在声明位置之前访问它就会导致错误；</li>
<li>let 与 const 的表现在很多情况下都相似于 var ，然而在循环中就不是这样。在 for-in<br>与 for-of 循环中， let 与 const 都能在每一次迭代时创建一个新的绑定，这意味着在循环体内创建的函数可以使用当前迭代所绑定的循环变量值（而不是像使用 var 那样，共享同一变量值）。同时在基础的for循环中，使用const变量会出错。</li>
</ol>
<p><strong>最佳实践</strong>：在默认情况下使用 const ，而只在你知道变量值需要被更改的情况下才使用 let 。</p>
<h2 id="字符串处理方法"><a href="#字符串处理方法" class="headerlink" title="字符串处理方法"></a>字符串处理方法</h2><blockquote>
<p>codePointAt()方法</p>
</blockquote>
<p>ES6 为全面支持 UTF-16 而新增的方法之一是 <code>codePointAt(</code>) ，它可以在给定字符串中按位<br>置提取 <code>Unicode</code> 代码点。该方法接受的是码元位置而非字符位置，并返回一个整数值。</p>
<blockquote>
<p>String.fromCodePoint()方法</p>
</blockquote>
<p>可以使用<code>codePointAt()</code> 来提取字符串内中某个字符的代码点，也可以借助 <code>String.fromCodePoint()</code>用给定的代码点来产生包含单个字符的字符串</p>
<blockquote>
<p>normalize()方法</p>
</blockquote>
<p>Unicode 另一个有趣之处是，不同的字符在排序或其它一些比较操作中可能会被认为是相同<br>的。有两种方式可以定义这种关联性：第一种是<strong>规范相等性</strong>（canonical equivalence ） ，<br>意味着两个代码点序列在所有方面都被认为是可互换的。例如，两个字符的组合可以按规范<br>等同于另一个字符。第二种<strong>关联性是兼容性</strong>（compatibility ） ，两个兼容的代码点序列看起<br>来有差别，但在特定条件下可互换使用。</p>
<p>ES6 给字符串提供了** normalize()** 方法，以支持 Unicode 标准形式。因此，在比较字符时，可以先将字符用同一种标准化方法，让它们标准化，再进行比较，例如，比较字符数组中的大小：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> compare = <span class="keyword">function</span>(<span class="params">values=[]</span>)&#123;</span><br><span class="line">	values.<span class="title function_">sort</span>(<span class="function">(<span class="params">first,second</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="keyword">let</span> firstNormalized = first.<span class="title function_">normalize</span>();</span><br><span class="line">		<span class="keyword">let</span> secondNormalized = second.<span class="title function_">normalize</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (firstNormalized &lt; secondNormalized) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (firstNormalized === secondNormalized) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;g&#x27;</span>];</span><br><span class="line"><span class="title function_">compare</span>(arr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);<span class="comment">//[&quot;a&quot;, &quot;c&quot;, &quot;g&quot;, &quot;z&quot;]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>识别子字符串的方法</p>
</blockquote>
<p>为了识别字符串是否存在于其他字符串中，ES6提供了相应的方法来满足这类需求：</p>
<ul>
<li>includes()方法：在给定文本存在于字符串中的任意位置时会返回 <code>true</code>，否则会返回 <code>false</code>；</li>
<li>startsWith() 方法：在给定文本出现在字符串起始处时返回 <code>true</code> ，否则返回 <code>false</code> ；</li>
<li>endsWith() 方法：在给定文本出现在字符串结尾处时返回 <code>true</code> ，否则返回 <code>false</code> 。</li>
</ul>
<p>每个方法都接受两个参数：需要搜索的文本，以及可选的搜索起始位置索引。当提供了第二<br>个参数时， <code>includes()</code> 与 <code>startsWith() </code>方法会从该索引位置开始尝试匹配；当第二个参数未提供时， <code>includes()</code> 与 <code>startsWith(</code>) 方法会从字符串起始处开始查找，而 <code>endsWith() </code>方法则从尾部减去第二个参数后的位置作为起始位置。</p>
<blockquote>
<p>repeat()方法</p>
</blockquote>
<p>ES6 还为字符串添加了一个 repeat() 方法，它接受一个参数作为字符串的重复次数，返回一个将初始字符串重复指定次数的新字符串。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//repeat()方法</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;x&#x27;</span>.<span class="title function_">repeat</span>(<span class="number">3</span>)); <span class="comment">//xxx</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello world&#x27;</span>.<span class="title function_">repeat</span>(<span class="number">2</span>)); <span class="comment">//hello worldhello world</span></span><br></pre></td></tr></table></figure>

<h3 id="模板字面量"><a href="#模板字面量" class="headerlink" title="模板字面量"></a>模板字面量</h3><blockquote>
<p>基本语法</p>
</blockquote>
<p>模板字面量的最简单语法，是使用反引号<code>（ </code> ）` 来包裹普通字符串，而不是用双引号或单引号，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板字面量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span>  message = <span class="string">`hello world`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message); <span class="comment">//hello world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> message); <span class="comment">//string</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="property">length</span>); <span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<p>若想字符串中包含反引号，可以使用反斜杠<code>（\）</code>进行转义即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span>  message = <span class="string">`\`hello world\``</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message); <span class="comment">//`hello world`</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>多行字符串</p>
</blockquote>
<p>使用模板字面量可以轻松创建多行字符串，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">`hello</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">world`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">输出：</span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">		world</span><br></pre></td></tr></table></figure>

<blockquote>
<p>替换位</p>
</blockquote>
<p><strong>替换位可以嵌入到模板字面量中，替换位最终可以转换为字符串的一部分输出。替换位可以是任意的js表达式。</strong>替换位的语法采用 <code>$&#123;&#125;</code> 表示。</p>
<p>例如，替换位为变量：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> msg = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> message = <span class="string">`<span class="subst">$&#123;msg&#125;</span> world`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message); <span class="comment">//hello world</span></span><br></pre></td></tr></table></figure>

<p><strong>替换位不仅仅可以是简单的变量，还可以嵌入计算表达式、函数调用等，甚至还可以将模板字面量作为替换位嵌入到另一个模板字面量中。</strong></p>
<h3 id="模板标签"><a href="#模板标签" class="headerlink" title="模板标签"></a>模板标签</h3><p>一个<strong>模板标签</strong>（template tag ） 能对模板字面量进行转换并返回最终的字符串值，标签在模板的起始处被指定，即在第一个 ` 之前。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let message = tag`Hello world`;</span><br></pre></td></tr></table></figure>

<p> <code>tag</code> 就是会被应用到 <code>Hello world</code> 模板字面量上的模板标签。</p>
<blockquote>
<p>定义标签</p>
</blockquote>
<p>一个标签（tag ） 仅是一个函数，它被调用时接收需要处理的模板字面量数据。标签所接收的数据被划分为独立片段，并且必须将它们组合起来以创建结果。第一个参数是个数组，包含被 JS 解释过的字面量字符串，随后的参数是每个替换位的解释值。</p>
<p>标签函数的参数一般定义为剩余参数形式，以便更容易处理数据，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tag</span>(<span class="params">literals, ...substitutions</span>) &#123;</span><br><span class="line"><span class="comment">// 返回一个字符串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用模板字面量中的原始值</p>
</blockquote>
<p><strong>模板标签也能访问字符串的原始信息，主要指的是可以访问字符在转义之前的形</strong>式。获取原始字符串值的最简单方式是使用内置的 <code>String.raw()</code> 标签。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message1 = <span class="string">`Multiline\nstring`</span>,</span><br><span class="line">message2 = <span class="title class_">String</span>.<span class="property">raw</span><span class="string">`Multiline\nstring`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message1); <span class="comment">// &quot;Multiline</span></span><br><span class="line">					   <span class="comment">// string&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message2); <span class="comment">// &quot;Multiline\nstring&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="正则表达式的改动"><a href="#正则表达式的改动" class="headerlink" title="正则表达式的改动"></a>正则表达式的改动</h3><ol>
<li><p>正则表达式<code>u</code>标识：你可以使用正则表达式来完成字符串的很多通用操作。但要记住，正则表达式假定单个字符使用一个 16 位的码元来表示。为了解决这个问题， ES6 为正则表达式定义了用于处理Unicode 的 <code>u</code> 标志。当一个正则表达式设置了 <code>u </code>标志时，它的工作模式将切换到针对字符，而不是针对码元。</p>
</li>
<li><p>正则表达的<code>y</code>标志： <code>y</code> 标志影响正则表达式搜索时的粘连（ <code>sticky</code> ） 属性，它表示从正则表达式的 lastIndex 属性值的位置开始检索字符串中的匹配字符。如果在该位置没有匹配成功，那么正则表达式将停止检索；</p>
</li>
<li><p>复制正则表达式：使用RegExp构造器时允许使用第二个参数，并且让它覆盖第一个参数中的标志；</p>
</li>
<li><p>flag属性：ES6 新增了 flags 属性用于配合 source 属性，让标志的获取变得更容易。例如：</p>
<p>var re = /ab/g;</p>
<pre><code>console.log(re.source); // ab
console.log(re.flags); // g
</code></pre>
<p>本例查找了 re 的所有标志并将其打印到控制台，所用的代码量要比 <code>toString()</code> 方式少得多。同时使用 <code>source</code> 和 <code>flags</code> 允许你直接提取正则表达式的组成部分，而不必将正则表达式转换为字符串。</p>
</li>
</ol>
<h3 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//codePointAt()</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// var text = &quot;a&quot; ;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.charCodeAt(0)); // 55362</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.charCodeAt(1)); // 57271</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.charCodeAt(2)); // 97</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.codePointAt(0)); // 134071</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.codePointAt(1)); // 57271</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(text.codePointAt(2)); // 97</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//normalize()方法</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let compare = function(values=[])&#123;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 	values.sort((first,second)=&gt;&#123;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		let firstNormalized = first.normalize();</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		let secondNormalized = second.normalize();</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		if (firstNormalized &lt; secondNormalized) &#123;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 			return -1;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		&#125; else if (firstNormalized === secondNormalized) &#123;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 			return 0;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		&#125; else &#123;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 			return 1;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 		&#125;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 	&#125;)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let arr = [&#x27;a&#x27;,&#x27;z&#x27;,&#x27;c&#x27;,&#x27;g&#x27;];</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// compare(arr);</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(arr);//[&quot;a&quot;, &quot;c&quot;, &quot;g&quot;, &quot;z&quot;]</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// //repeat()方法</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(&#x27;x&#x27;.repeat(3)); //xxx</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(&#x27;hello world&#x27;.repeat(2)); //hello worldhello world</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//模板字面量</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let  message = `\`hello world\``;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message); //`hello world`</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(typeof message); //string</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message.length); //1</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let message = `hello</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// world`;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//模板字面量</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let msg = &#x27;hello&#x27;;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let message = `$&#123;msg&#125; world`;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message); //hello world</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// let message1 = `Multiline\nstring`,</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// message2 = String.raw`Multiline\nstring`;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message1); // &quot;Multiline</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 					   // string&quot;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// console.log(message2); // &quot;Multiline\nstring&quot;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">var</span> re = <span class="regexp">/ab/g</span>;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(re.<span class="property">source</span>); <span class="comment">// ab</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(re.<span class="property">flags</span>); <span class="comment">// g</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="函数相关"><a href="#函数相关" class="headerlink" title="函数相关"></a>函数相关</h2><ol>
<li><p>函数参数默认值</p>
<p>let defaultFunc = function(url,tomeout=2000,callback={}){};</p>
<pre><code>    //使用默认的timeout和callback
    defaultFunc(&#39;/url&#39;);
    //使用默认的callback
    defaultFunc(&#39;/url&#39;,100);
    //使用指定的timeout和callback
    defaultFunc(&#39;/url&#39;,100,function(body)&#123;
        doSomething(body);
    &#125;)
</code></pre>
<blockquote>
<p>函数参数默认值的指定顺序可以随意</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//需要指定默认参数的可选参数timeout，排在callback</span><br><span class="line">let defaultFunc = function(url,tomeout=2000,callback)&#123;&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>只有在未传递参数，或者参数为undefined时，才会使用默认参数，null值被认为是有效的</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//null被认为是有效的，不会使用timeout的默认值</span><br><span class="line">defaultFunc(&#x27;/url&#x27;,null,function(body)&#123;</span><br><span class="line">	doSomething(body);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>函数参数默认值表达式</p>
<p>除了直接使用具体值赋给函数参数默认值外，函数参数默认值还可以有表达式构成。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function getValue()&#123;return 5&#125;;</span><br><span class="line">function test(a,b=getValue())&#123;</span><br><span class="line">	return a+b;</span><br><span class="line">&#125;</span><br><span class="line">//调用getValue</span><br><span class="line">console.log(test(1)); //6</span><br><span class="line">//不使用b的默认值s</span><br><span class="line">console.log(test(1,2)); //3</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>可以使用前面的参数，来作为后面参数的默认值。前面的参数默认值不能引用后面的参数值</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function add(a,b=1)&#123;return a+b&#125;;  </span><br><span class="line">console.log(add(1,1));  //2</span><br><span class="line">function addition(a=b,b)&#123;return a+b&#125;;</span><br><span class="line">console.log(addition(undefined,1)); //Uncaught ReferenceError: b is not defined</span><br></pre></td></tr></table></figure>

<blockquote>
<p>函数参数默认值存在暂时性死区（TDZ），在函数参数默认值表达式中，还未初始化赋值的参数值无法作为其他参数的默认值 </p>
</blockquote>
</li>
<li><p>函数参数默认值对arguments对象的影响</p>
<ul>
<li><p>ES5中，在非严格模式下，arguments对象能够反映出具名参数的变化，当具名参数值更新的时候，arguments对象中相应的元素值也会更新。在严格模式下不能反映出具名参数的变化</p>
<p>function testArgs(a,b){</p>
<pre><code>    console.log(a===arguments[0]); //true
    console.log(b===arguments[1]); //true
    a=&#39;c&#39;;
    b=&#39;d&#39;;
    console.log(a===arguments[0]); //true
    console.log(b===arguments[1]); //true
&#125;
testArgs(&#39;a&#39;,&#39;b&#39;);
</code></pre>
</li>
<li><p>在ES6中，参数默认值与arguments对象分离，即被赋予参数默认值的参数无法从arguments对象中获取。另外，无论是非严格模式下，还是在严格模式下，具名参数的更改都不会在arguments对象中更新。  </p>
</li>
</ul>
</li>
</ol>
<h3 id="剩余参数"><a href="#剩余参数" class="headerlink" title="剩余参数"></a>剩余参数</h3><p>ES6中，当参数个数无法确定时，可以使用剩余参数（rest parameter）来表示，剩余参数就相当于一个容器，调用函数时传入几个参数值，这个容器就装载几个参数值。剩余参数能够将多个独立的参数合并到一个数组中去，剩余参数表示为<code>...keys</code>,有三个点加上一个具名参数标识符组成。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">rp</span>(<span class="params">...keys</span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(keys.<span class="property">length</span>)&#125;</span><br><span class="line"><span class="title function_">rp</span>(<span class="number">1</span>,<span class="number">2</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>具名参数只能放在参数组最后面，并且只能有且仅有一个剩余参数。剩余参数不能作为对象字面量的setter属性</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="keyword">set</span> <span class="title function_">name</span>(<span class="params">...names</span>); <span class="comment">//Setter function argument must not be a rest parameter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>在Function构造器中能够将函数体以字符串的形式作为函数的参数，并且支持参数默认值以及剩余参数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> add = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;first&quot;</span>,<span class="string">&quot;second&quot;</span>,<span class="string">&quot;return first+second&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">1</span>)); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<h3 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h3><p>扩展运算符能够将数组分离，将分割后单独的参数值传递给函数，能够替代apply()方法的使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="number">0</span>,...[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]));  <span class="comment">//0</span></span><br></pre></td></tr></table></figure>

<h3 id="new-target属性"><a href="#new-target属性" class="headerlink" title="new.target属性"></a>new.target属性</h3><p>能够使用<code>new.target</code>属性来判断函数是否利用<code>new</code>来进行调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">target</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">new</span>.<span class="property">target</span>!==<span class="string">&#x27;undefined&#x27;</span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;通过new来调用&#x27;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不是通过new来调用&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="块级函数"><a href="#块级函数" class="headerlink" title="块级函数"></a>块级函数</h3><p>在代码块中能够声明函数，函数也被称之为<strong>块级函数</strong>，在严格模式下，块级函数会提升到当前所处代码块的顶部，在整个代码块中都能够被访问，在代码块外的地方就不能被访问。而在非严格模式下，块级函数会被提升到全局作用域。</p>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>箭头函数提供了一种更加简洁的函数书写方式，并且与传统函数有很多不同的地方。箭头函数基本的语法为：<code>参数 =&gt; 函数体</code>。</p>
<p>根据参数的个数以及函数体的行数有多种变形：</p>
<ol>
<li>无参数时，可以使用圆括号()表示；当只有一个参数时可以省略圆括号()；当有多个参数时可以使用圆括号包裹，并参数之间用逗号进行分隔；</li>
<li>当函数体有多行语句时，使用大括号{}包裹起来，就像写正常的函数一样；当只有一行语句时，并需要返回结果时，可以省去大括号{}，结果会自动返回。</li>
<li>如果需要返回对象的话，需要使用圆括号()将对象包裹起来，为了防止对象字面量被认为是函数体语句。</li>
</ol>
<p>箭头函数的特性：</p>
<ol>
<li><p>没有this、super、arguments，new.target绑定：this、super、arguments以及内部函数的new.target的值由所在的最近的外部非箭头函数来决定；</p>
</li>
<li><p>没有arguments对象绑定，但是能够访问包含它的外部函数的arguments对象；</p>
<p>let outer = function(arg){</p>
<pre><code>    return ()=&gt;arguments[0];
&#125;
let inner = outer(7);
console.log(inner()) //7
</code></pre>
</li>
<li><p>不能使用new来调用：箭头函数没有[[Construct]]方法，因此不能被用为构造函数，使用new调用函数会抛出错误；</p>
</li>
<li><p>没有原型：没有使用new，因此没有prototype属性；</p>
</li>
<li><p>不能修改this：不能通过call(),apply()以及bind()方法修改this；</p>
</li>
<li><p>不允许使用重复的具名参数：箭头函数不允许拥有重复的具名参数，无论是否在严格模式下；而传统函数只有在严格模式下才禁止使用重复的具名参数；</p>
</li>
</ol>
<h3 id="尾调用优化"><a href="#尾调用优化" class="headerlink" title="尾调用优化"></a>尾调用优化</h3><p>尾调用是指在一个函数内最后的语句调用了另外一个函数，这个函数会重新创建新的栈帧并置于调用栈之上，如果调用次数过多，会导致内存过大。当满足以下条件时，执行引擎会针对尾调用进行优化，不再重新创建新的栈帧，而是会复用当前栈帧：</p>
<ol>
<li><p>尾调用不能引用当前栈帧中的变量；</p>
</li>
<li><p>进行尾调用的函数在尾调用返回结果后不能做额外任何操作；</p>
</li>
<li><p>尾调用的结果作为当前函数的返回值；</p>
<p>//尾递归优化</p>
<pre><code>&#39;use strict&#39;
</code></pre>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//满足尾调用优化条件</span></span><br><span class="line">	<span class="keyword">return</span> <span class="title function_">doElse</span>();</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> tmp = <span class="title function_">doElse</span>();</span><br><span class="line">	<span class="comment">//尾调用函数结果没有直接返回，因此不满足</span></span><br><span class="line">	<span class="comment">//尾调用优化条件</span></span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//尾调用函数后有其他额外操作，结果没有</span></span><br><span class="line">	<span class="comment">//立即返回，因此不满足尾调用优化条件</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>+<span class="title function_">doElse</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>由于闭包会持有外部函数的变量，因此对闭包的尾调用优化很难处理，但是，在递归操作中，可以利用到尾调用优化，减少栈帧个数，降低内存。</p>
<h3 id="案例-2"><a href="#案例-2" class="headerlink" title="案例"></a>案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//函数参数默认值</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> defaultFunc = <span class="keyword">function</span>(<span class="params">url,tomeout=<span class="number">2000</span>,callback=&#123;&#125;</span>)&#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">defaultFunc</span>(<span class="string">&#x27;/url&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">defaultFunc</span>(<span class="string">&#x27;/url&#x27;</span>,<span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">defaultFunc</span>(<span class="string">&#x27;/url&#x27;</span>,<span class="number">100</span>,<span class="keyword">function</span>(<span class="params">body</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="title function_">doSomething</span>(body);</span></span><br><span class="line"><span class="language-javascript">		&#125;)</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//ES5非严格模式下具名参数对arguments对象的影响</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">testArgs</span>(<span class="params">a,b</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="variable language_">console</span>.<span class="title function_">log</span>(a===<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">			<span class="variable language_">console</span>.<span class="title function_">log</span>(b===<span class="variable language_">arguments</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">			a=<span class="string">&#x27;c&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">			b=<span class="string">&#x27;d&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">			<span class="variable language_">console</span>.<span class="title function_">log</span>(a===<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">			<span class="variable language_">console</span>.<span class="title function_">log</span>(b===<span class="variable language_">arguments</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">testArgs</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//函数参数默认值表达式</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">getValue</span>(<span class="params"></span>)&#123;<span class="keyword">return</span> <span class="number">5</span>&#125;;</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">a,b=getValue()</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="keyword">return</span> a+b;</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">test</span>(<span class="number">1</span>));</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">test</span>(<span class="number">1</span>,<span class="number">2</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a,b=<span class="number">1</span></span>)&#123;<span class="keyword">return</span> a+b&#125;;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">1</span>));</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">addition</span>(<span class="params">a=b,b</span>)&#123;<span class="keyword">return</span> a+b&#125;;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">addition</span>(<span class="literal">undefined</span>,<span class="number">1</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">rp</span>(<span class="params">...keys</span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(keys.<span class="property">length</span>)&#125;</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">rp</span>(<span class="number">1</span>,<span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> person =&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="keyword">set</span> <span class="title function_">name</span>(<span class="params">...names</span>);</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">var</span> add = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;first&quot;</span>,<span class="string">&quot;second&quot;</span>,<span class="string">&quot;return first+second&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>,<span class="number">1</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//扩展运算符</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="number">0</span>,...[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//new.target属性</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">target</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="keyword">if</span>(<span class="keyword">new</span>.<span class="property">target</span>!==<span class="string">&#x27;undefined&#x27;</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">				<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;通过new来调用&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">			&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">				<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不是通过new来调用&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">			&#125;</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> test = <span class="keyword">new</span> <span class="title function_">target</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//箭头函数没有arguments对象绑定</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> outer = <span class="keyword">function</span>(<span class="params">arg</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="keyword">return</span> <span class="function">()=&gt;</span><span class="variable language_">arguments</span>[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> inner = <span class="title function_">outer</span>(<span class="number">7</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">inner</span>());</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//尾递归优化</span></span></span><br><span class="line"><span class="language-javascript">		<span class="string">&#x27;use strict&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//满足尾调用优化条件</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">return</span> <span class="title function_">doElse</span>();</span></span><br><span class="line"><span class="language-javascript">	&#125;	</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> tmp = <span class="title function_">doElse</span>();</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//尾调用函数结果没有直接返回，因此不满足</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//尾调用优化条件</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">return</span> tmp;</span></span><br><span class="line"><span class="language-javascript">	&#125;	</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//尾调用函数后有其他额外操作，结果没有</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//立即返回，因此不满足尾调用优化条件</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">return</span> <span class="number">1</span>+<span class="title function_">doElse</span>();</span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="对象类别"><a href="#对象类别" class="headerlink" title="对象类别"></a>对象类别</h2><p>对象有以下几种类别：</p>
<ul>
<li>普通对象：拥有JS对象所有默认的内部行为；</li>
<li>奇异对象：其内部行为在某些方面有别于默认行为；</li>
<li>标准对象：在ES6中被定义的对象，例如Array,Date等；</li>
<li>内置对象：在脚本开始运行的时候由JS运行环境提供的对象，所有的标准对象都是内置对象</li>
</ul>
<h3 id="对象字面量语法的扩展"><a href="#对象字面量语法的扩展" class="headerlink" title="对象字面量语法的扩展"></a>对象字面量语法的扩展</h3><blockquote>
<p>属性初始化的速记法</p>
</blockquote>
<p>属性初始化器的速记法可以用来消除属性名和本地变量的重复情况，可以使用作用域内的变量值赋值给同名属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">name,age</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		<span class="attr">name</span>:name,</span><br><span class="line">		<span class="attr">age</span>:age</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//由于属性名和本地变量名相同，可以采用</span></span><br><span class="line"><span class="comment">//属性初始化器的速记法，等价于</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">name,age</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		name,</span><br><span class="line">		age</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法简写</p>
</blockquote>
<p>在对象字面量的写法中，为一个对象添加一个方法，需要指定对象的属性以及具体的函数声明。ES6提供了一种方法简写语法，通过省略function关键字，能够让为对象添加方法的语法更加简洁。有一个重要的区别是：**方法简写能够使用<code>super</code>，而非简写的方法不能使用<code>super</code>**。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法简写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">	<span class="attr">sayName</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">	<span class="title function_">sayName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>需计算属性名</p>
</blockquote>
<p>需计算属性名规则允许对象字面量中属性名是变量、字符串字面量或者由变量计算而得的，具体写法是通过方括号[]包含属性名。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需计算属性名</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> firstName = <span class="string">&#x27;first name&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> suffix = <span class="string">&#x27;@github.com&#x27;</span></span><br><span class="line"><span class="keyword">let</span> email = <span class="string">&#x27;email&#x27;</span>;</span><br><span class="line"><span class="comment">//变量</span></span><br><span class="line">person[firstName] = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="comment">//字符串字面量</span></span><br><span class="line">person[<span class="string">&#x27;last name&#x27;</span>]= <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line"><span class="comment">//变量计算而得到的</span></span><br><span class="line">person[email+suffix] = <span class="string">&#x27;example@github.com&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Object.is()</p>
</blockquote>
<p>JS中比较两个值是否相同的时候会使用严格等于运算符<code>===</code>，但是，使用严格运算符式，+0和-0会认为这两者是相等的，而<code>NaN===NaN</code>是不相等的，使用Object.is()方法来判断这两者情况与使用严格相等符会有所不同，其他情况和使用严格相等运算符基本一致；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="number">0</span>==-<span class="number">0</span>);  <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="number">0</span>===-<span class="number">0</span>); <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(+<span class="number">0</span>,-<span class="number">0</span>)); <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>==<span class="title class_">NaN</span>); <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>===<span class="title class_">NaN</span>); <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="title class_">NaN</span>,<span class="title class_">NaN</span>)); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>==<span class="string">&#x27;5&#x27;</span>); <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>===<span class="string">&#x27;5&#x27;</span>); <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="number">5</span>,<span class="string">&#x27;5&#x27;</span>)) <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Object.assign()</p>
</blockquote>
<p>一个对象从另外一个对象获取属性和方法，这是典型的混入（Mixin）模式，Object.assign()方法可以更简洁的实现对象混入，该方法需要一个接受者对象和若干个供应者对象。接收者会按照供应者在参数中的顺序来依次接收它们的属性，这意味着，第二个供应者可能会覆盖第一个供应者相同的属性；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person=&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> car =&#123;</span><br><span class="line">	<span class="attr">brand</span>:<span class="string">&#x27;BWM&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(obj,person,car);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj); <span class="comment">//&#123;name: &quot;hello&quot;, age: 5, brand: &quot;BWM&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>Object.assign()方法并未在接受者上创建访问器属性，即使供应者拥有访问器属性，由于Object.assign()方法使用赋值运算符，供应者的访问器属性会转换成接受者的数据属性；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> receiver = &#123;&#125;,</span><br><span class="line">supplier = &#123;</span><br><span class="line">	<span class="keyword">get</span> <span class="title function_">name</span>() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;file.js&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(receiver, supplier);</span><br><span class="line"><span class="keyword">let</span> descriptor = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(receiver, <span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(descriptor.<span class="property">value</span>); <span class="comment">// &quot;file.js&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(descriptor.<span class="property">get</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>允许重复的属性</p>
</blockquote>
<p>在ES5严格模式下，为对象字面量中属性会检查是否重复，如果重复的话就会抛出一个错误。而在ES6中，无论是在严格模式下还是非严格模式下，都不再检查属性是否重复，当属性重复的时候，后面的属性会覆盖前面的属性；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重复的属性</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> person = &#123;</span><br><span class="line">		<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">		<span class="attr">name</span>:<span class="string">&#x27;world&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">//world</span></span><br></pre></td></tr></table></figure>

<p>​        </p>
<blockquote>
<p>自有属性的枚举顺序</p>
</blockquote>
<p>ES6规定了自有属性的枚举顺序，会依次按照数字类型键-&gt;字符串类型键-&gt;符号类型键的枚举顺序：</p>
<ol>
<li>所有的数字类型键，按升序排列；</li>
<li>所有的字符串类型键，按被添加到对象的顺序排列；</li>
<li>所有的符号类型，也按添加顺序排列</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自有属性的枚举顺序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">	<span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="attr">c</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="number">2</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="attr">b</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="number">1</span>: <span class="number">1</span></span><br><span class="line">	&#125;;</span><br><span class="line">obj.<span class="property">d</span> = <span class="number">1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(obj).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>));<span class="comment">//012acbd</span></span><br></pre></td></tr></table></figure>

<h3 id="更强大的原型"><a href="#更强大的原型" class="headerlink" title="更强大的原型"></a>更强大的原型</h3><blockquote>
<p>修改对象原型</p>
</blockquote>
<p>在ES6中可以通过Object.setPrototypeOF()方法修改对象的原型，该方法包含了两个参数：一个是被修改原型的对象，一个是将被指定的原型；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">	<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> dog =&#123;</span><br><span class="line">	<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> friend = <span class="title class_">Object</span>.<span class="title function_">create</span>(person); </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(friend.<span class="title function_">getName</span>()); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(friend)===person); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(friend,dog); </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(friend.<span class="title function_">getName</span>()); <span class="comment">//world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(friend)===dog); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用super引用</p>
</blockquote>
<p>能够使用<code>super</code>引用，来访问原型中的方法，假如需要覆盖对象中的同名方法可以这样做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">	<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> dog =&#123;</span><br><span class="line">	<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">getName</span>()+<span class="string">&#x27; world;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">​	</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(dog,person);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">getName</span>()); <span class="comment">//hello world</span></span><br></pre></td></tr></table></figure>

<p><strong>如果使用super引用的话，只能在方法简写中才能使用，否则就会报错：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dog =&#123;</span><br><span class="line">	<span class="attr">getNanem</span>:<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">getName</span>()+<span class="string">&#x27; world&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">报错：<span class="title class_">Uncaught</span> <span class="title class_">SyntaxError</span>: <span class="string">&#x27;super&#x27;</span> keyword unexpected here</span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法定义</p>
</blockquote>
<p>在ES6之前，方法的概念从未被正式定义，而在ES6中做出了正式定义：方法是拥有一个[[HomeObject]]内部属性的函数，此内部属性指向该方法所属的对象；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">	<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不是方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>ES6通过对对象功能的扩展，让ES6更加简单易用和更加强大，在对象功能上具体有这样一些改进：</p>
<p><strong>针对对象字面量：</strong></p>
<ol>
<li>速记法属性能够更加轻易的将作用域内的变量值赋值给同名属性；</li>
<li>需计算属性名规则能够更方便的将，变量、字符串字面量以及通过变量计算的结果作为属性；</li>
<li>方法简写法能够省略function关键字以及冒号：，让方法的定义更加简洁；</li>
<li>舍弃了重复属性的检查，让后面的属性覆盖掉前面同名属性的属性值；</li>
<li>指定了数字类型键-&gt;字符串类型键-&gt;符号类型键的对象自有属性的枚举顺序。</li>
</ol>
<p><strong>针对对象原型：</strong></p>
<ol>
<li>Object.assign()方法能够将多个提供者对象的属性整合到接受者对象中，能够方便实现对象的混入模式；</li>
<li>Object.is()方法在处理特殊值时比严格比较符更加安全；</li>
<li>Object.setPrototypeOf()方法能够更加方便更改一个对象的原型；</li>
<li>提供super关键字，访问原型上的方法。</li>
</ol>
<h3 id="案例-3"><a href="#案例-3" class="headerlink" title="案例"></a>案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//属性构造器的速记法</span></span><br><span class="line">		<span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">name,age</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				name,</span><br><span class="line">				age</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">createPerson</span>(<span class="string">&#x27;hello&#x27;</span>,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//方法简写法</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> person = &#123;</span><br><span class="line">			<span class="attr">sayName</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> name;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//等价于</span></span><br><span class="line">		<span class="keyword">let</span> person = &#123;</span><br><span class="line">			<span class="title function_">sayName</span>(<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> name;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; </span><br><span class="line"></span><br><span class="line">		需计算属性名</span><br><span class="line">		<span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line">		<span class="keyword">let</span> firstName = <span class="string">&#x27;first name&#x27;</span>;</span><br><span class="line">		<span class="keyword">let</span> suffix = <span class="string">&#x27;@github.com&#x27;</span></span><br><span class="line">		<span class="keyword">let</span> email = <span class="string">&#x27;email&#x27;</span>;</span><br><span class="line">		<span class="comment">//变量</span></span><br><span class="line">		person[firstName] = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">		<span class="comment">//字符串字面量</span></span><br><span class="line">		person[<span class="string">&#x27;last name&#x27;</span>]= <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">		<span class="comment">//变量计算而得到的</span></span><br><span class="line">		person[email+suffix] = <span class="string">&#x27;example@github.com&#x27;</span></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(person);</span><br><span class="line"></span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">is</span>()方法</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="number">0</span>==-<span class="number">0</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="number">0</span>===-<span class="number">0</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(+<span class="number">0</span>,-<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>==<span class="title class_">NaN</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>===<span class="title class_">NaN</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="title class_">NaN</span>,<span class="title class_">NaN</span>));</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>==<span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>===<span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="number">5</span>,<span class="string">&#x27;5&#x27;</span>))</span><br><span class="line"></span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">assign</span>()</span><br><span class="line">		<span class="keyword">let</span> person=&#123;</span><br><span class="line">			<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">			<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">let</span> car =&#123;</span><br><span class="line">			<span class="attr">brand</span>:<span class="string">&#x27;BWM&#x27;</span>,</span><br><span class="line">			<span class="attr">age</span>:<span class="number">5</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">assign</span>(obj,person,car);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(obj);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> receiver = &#123;&#125;,</span><br><span class="line">		supplier = &#123;</span><br><span class="line">			<span class="keyword">get</span> <span class="title function_">name</span>() &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">&quot;file.js&quot;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">assign</span>(receiver, supplier);</span><br><span class="line">		<span class="keyword">let</span> descriptor = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(receiver, <span class="string">&quot;name&quot;</span>);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(descriptor.<span class="property">value</span>); <span class="comment">// &quot;file.js&quot;</span></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(descriptor.<span class="property">get</span>); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//重复的属性</span></span><br><span class="line">		<span class="keyword">let</span> person = &#123;</span><br><span class="line">			<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">			<span class="attr">name</span>:<span class="string">&#x27;world&#x27;</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); </span><br><span class="line"></span><br><span class="line">		<span class="comment">//自有属性的枚举顺序</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> obj = &#123;</span><br><span class="line">			<span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="attr">c</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="number">2</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="attr">b</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="number">1</span>: <span class="number">1</span></span><br><span class="line">			&#125;;</span><br><span class="line">		obj.<span class="property">d</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(obj).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>));<span class="comment">//012acbd</span></span><br><span class="line"></span><br><span class="line">		<span class="title class_">Object</span>.<span class="property">setPrototypeOf</span>方法</span><br><span class="line">		<span class="keyword">let</span> person = &#123;</span><br><span class="line">			<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">let</span> dog =&#123;</span><br><span class="line">			<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> friend = <span class="title class_">Object</span>.<span class="title function_">create</span>(person);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(friend.<span class="title function_">getName</span>());</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(friend)===person);</span><br><span class="line"></span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(friend,dog);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(friend.<span class="title function_">getName</span>());</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(friend)===dog);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//方法</span></span><br><span class="line">		<span class="keyword">let</span> person = &#123;</span><br><span class="line">			<span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//不是方法</span></span><br><span class="line">		<span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> dog =&#123;</span><br><span class="line">			<span class="attr">getNanem</span>:<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">getName</span>()+<span class="string">&#x27; world&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(dog,person);</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(dog.<span class="title function_">getName</span>()); <span class="comment">//hello world</span></span><br></pre></td></tr></table></figure>



<h2 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h2><blockquote>
<p>对象解构语法</p>
</blockquote>
<p>对象解构语法在赋值语句的左侧使用了对象字面量，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> &#123;name,age&#125;=person;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">//18</span></span><br></pre></td></tr></table></figure>

<p>在声明变量name,age的时候，利用对象解构的方式，将person对象中name,age属性分别赋值给变量name和age，类似于简写的属性初始化器；</p>
<blockquote>
<p>解构赋值</p>
</blockquote>
<p><strong>对象解构不仅可以用于变量声明，还可以用于变量赋值</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br><span class="line">(&#123;name,age&#125;=person);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">//18</span></span><br></pre></td></tr></table></figure>

<p>name,age变量在声明变量的时候就已经完成了变量初始化操作，之后利用对象解构的方式实现变量赋值。<strong>注意：必须使用圆括号来包裹解构赋值语句，否则暴露的花括号会被解析成代码块语句，而代码块语句不允许在赋值（=）语句左侧出现。圆括号标示了里面的花括号并不是块语句，而是被解释成表达式，从而完成了赋值操作</strong>；</p>
<p>对象解构不仅可以用于变量赋值，任何期望赋值的地方都可以使用对象解构方式赋值，如传递给函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">value</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">is</span>(value,person);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">test</span>(&#123;name,age&#125;=person));<span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">//18</span></span><br></pre></td></tr></table></figure>

<p>调用函数test的时候就是使用解构赋值的方式来传递入参；</p>
<blockquote>
<p>默认值</p>
</blockquote>
<p>如果在使用对象解构赋值的时候，没有在对象中找到同名属性的话，那么本地变量就会赋值为<code>undefined</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">value</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">is</span>(value,person);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(&#123;name,age,value&#125;=person);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">//18</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>

<p>为了不让变量值为<code>undefined</code>，可以为变量设置默认值。设置变量默认值使用等号“=”，等号右侧为需要设置的默认值，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">value</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">is</span>(value,person);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(&#123;name,age,value=<span class="literal">true</span>&#125;=person);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">//18</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>利用等号为value设置默认值true。</p>
<blockquote>
<p>设置不同名本地变量</p>
</blockquote>
<p>使用解构赋值，也可以为不同名的变量赋值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(&#123;<span class="attr">name</span>:localName,<span class="attr">age</span>:localAge&#125;=person);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localName); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localAge); <span class="comment">//18</span></span><br></pre></td></tr></table></figure>

<p>使用冒号“：”可以为不同名的变量完成赋值，冒号左边为对象的属性名，冒号的右边为另外的变量名。</p>
<p>同样的可以为非同名的变量设置默认值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person =&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line">name = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">age= <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(&#123;<span class="attr">name</span>:localName,<span class="attr">age</span>:localAge,value=<span class="literal">true</span>&#125;=person);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localName); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localAge); <span class="comment">//18</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>嵌套的对象解构</p>
</blockquote>
<p>对象解构不仅可以处理属性值为基本类型值的对象的解构，还可以被用于嵌套的对象解构：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> node = &#123;</span><br><span class="line">		<span class="attr">type</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">		<span class="attr">loc</span>: &#123;</span><br><span class="line">			<span class="attr">start</span>: &#123;</span><br><span class="line">				<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">				<span class="attr">column</span>: <span class="number">1</span></span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="attr">end</span>: &#123;</span><br><span class="line">				<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">				<span class="attr">column</span>: <span class="number">4</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span>&#123;<span class="attr">loc</span>:&#123;start&#125;&#125;=node;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(start.<span class="property">line</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(start.<span class="property">column</span>);<span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<p>同样的，在嵌套的对象解构中依然也可以为不同名的变量赋值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> node = &#123;</span><br><span class="line">		<span class="attr">type</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">		<span class="attr">loc</span>: &#123;</span><br><span class="line">			<span class="attr">start</span>: &#123;</span><br><span class="line">				<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">				<span class="attr">column</span>: <span class="number">1</span></span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="attr">end</span>: &#123;</span><br><span class="line">				<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">				<span class="attr">column</span>: <span class="number">4</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span>&#123;<span class="attr">loc</span>:&#123;<span class="attr">start</span>:localStart&#125;&#125;=node;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localStart.<span class="property">line</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(localStart.<span class="property">column</span>);<span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<h3 id="数组结构"><a href="#数组结构" class="headerlink" title="数组结构"></a>数组结构</h3><blockquote>
<p>数组解构的语法</p>
</blockquote>
<p>数组解构与对象结构十分相似，对象解构是通过对象的<strong>属性名</strong>去查找对象中的属性值，然后进行赋值给变量，而数组解构则是通过数组的<strong>索引</strong>去找到具体值，再去赋值给变量：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> [first,second]=arr;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2	</span></span><br></pre></td></tr></table></figure>

<p>将数组arr中第一个元素和第二个元素分别赋值给first和second。如果只想要数组中第三个元素值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> [,,third]=arr;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(third);<span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<p>两个逗号”,”相当于占位符，前两个元素值不直接赋值给变量，仅仅将数组中的第3个元素值，赋值给变量third。    </p>
<blockquote>
<p>解构赋值</p>
</blockquote>
<p>可以在赋值表达式中使用数组解构：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> first = <span class="number">5</span>,second = <span class="number">6</span>;</span><br><span class="line">[first,second] = arr;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p><strong>与对象解构赋值和数组解构赋值相比起来，不需要使用圆括号”()”将赋值表达式包裹起来。</strong></p>
<p>使用数组解构，可以十分方便的完成变量值交换：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">[first,second] = arr;</span><br><span class="line">[first,second]=[second,first];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>默认值</p>
</blockquote>
<p>与对象解构赋值一样，数组解构赋值同样可以使用默认值，<strong>当指定位置的项不存在或者其值为undefined</strong>，那么该默认值就会被使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">[first,second,third=<span class="number">3</span>] = arr;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(third);<span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>嵌套的解构</p>
</blockquote>
<p>与嵌套对象解构一样，嵌套的数组也可以解构：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>],<span class="number">4</span>]</span><br><span class="line"><span class="keyword">let</span> [first,[second]]=array;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>剩余项</p>
</blockquote>
<p>数组解构中有一个类似于剩余参数的概念，可以使用<code>...</code>语法来将剩余项目给一个指定的变量，这种语法称之为剩余项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//剩余项</span></span><br><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> [first,...subArr]=array;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(subArr.<span class="property">length</span>);<span class="comment">//4</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(subArr[<span class="number">0</span>]);<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>将数组array中除了第一项外的其他项都赋给了变量<code>subArr</code>，剩余项<code>subArr</code>的长度为4，并且第一个元素为2；</p>
<p><strong>使用剩余项，可以很方便的完成数组复制：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组复制</span></span><br><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> [...clonedArr]=array;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clonedArr);	<span class="comment">//[1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>混合解构</p>
</blockquote>
<p>对象解构和数组解构可以混合在一起使用，这样就可以创建更加复杂的解构表达式，提取我们想要的内容:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> node = &#123;</span><br><span class="line">		<span class="attr">type</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">		<span class="attr">loc</span>: &#123;</span><br><span class="line">				<span class="attr">start</span>: &#123;</span><br><span class="line">					<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">					<span class="attr">column</span>: <span class="number">1</span></span><br><span class="line">				&#125;,</span><br><span class="line">				<span class="attr">end</span>: &#123;</span><br><span class="line">					<span class="attr">line</span>: <span class="number">1</span>,</span><br><span class="line">					<span class="attr">column</span>: <span class="number">4</span></span><br><span class="line">				&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">range</span>: [<span class="number">0</span>, <span class="number">3</span>]</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">loc</span>:&#123;start&#125;,<span class="attr">range</span>:[rangeArr]&#125;=node;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(start.<span class="property">line</span>); <span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rangeArr); <span class="comment">//0</span></span><br></pre></td></tr></table></figure>

<h3 id="参数解构"><a href="#参数解构" class="headerlink" title="参数解构"></a>参数解构</h3><p>当一个函数的入参既有必选参数，又有可选参数的时候，可选参数的部分可以利用解构的方式来定义，同时，如果利用到解构，需要为其设置默认值，否则会报错。因此，参数解构的规范形式为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">name, value,</span></span><br><span class="line"><span class="params">	&#123;</span></span><br><span class="line"><span class="params">		secure = <span class="literal">false</span>,</span></span><br><span class="line"><span class="params">		path = <span class="string">&quot;/&quot;</span>,</span></span><br><span class="line"><span class="params">		domain = <span class="string">&quot;example.com&quot;</span>,</span></span><br><span class="line"><span class="params">		expires = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now() + <span class="number">360000000</span>)</span></span><br><span class="line"><span class="params">	&#125; = &#123;&#125;</span></span><br><span class="line"><span class="params">	</span>) &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此代码中参数解构给每个属性都提供了默认值，所以你可以避免检查指定属性是否已被传入<br>（以便在未传入时使用正确的值） 。而整个解构的参数同样有一个默认值，即一个空对象，<br>令该参数成为可选参数。这么做使得函数声明看起来比平时要复杂一些，但却是为了确保每<br>个参数都有可用的值而付出的微小代价。</p>
<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><ol>
<li>解构使得在 JS 中操作对象与数组变得更容易。使用熟悉的对象字面量与数组字面量语法，可以将数据结构分离并只获取你感兴趣的信息。对象解构模式允许你从对象中进行提取，而数组模式则能用于数组。</li>
<li>对象与数组解构都能在属性或项未定义时为其提供默认值；在赋值表达式右侧的值为 null<br>或 undefined 时，两种模式都会抛出错误。你也可以在深层嵌套的数据结构中使用对象与数<br>组解构，下行到该结构的任意深度。</li>
<li>使用 var 、 let 或 const 的解构声明来创建变量，就必须提供初始化器。解构赋值能替代其他赋值，并且允许你把值解构到对象属性或已存在的变量上。</li>
<li>参数解构使用解构语法作为函数的参数，让“选项”（options ） 对象更加透明。你实际感兴趣的数据可以与具名参数一并列出。解构的参数可以是对象模式、数组模式或混合模式，并且你能使用它们的所有特性。</li>
</ol>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 对象解构赋值</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> person =&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">			<span class="attr">age</span>:<span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript">		name = <span class="string">&#x27;world&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">		age= <span class="number">20</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		(&#123;<span class="attr">name</span>:localName,<span class="attr">age</span>:localAge,value=<span class="literal">true</span>&#125;=person);</span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(localName); <span class="comment">//hello</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(localAge); <span class="comment">//18</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//true</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//嵌套的对象解构</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> node = &#123;</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">type</span>: <span class="string">&quot;Identifier&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">name</span>: <span class="string">&quot;foo&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">loc</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">start</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">line</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">column</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">end</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">line</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">column</span>: <span class="number">4</span></span></span><br><span class="line"><span class="language-javascript">					&#125;</span></span><br><span class="line"><span class="language-javascript">				&#125;</span></span><br><span class="line"><span class="language-javascript">			&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span>&#123;<span class="attr">loc</span>:&#123;<span class="attr">start</span>:localStart&#125;&#125;=node;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(localStart.<span class="property">line</span>); <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(localStart.<span class="property">column</span>);<span class="comment">//1</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 数组解构</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>];</span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		[first,second,third=<span class="number">3</span>] = arr;</span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(third);<span class="comment">//3</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 嵌套解构</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> array = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>],<span class="number">4</span>]</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> [first,[second]]=array;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(second);<span class="comment">//2</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 剩余项</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> [first,...subArr]=array;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(first);<span class="comment">//1</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(subArr.<span class="property">length</span>);<span class="comment">//4</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(subArr[<span class="number">0</span>]);<span class="number">2</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">//数组复制</span></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> [...clonedArr]=array;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(clonedArr);	<span class="comment">//[1,2,3,4,5]</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 混合解构</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> node = &#123;</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">type</span>: <span class="string">&quot;Identifier&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">name</span>: <span class="string">&quot;foo&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">loc</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">start</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">							<span class="attr">line</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">							<span class="attr">column</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">						&#125;,</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">end</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">							<span class="attr">line</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">							<span class="attr">column</span>: <span class="number">4</span></span></span><br><span class="line"><span class="language-javascript">						&#125;</span></span><br><span class="line"><span class="language-javascript">				&#125;,</span></span><br><span class="line"><span class="language-javascript">				<span class="attr">range</span>: [<span class="number">0</span>, <span class="number">3</span>]</span></span><br><span class="line"><span class="language-javascript">			&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">let</span> &#123;<span class="attr">loc</span>:&#123;start&#125;,<span class="attr">range</span>:[rangeArr]&#125;=node;</span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(start.<span class="property">line</span>); <span class="comment">//1</span></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">console</span>.<span class="title function_">log</span>(rangeArr); <span class="comment">//0</span></span></span><br><span class="line"><span class="language-javascript">		</span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 参数解构</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">function</span> <span class="title function_">setCookie</span>(<span class="params">name, value,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">			&#123;</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">				secure = <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">				path = <span class="string">&quot;/&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">				domain = <span class="string">&quot;example.com&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">				expires = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now() + <span class="number">360000000</span>)</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">			&#125; = &#123;&#125;</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">			</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="comment">// ...</span></span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Symbol基础"><a href="#Symbol基础" class="headerlink" title="Symbol基础"></a>Symbol基础</h2><h3 id="创建符号值"><a href="#创建符号值" class="headerlink" title="创建符号值"></a><strong>创建符号值</strong></h3><p>在 JS 已有的基本类型（字符串、数值、布尔类型、 <code>null</code> 与 <code>undefined</code> ） 之外， ES6 引入了一种新的基本类型：符号（<code>Symbol</code> ） 。 符号起初被设计用于创建对象私有成员，而这也是 JS 开发者期待已久的特性。在符号诞生之前，将字符串作为属性名称导致属性可以被轻易访问，无论命名规则如何。而“私有名称”意味着开发者可以创建非字符串类型的属性名称，由此可以防止使用常规手段来探查这些名称。</p>
<blockquote>
<p>创建符号值</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> firstName = <span class="title class_">Symbol</span>(<span class="string">&#x27;first Name&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line">person[firstName] = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person[firstName]); <span class="comment">//hello world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(firstName); <span class="comment">//Symbol(first Name)</span></span><br></pre></td></tr></table></figure>

<p>此代码创建了一个符号类型的 <code>firstName</code> 变量，并将它作为 <code>person</code> 对象的一个属性，而每次访问该属性都要使用这个符号值。<code>Symbol</code> 函数还可以接受一个额外的参数用于描述符号值，该描述并不能用来访问对应属性，但它能用于调试。符号的描述信息被存储在内部属性 <code>[[Description]]</code> 中，当符号的 <code>toString() </code>方法被显式<br>或隐式调用时，该属性都会被读取。在本例中， <code>console.log()</code> 隐式调用了 <code>firstName</code> 变量的 <code>toString()</code> 方法，于是描述信息就被输出到日志。此外没有任何办法可以从代码中直接访问 <code>[[Description]]</code> 属性。</p>
<h3 id="使用符号值"><a href="#使用符号值" class="headerlink" title="使用符号值"></a>使用符号值</h3><p><strong>可以在任意使用 需计算属性名 的场合中使用符号值，比如在对象字面量中可以使用符号值来作为对象属性，另外还可以在<code>Object.defineProperty()</code>方法或<code>Object.defineProperties()</code>方法中使用。</strong></p>
<p>共享符号值</p>
<p>如果想在不同的代码中共享同一个符号值的话，应使用 <code>Symbol.for()</code> 方法而不是 <code>Symbol()</code> 方法。 <code>Symbol.for()</code>方法仅接受单个字符串类型的参数，作为目标符号值的标识符，同时此参数也会成为该符号的描述信息。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//共享符号值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> uid = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&#x27;uid&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line">person[uid] = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> id = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&#x27;uid&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> car = &#123;&#125;;</span><br><span class="line">car[id] = <span class="string">&#x27;88888888&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(uid===id); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p><code>Symbol.for()</code> 方法首先会搜索全局符号注册表，看是否存在一个键值为 <code>&quot;uid</code>“ 的符号值。<br>若是，该方法会返回这个已存在的符号值；否则，会创建一个新的符号值，并使用该键值将<br>其记录到全局符号注册表中，然后返回这个新的符号值。这就意味着此后使用同一个键值去调用 <code>Symbol.for() </code>方法都将会返回同一个符号值。</p>
<p>还可以使用 <code>Symbol.keyFor()</code> 方法在全局符号注册表中根据<strong>符号值</strong>检索出对应的<strong>键值</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(uid)); <span class="comment">//uid</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(id)); <span class="comment">//uid</span></span><br></pre></td></tr></table></figure>

<h3 id="符号值的转换"><a href="#符号值的转换" class="headerlink" title="符号值的转换"></a>符号值的转换</h3><p>类型转换是 JS 语言重要的一部分，能够非常灵活地将一种数据类型转换为另一种。然而符号类型在进行转换时非常不灵活，因为其他类型缺乏与符号值的合理等价，尤其是符号值<strong>无法被转换为字符串值或数值</strong>，在逻辑运算符中会被认为等价于 <code>true</code>。</p>
<p>例如，可使用String()方法获取符号值的描述信息，但是如果使用符号值在字符串中拼接，则会报错：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">String</span>(uid));<span class="comment">//Symbol(uid)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(uid+<span class="string">&quot;&quot;</span>); <span class="comment">//Uncaught TypeError: Cannot convert a Symbol value to a string</span></span><br></pre></td></tr></table></figure>

<h3 id="检索符号属性"><a href="#检索符号属性" class="headerlink" title="检索符号属性"></a>检索符号属性</h3><p><code>Object.keys()</code> 与 <code>Object.getOwnPropertyNames() </code>方法可以检索对象的所有属性名称，前者<br>返回所有的<strong>可枚举属性名</strong>称，而后者则返回<strong>所有属性名称</strong>，无论是否可以可枚举，然而<strong>两者都不能返回符号类型的属性</strong>。因此，在ES6中新增了<br><code>Object.getOwnPropertySymbols()</code> 方法，以便让你可以检索对象的符号类型属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> uid = <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&#x27;uid&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> person = &#123;&#125;;</span><br><span class="line">person[uid] = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> symbols = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertySymbols</span>(person);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(symbols.<span class="property">length</span>); <span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(symbols[<span class="number">0</span>]); <span class="comment">//Symbol(uid)</span></span><br></pre></td></tr></table></figure>

<h2 id="知名符号"><a href="#知名符号" class="headerlink" title="知名符号"></a>知名符号</h2><p>ES6 定义了“知名符号”来代表 JS 中一些公共行为，而这些行为此前被认为只能是内部操作，但在ES6中使用了知名符号来暴露了内部方法，提供了更加方便的调用这种公用方法的一种方式。每一个知名符号都对应全局 <code>Symbol</code> 对象的一个属性，例如 <code>Symbol.create </code>。</p>
<p>知名符号有：</p>
<ul>
<li><strong>Symbol.hasInstance</strong> ：供 instanceof 运算符使用的一个方法，用于判断对象继承关系；</li>
<li><strong>Symbol.isConcatSpreadable</strong> ：一个布尔类型值，在集合对象作为参数传递给<br>Array.prototype.concat() 方法时，指示是否要将该集合的元素扁平化；</li>
<li><strong>Symbol.iterator</strong> ：返回迭代器的一个方法；</li>
<li><strong>Symbol.match</strong> ：供 String.prototype.match() 函数使用的一个方法，用于比较字符串；</li>
<li><strong>Symbol.replace</strong> ：供 String.prototype.replace() 函数使用的一个方法，用于替换子字符串；</li>
<li><strong>Symbol.search</strong> ：供 String.prototype.search() 函数使用的一个方法，用于定位子字符；</li>
<li><strong>Symbol.species</strong> ：用于产生派生对象的构造器；</li>
<li><strong>Symbol.split</strong> ：供 String.prototype.split() 函数使用的一个方法，用于分割字符串；</li>
<li><strong>Symbol.toPrimitive</strong> ：返回对象所对应的基本类型值的一个方法；</li>
<li><strong>Symbol.toStringTag</strong> ：供 String.prototype.toString() 函数使用的一个方法，用于创建对象的描述信息；</li>
<li><strong>Symbol.unscopables</strong> ：一个对象，该对象的属性指示了哪些属性名不允许被包含在with 语句中；</li>
</ul>
<h3 id="Symbol-hasInstance属性"><a href="#Symbol-hasInstance属性" class="headerlink" title="Symbol.hasInstance属性"></a>Symbol.hasInstance属性</h3><p>每个函数都具有一个 <code>Symbol.hasInstance</code> 属性，用于判断指定对象是否为本函数的一个实例。这个方法定义在 <code>Function.prototype</code> 上，因此所有函数都继承了面对 <code>instanceof</code> 运算符时的默认行为。 <code>Symbol.hasInstance</code> 属性自身是不可写入、不可配置、不可枚举的，从而保证它不会被错误地重写。</p>
<p><code>Symbol.hasInstance</code> 方法只接受单个参数，即需要检测的值。如果该值是本函数的一个实例，则方法会返回 <code>true</code> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">obj <span class="keyword">instanceof</span> <span class="title class_">Array</span></span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="title class_">Array</span>[<span class="title class_">Symbol</span>.<span class="property">hasInstance</span>](obj)</span><br></pre></td></tr></table></figure>

<h3 id="Symbol-isConcatSpreadable属性"><a href="#Symbol-isConcatSpreadable属性" class="headerlink" title="Symbol.isConcatSpreadable属性"></a>Symbol.isConcatSpreadable属性</h3><p><code>Symbol.isConcatSpreadable </code>属性是一个布尔类型的属性，它表示拥有长度<code>length</code>属性与数值类型的键的类数组的对象，在调用 <code>concat()</code> 方法时，会将数值键对应的值分离为单独项，添加在数组的后部，完成数组拼接。</p>
<p>它只出现在特定类型的对象上，用来标示该对象在作为<code> concat()</code> 参数时应如何工作，从而有效改变该对象的默认行为。你可以用它来定义任意类型的对象，让该对象在参与 <code>concat()</code> 调用时能够表现得像数组一样。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Symbol.isConcatSpreadable属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> collection = &#123;</span><br><span class="line">	<span class="number">0</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">	<span class="number">1</span>:<span class="string">&#x27;world&#x27;</span>,</span><br><span class="line">	<span class="attr">length</span>:<span class="number">2</span>,</span><br><span class="line">	[<span class="title class_">Symbol</span>.<span class="property">isConcatSpreadable</span>]:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;es6&#x27;</span>].<span class="title function_">concat</span>(collection);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">//[&quot;es6&quot;, &quot;hello&quot;, &quot;world&quot;]</span></span><br></pre></td></tr></table></figure>

<p> Symbol.match 、 Symbol.replace 、 Symbol.search与Symbol.split</p>
<p>在 JS 中，字符串与正则表达式有着密切的联系，尤其是字符串具有几个可以接受正则表达式作为参数的方法：</p>
<ul>
<li>match(regex) ：判断指定字符串是否与一个正则表达式相匹配；</li>
<li>replace(regex, replacement) ：对正则表达式的匹配结果进行替换；</li>
<li>search(regex) ：在字符串内对正则表达式的匹配结果进行定位；</li>
<li>split(regex) ：使用正则表达式将字符串分割为数组</li>
</ul>
<p>ES6 定义了 4 个符号以及对应的方法，可以将正则表达式作为字符串对应方法的第一个参数传入， <code>Symbol.match</code> 对应 <code>match()</code> 方法， <code>Symbol.replace</code> 对应 <code>replace()</code> ，<code>Symbol.search</code>对应 <code>search()</code>， <code>Symbol.split</code> 则对应 <code>split()</code> 。这些符号属性被定义在 <code>RegExp.prototype </code>上作为默认实现，以供对应的字符串方法使用。</p>
<h3 id="Symbol-toPrimitive"><a href="#Symbol-toPrimitive" class="headerlink" title="Symbol.toPrimitive"></a>Symbol.toPrimitive</h3><p>JS 经常在使用特定运算符的时候试图进行隐式转换，以便将对象转换为基本类型值。例如，当你使用相等（<code>==</code> ） 运算符来对字符串与对象进行比较的时候，该对象会在比较之前被转换为一个基本类型值。到底转换为什么基本类型值，在此前属于内部操作，而 ES6 则通过<code>Symbol.toPrimitive</code> 属性将其暴露出来，以便让对应方法可以被修改。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Temperature</span>(<span class="params">degrees</span>) &#123;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="property">degrees</span> = degrees;</span><br><span class="line">&#125; </span><br><span class="line"><span class="title class_">Temperature</span>.<span class="property"><span class="keyword">prototype</span></span>[<span class="title class_">Symbol</span>.<span class="property">toPrimitive</span>] = <span class="keyword">function</span>(<span class="params">hint</span>) &#123;</span><br><span class="line">	<span class="keyword">switch</span> (hint) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;string&quot;</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">degrees</span> + <span class="string">&quot;\u00b0&quot;</span>; <span class="comment">// 温度符号</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;number&quot;</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">degrees</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;default&quot;</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">degrees</span> + <span class="string">&quot; degrees&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> freezing = <span class="keyword">new</span> <span class="title class_">Temperature</span>(<span class="number">32</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(freezing + <span class="string">&quot;!&quot;</span>); <span class="comment">// &quot;32 degrees!&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(freezing / <span class="number">2</span>); <span class="comment">// 16</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">String</span>(freezing)); <span class="comment">// &quot;32°&quot;</span></span><br></pre></td></tr></table></figure>

<p>这段脚本定义了一个 Temperature 构造器，并重写了其原型上的<code>Symbol.toPrimitive</code> 方法。返回值会依据方法的提示性参数而有所不同，可以使用字符串模式、数值模式或是默认模式，而该提示性参数会在调用时由 JS 引擎自动填写。字符串模式中， Temperature 函数返回的温度会附带着 Unicode 温度符号；数值模式只会返回温度数值；而默认模式中，返回的温度会附带着字符串 “degrees” 。</p>
<h3 id="Symbol-toStringTag"><a href="#Symbol-toStringTag" class="headerlink" title="Symbol.toStringTag"></a>Symbol.toStringTag</h3><p>ES6 通过 <code>Symbol.toStringTag</code> 重定义了相关行为，该符号代表了所有对象的一个属性，定义了 <code>Object.prototype.toString.call()</code> 被调用时应当返回什么值。对于数组来说，在<code>Symbol.toStringTag</code> 属性中存储了 “Array” 值，于是该函数的返回值也就是 “Array” 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>)&#123;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>[<span class="title class_">Symbol</span>.<span class="property">toStringTag</span>] = <span class="string">&#x27;person&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="title function_">toString</span>()); <span class="comment">//[object person]</span></span><br></pre></td></tr></table></figure>

<h3 id="Symbol-unscopables"><a href="#Symbol-unscopables" class="headerlink" title="Symbol.unscopables"></a>Symbol.unscopables</h3><p><code>Symbol.unscopables</code> 符号在 <code>Array.prototype</code> 上使用，以指定哪些属性不允许在 <code>with</code> 语句内被绑定。 <code>Symbol.unscopables</code> 属性是一个对象，当提供该属性时，它的键就是用于忽略<code>with</code> 语句绑定的标识符，键值为 <code>true</code> 代表屏蔽绑定。以下是数组的 <code>Symbol.unscopables</code>属性的默认值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认内置在 ES6 中</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>[<span class="title class_">Symbol</span>.<span class="property">unscopables</span>] = <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>), &#123;</span><br><span class="line">	<span class="attr">copyWithin</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">entries</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">fill</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">find</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">findIndex</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">keys</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">values</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><ol>
<li>虽然符号类型的属性不是真正的私有属性，但它们难以被无意修改，因此在需要提供保护以防止开发者改动的场合中，它们非常合适；</li>
<li>为符号提供描述信息以便更容易地辨识它们的值。当需要在不同代码片段中共享符号，可以是用S<code>ymbol.for()</code>在全局符号注册表中共享符号；</li>
<li><code>Object.keys()</code> 或 <code>Object.getOwnPropertyNames()</code> 不会返回符号值，因此 ES6 新增了一个<code>Object.getOwnPropertySymbols() </code>方法，允许检索符号类型的对象属性。同时依然可以使用<code>Object.defineProperty()</code> 与 <code>Object.defineProperties()</code> 方法对符号类型的属性进行修改；</li>
<li>“知名符号”使用了全局符号常量（例如 <code>Symbol.hasInstance</code> ） ，为常规对象定义了一些功能，而这些功能原先仅限内部使用。这些符号按规范使用 <code>Symbol.</code> 的前缀，允许开发者通过多种方式去修改常规对象的行为。</li>
</ol>
<h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let firstName = Symbol(&#x27;first Name&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person[firstName] = &#x27;hello world&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(person[firstName]); //hello world</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(firstName); //Symbol(first Name)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//共享符号值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let uid = Symbol.for(&#x27;uid&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person[uid] = &#x27;hello&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let symbols = Object.getOwnPropertySymbols(person);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(symbols.length); //1</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(symbols[0]); //Symbol(uid)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let id = Symbol.for(&#x27;uid&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let car = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// car[id] = &#x27;88888888&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(uid===id); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Symbol.keyFor(uid)); //uid</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Symbol.keyFor(id)); //uid</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(String(uid));//Symbol(uid)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(uid+&quot;&quot;); //Uncaught TypeError: Cannot convert a Symbol value to a string</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //Symbol.isConcatSpreadable属性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let collection = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	0:&#x27;hello&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	1:&#x27;world&#x27;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	length:2,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	[Symbol.isConcatSpreadable]:true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let arr = [&#x27;es6&#x27;].concat(collection);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr); //[&quot;es6&quot;, &quot;hello&quot;, &quot;world&quot;]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// function Temperature(degrees) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	this.degrees = degrees;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Temperature.prototype[Symbol.toPrimitive] = function(hint) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	switch (hint) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		case &quot;string&quot;:</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return this.degrees + &quot;\u00b0&quot;; // 温度符号</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		case &quot;number&quot;:</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return this.degrees;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		case &quot;default&quot;:</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return this.degrees + &quot; degrees&quot;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let freezing = new Temperature(32);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(freezing + &quot;!&quot;); // &quot;32 degrees!&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(freezing / 2); // 16</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(String(freezing)); // &quot;32°&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// function Person(name)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Person.prototype[Symbol.toStringTag] = &#x27;person&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = new Person(&#x27;hello world&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(person.toString()); //[object person]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 默认内置在 ES6 中</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>[<span class="title class_">Symbol</span>.<span class="property">unscopables</span>] = <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>), &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">copyWithin</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">entries</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">fill</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">find</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">findIndex</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">keys</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="attr">values</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h2 id="ES6中的Set"><a href="#ES6中的Set" class="headerlink" title="ES6中的Set"></a>ES6中的Set</h2><p>ES6中提供了Set数据容器，这是一个能够<strong>存储无重复值</strong>的有序列表。</p>
<blockquote>
<p>创建Set</p>
</blockquote>
<p>通过<code>new Set()</code>可以创建Set，然后通过<code>add</code>方法能够向Set中添加数据项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Set</span></span><br><span class="line"><span class="keyword">let</span> set= <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">set.<span class="title function_">add</span>(<span class="number">1</span>);</span><br><span class="line">set.<span class="title function_">add</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>);<span class="comment">//2		</span></span><br></pre></td></tr></table></figure>

<p><strong>Set内部使用Object.is()方法来判断两个数据项是否相等，唯一不同的是+0和-0在Set中被判断为是相等的。</strong></p>
<p>同时可以使用数组来构造Set，或者说具有迭代器的对象都可以用来构造Set，并且Set构造器会确保不会存在重复的数据项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>);<span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>检查某个值是否存在于Set中</p>
</blockquote>
<p>可以使用<code>has()</code>方法来判断某个值是否存在于Set中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(<span class="number">5</span>)); <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除值</p>
</blockquote>
<p>使用delete()方法从Set中删除某个值，或者使用clear()方法从Set中删除所有值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>);<span class="comment">//3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(<span class="number">5</span>)); <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">set.<span class="title function_">delete</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(<span class="number">1</span>)); <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>forEach()方法</p>
</blockquote>
<p>可以使用<code>forEach</code>方法来遍历Set中的数据项，该方法传入一个回调函数<code>callback</code>，还可以传入一个<code>this</code>，用于回调函数之中：</p>
<p>回调函数callback中有三个参数：</p>
<ol>
<li><p>元素值；</p>
</li>
<li><p>元素索引；</p>
</li>
<li><p>将要遍历的对象；</p>
<p>let set = new Set([1,2,3,3,3,3]);</p>
<pre><code>    set.forEach(function (value,key,ownerSet) &#123;
        console.log(value);
        console.log(key);            
    &#125;)
</code></pre>
</li>
</ol>
<p>Set中的value和key是相同的，这是为了让Set的forEach方法和数组以及Map的forEach方法保持一致，都具有三个参数。</p>
<p>在forEach方法中传入<code>this</code>，给回调函数使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="keyword">let</span> operation =&#123;</span><br><span class="line"></span><br><span class="line">	<span class="title function_">print</span>(<span class="params">value</span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="title function_">iterate</span>(<span class="params">set=[]</span>)&#123;</span><br><span class="line">		set.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">value,key,ownerSet</span>)&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">print</span>(value);</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">print</span>(key);</span><br><span class="line">		&#125;,<span class="variable language_">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">operation.<span class="title function_">iterate</span>(set);</span><br><span class="line"></span><br><span class="line">输出：<span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>如果回调函数使用箭头函数的话，就可以省略<code>this</code>的入参，这是因为箭头函数会通过作用域链找到当前this对象，将上面的示例代码使用箭头函数来写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>]);</span><br><span class="line"><span class="keyword">let</span> operation =&#123;</span><br><span class="line"></span><br><span class="line">	<span class="title function_">print</span>(<span class="params">value</span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="title function_">iterate</span>(<span class="params">set=[]</span>)&#123;</span><br><span class="line">		set.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value,key</span>)=&gt;</span>&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">print</span>(value);</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">print</span>(key);</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">operation.<span class="title function_">iterate</span>(set);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将Set转换成数组</p>
</blockquote>
<p>将数组转换成Set十分容易，可以将数组传入Set构造器即可；而将Set转换成数组，需要使用扩展运算符。扩展运算符能将数组中的数据项切分开，作为独立项传入到函数，如果将扩展运算符用于可迭代对象的话，就可以将可迭代对象转换成数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [...arr]=set;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [1,2,3]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Weak Set</p>
</blockquote>
<p>Set在存放对象时，实际上是存放的是对象的引用，即Set也被称之为Strong Set。如果所存储的对象被置为null，但是Set实例仍然存在的话，对象依然无法被垃圾回收器回收，从而无法释放内存：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line"><span class="keyword">let</span> key=&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> key2 = &#123;&#125;;</span><br><span class="line">set.<span class="title function_">add</span>(key);</span><br><span class="line">set.<span class="title function_">add</span>(key2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>); <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">key=<span class="literal">null</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="property">size</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p>可以看出就算对象key置为null，但是由于是强引用的方式，Set实例还存在，对象key依然不会被回收。</p>
<p>如果想让对象key正常释放的话，可以使用Weak Set，此时，<strong>存放的是对象的弱引用，当对象只被Set弱引用的话，并不会阻止对象实例被回收</strong>。Weka Set同Set的用法几乎一致。可以使用add()方法增加数据项，使用has()方法检查Weak Set中是否包含某项，以及使用delete()方法删除某一项。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">WeakSet</span>();</span><br><span class="line"><span class="keyword">let</span> key = &#123;&#125;;	</span><br><span class="line">set.<span class="title function_">add</span>(key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(key)); <span class="comment">//true</span></span><br><span class="line">set.<span class="title function_">delete</span>(key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(key)); <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<p>但需要注意的是：Weak Set构造器不接受基本类型数据，只接受对象。同样的可以使用可迭代的对象如数组，来作为构造器参数，来创建Weak Set。</p>
<blockquote>
<p>Weak Set和Set之间的差异</p>
</blockquote>
<p>对于Weak Set和Set之间的重要差异：</p>
<ol>
<li>对于Weak Set实例，若调用了add()方法时传入了非对象的参数，则会抛出错误。如果在has()或者delete()方法中传入了非对象的参数则会返回false；</li>
<li>Weak Set不可迭代，因此不能用于for-of循环；</li>
<li>Weak Set 无法暴露出任何迭代器（例如 keys() 与 values() 方法） ，因此没有任何编程手段可用于判断 Weak Set 的内容；</li>
<li>Weak Set没有forEach()方法；</li>
<li>Weak Set没有size属性；</li>
</ol>
<h2 id="ES6中的Map"><a href="#ES6中的Map" class="headerlink" title="ES6中的Map"></a>ES6中的Map</h2><p>ES6中提供了Map数据结构，能够存放键值对，其中，键的去重是通过Object.is()方法进行比较，键的数据类型可以是基本类型数据也可以是对象，而值也可以是任意类型数据。</p>
<blockquote>
<p>对Map的操作</p>
</blockquote>
<ol>
<li><p>使用<code>set()</code>方法可以给Map添加键值对</p>
<p>let map = new Map();</p>
<pre><code>    map.set(&#39;title&#39;,&#39;hello world&#39;);
    map.set(&#39;year&#39;,&#39;2018&#39;);
    
</code></pre>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="property">size</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>通过<code>set()</code>方法往Map中增加了两个键值对后，可以看到Map的大小就为2；</p>
<ol start="2">
<li><p>通过get()方法可以从Map中提取值</p>
<p>let map = new Map();</p>
<pre><code>    map.set(&#39;title&#39;,&#39;hello world&#39;);
    map.set(&#39;year&#39;,&#39;2018&#39;);
    
</code></pre>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(<span class="string">&#x27;title&#x27;</span>)); <span class="comment">// hello world</span></span><br></pre></td></tr></table></figure></li>
<li><p>has(),delete()以及clear()方法</p>
</li>
</ol>
<p>为了和Set的操作保持一致，Map中同样有has()方法，用来检查某个数据项是否存在于Map中，使用delete方法可以从Map中删除一个数据项，使用clear方法可以删除Map中所有的数据项</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;title&#x27;</span>,<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;2018&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(<span class="string">&#x27;year&#x27;</span>)); <span class="comment">//true</span></span><br><span class="line">map.<span class="title function_">delete</span>(<span class="string">&#x27;title&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(<span class="string">&#x27;title&#x27;</span>)); <span class="comment">//false</span></span><br><span class="line">map.<span class="title function_">clear</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="property">size</span>); <span class="comment">//0</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Map的初始化</p>
</blockquote>
<p>与Set的初始化一样，Map也可以用数组来初始化Map，该数组中的每一个数据项也是数组，数组的第一个数据项代表键值对的键，第二个数据项是键值对的值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用数组来创建Map</span></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;title&#x27;</span>,<span class="string">&#x27;hello world&#x27;</span>],[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;2018&#x27;</span>]]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(<span class="string">&#x27;title&#x27;</span>)); <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(<span class="string">&#x27;year&#x27;</span>)); <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="property">size</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>Map的forEach方法</p>
</blockquote>
<p>与Set一样，Map也拥有<code>forEach</code>方法，该方法也接收一个回调函数，该回调函数有三个参数：</p>
<ol>
<li><p>键值对的键；</p>
</li>
<li><p>键值对的值；</p>
</li>
<li><p>当前Map对象引用；</p>
<p>let map = new Map([[‘title’,’hello world’],[‘year’,’2018’]]);</p>
<pre><code>    map.forEach((value,key,ownerMap)=&gt;&#123;
        console.log(value);
        console.log(key);
    &#125;);
    
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br><span class="line">title</span><br><span class="line">2018</span><br><span class="line">year</span><br></pre></td></tr></table></figure></li>
</ol>
<p>与Set的forEach一样，可以在回调函数中传入<code>this引用</code>。</p>
<blockquote>
<p>Weak Map</p>
</blockquote>
<p>Weak Map对Map而言，就像是Weak Set相对于Set一样：<strong>Weak Map(或者Weak Set)都是存储对象弱引用的方式，在Weak Map（或者Weak Set）中，所有的键都必须是对象（尝试使用非对象的键会抛出错误），而且这些对象都是弱引用，不会干扰到垃圾回收。当Weak Map中的键在Weak Map之外不存在引用时，该键值对会被移除。</strong></p>
<blockquote>
<p>Weak Map的操作</p>
</blockquote>
<ol>
<li>Weak Map的初始化</li>
</ol>
<p> Weak Map的键必须是对象，值可以是任意类型，初始化同Map一样，也可是使用数组来创建一个 Weak Map ：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用数组来创建一个Weak Map</span></span><br><span class="line"><span class="keyword">let</span> key = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> key2 = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">WeakMap</span>([[key,<span class="string">&#x27;hello&#x27;</span>],[key2,<span class="string">&#x27;world&#x27;</span>]]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(key)); <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(key2)); <span class="comment">//world</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>has方法以及delete方法</li>
</ol>
<p>与Map一样，可以使用has()方法来检查Weak Map中是否存在某一个键值对，使用delete()方法可以删除一个键值对。clear() 方法不存在，这是因为没必要对键进行枚举，并且枚举 Weak Map 也是不可能的，这与 Weak Set 相同：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> key = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> key2 = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">WeakMap</span>([[key,<span class="string">&#x27;hello&#x27;</span>],[key2,<span class="string">&#x27;world&#x27;</span>]]);</span><br><span class="line"></span><br><span class="line">map.<span class="title function_">delete</span>(key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(key)); <span class="comment">//false</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>Weak Map 的用法与局限性</p>
</blockquote>
<p>当决定是要使用 Weak Map 还是使用正规 Map 时，首要考虑因素在于你是否只想使用对象类型的键。如果你打算这么做，那么最好的选择就是 Weak Map 。因为它能确保额外数据在不再可用后被销毁，从而能优化内存使用并规避内存泄漏。</p>
<p>要记住 Weak Map 只为它们的内容提供了很小的可见度，因此你<strong>不能使用 forEach() 方法、size 属性或 clear() 方法来管理其中的项</strong>。如果你确实需要一些检测功能，那么正规 Map会是更好的选择，只是一定要确保留意内存的使用。</p>
<h3 id="总结-4"><a href="#总结-4" class="headerlink" title="总结"></a>总结</h3><ol>
<li>Set 是无重复值的有序列表。根据 <code>Object.is() </code>方法来判断其中的值不相等，以保证无重复。 Set 会自动移除重复的值，因此你可以使用它来过滤数组中的重复值并返回结果。 Set并不是数组的子类型，所以你无法随机访问其中的值。但你可以使用<code> has()</code> 方法来判断某个值是否存在于 Set 中，或通过 <code>size</code> 属性来查看其中有多少个值。 Set 类型还拥有<code>forEach() </code>方法，用于处理每个值。</li>
<li>Weak Set 是只能包含对象的特殊 Set 。其中的对象使用弱引用来存储，意味着当 Weak Set中的项是某个对象的仅存引用时，它不会屏蔽垃圾回收。由于内存管理的复杂性， Weak Set的内容不能被检查，因此最好将 Weak Set 仅用于追踪需要被归组在一起的对象。</li>
<li>Map 是有序的键值对，其中的键允许是任何类型。与 Set 相似，通过调用 <code>Object.is() </code>方法来判断重复的键，这意味着能将数值 5 与字符串 “5” 作为两个相对独立的键。使用<code>set()</code> 方法能将任何类型的值关联到某个键上，并且该值此后能用 <code>get()</code> 方法提取出来。Map 也拥有一个 <code>size</code> 属性与一个 <code>forEach()</code> 方法，让项目访问更容易。</li>
<li>Weak Map 是只能包含对象类型的键的特殊 Map 。与 Weak Set 相似，键的对象引用是弱引用，因此当它是某个对象的仅存引用时，也不会屏蔽垃圾回收。当键被回收之后，所关联的值也同时从 Weak Map 中被移除。</li>
</ol>
<h3 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//Set</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let set= new Set();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// set.add(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// set.add(&#x27;1&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.size);//2		</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let set = new Set([1,2,3,3,3,3]);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.size);//3</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.has(5)); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// set.delete(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.has(1)); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.size); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let set = new Set([1,2,3,3,3,3]);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let operation =&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	print(value)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	iterate(set=[])&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		set.forEach((value,key)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			this.print(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			this.print(key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// operation.iterate(set);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let [...arr]=set;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//强引用</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let set = new WeakSet();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let key = &#123;&#125;;	</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// set.add(key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.has(key)); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// set.delete(key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(set.has(key)); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//Map的基本操作</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let map = new Map();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// map.set(&#x27;title&#x27;,&#x27;hello world&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// map.set(&#x27;year&#x27;,&#x27;2018&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.has(&#x27;year&#x27;)); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// map.delete(&#x27;title&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.has(&#x27;title&#x27;)); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// map.clear();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.size); //0</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.get(&#x27;title&#x27;));</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.size); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//使用数组来创建Map</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let map = new Map([[&#x27;title&#x27;,&#x27;hello world&#x27;],[&#x27;year&#x27;,&#x27;2018&#x27;]]);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// map.forEach((value,key,ownerMap)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.has(&#x27;title&#x27;)); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.has(&#x27;year&#x27;)); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(map.size); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//使用数组来创建一个Weak Map</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> key = &#123;&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> key2 = &#123;&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">WeakMap</span>([[key,<span class="string">&#x27;hello&#x27;</span>],[key2,<span class="string">&#x27;world&#x27;</span>]]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(key)); <span class="comment">//hello</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(key2)); <span class="comment">//world</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		map.<span class="title function_">delete</span>(key);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">has</span>(key));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>





<h2 id="迭代器和迭代器"><a href="#迭代器和迭代器" class="headerlink" title="迭代器和迭代器"></a>迭代器和迭代器</h2><blockquote>
<p>何为迭代器？</p>
</blockquote>
<p>迭代器是被设计专用于迭代的对象，带有特定接口。所有的迭代器对象都拥有 next() 方<br>法，会返回一个结果对象。该结果对象有两个属性：对应下一个值的 value ，以及一个布尔<br>类型的 done ，其值为 true 时表示没有更多值可供使用。迭代器持有一个指向集合位置的<br>内部指针，每当调用了 next() 方法，迭代器就会返回相应的下一个值。</p>
<h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><blockquote>
<p>何为生成器？</p>
</blockquote>
<p><strong>生成器（generator ） 是能返回一个迭代器的函数</strong>。生成器函数由放在 function 关键字之后的一个星号（ * ） 来表示，并能使用新的 <code>yield</code> 关键字。将星号紧跟在 function 关键字之后，或是在中间留出空格，都是没问题的。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>*<span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>);<span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p>生成器函数最有意思的地方是它们会在每一个<code>yield</code>语句后停止，例如在上面的代码中执行<code>yield 1</code>后，该函数不会在继续往下执行。等待下一次调用<code>next()</code>后，才会继续往下执行<code>yield 2 </code>。</p>
<p><strong>除了使用函数声明的方式创建一个生成器外，还可以使用函数表达式来创建一个生成器。由于生成器就是一个函数，同样可以使用对象字面量的方式，将对象的属性赋值为一个生成器函数。</strong></p>
<h3 id="可迭代对象与for-of循环"><a href="#可迭代对象与for-of循环" class="headerlink" title="可迭代对象与for-of循环"></a>可迭代对象与for-of循环</h3><p>可迭代对象是包含<code>Symbol.iterator</code>属性的对象，这个<code>Symbol.iterator</code>属性对应着能够返回该对象的迭代器的函数。在ES6中，所有的集合对象（数组、Set和Map）以及字符串都是可迭代对象，因此它们都被指定了默认的迭代器。可迭代对象可以与ES6中新增的<code>for-of</code>循环配合使用。</p>
<p>迭代器解决了<code>for</code>循环中追踪索引的问题，而<code>for-of</code>循环，则是完全删除追踪集合索引的需要，更能专注于操作集合内容。<code>for-of</code>循环在循环每次执行时会调用可迭代对象的<code>next()</code>方法，并将结果对象的<code>value</code>值存储在一个变量上，循环过程直到结果对象<code>done</code>属性变成<code>true</code>为止：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> num <span class="keyword">of</span> arr)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br><span class="line">&#125;</span><br><span class="line">输出结果为：<span class="number">1</span>，<span class="number">2</span>，<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><code>for-of</code>循环首先会调用arr数组中<code>Symbol.iterator</code>属性对象的函数，就会获取到该数组对应的迭代器，接下来<code>iterator.next()</code>被调用，迭代器结果对象的<code>value</code>属性会被放入到变量<code>num</code>中。数组中的数据项会依次存入到变量<code>num</code>中，直到迭代器结果对象中的<code>done</code>属性变成<code>true</code>为止，循环就结束。</p>
<blockquote>
<p>访问可迭代对象的默认迭代器</p>
</blockquote>
<p>可以使用可迭代对象的Symbol.iterator来访问对象上可返回迭代器的函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="comment">//访问默认迭代器</span></span><br><span class="line"><span class="keyword">let</span> iterator = arr[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p><strong>通过Symbol.iterator属性获取到该对象的可返回迭代器的函数，然后执行该函数得到对象的可迭代器。</strong>同样的，可是使用<code>Symbol.iterato</code>r属性来检查对象是否是可迭代对象。</p>
<blockquote>
<p>创建可迭代对象</p>
</blockquote>
<p>数组，Set等集合对象是默认的迭代器，当然也可以为对象创建自定义的迭代器，使其成为可迭代对象。那么迭代器如何生成？我们已经知道，生成器就是一个可以返回迭代器的函数，因此自定义迭代器，就是写一个生成器函数。同时，可迭代对象必须具有<code>Symbol.iterator</code>属性，并且该属性对应着一个能够返回迭代器的函数，因此只需要将这个生成器函数赋值给<code>Symbol.iterator</code>属性即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建可迭代对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">	<span class="attr">items</span>:[],</span><br><span class="line"></span><br><span class="line">	*[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">items</span>)&#123;</span><br><span class="line">			<span class="keyword">yield</span> item;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="property">items</span>.<span class="title function_">push</span>(<span class="number">1</span>);</span><br><span class="line">obj.<span class="property">items</span>.<span class="title function_">push</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> num <span class="keyword">of</span> obj)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：<span class="number">1</span>，<span class="number">2</span></span><br></pre></td></tr></table></figure>

<h3 id="内置的迭代器"><a href="#内置的迭代器" class="headerlink" title="内置的迭代器"></a>内置的迭代器</h3><p>ES6中许多内置类型已经包含了默认的迭代器，只有当默认迭代器满足不了时，才会创建自定义的迭代器。如果新建对象时，要想把该对象转换成可迭代对象的话，一般才会需要自定义迭代器。</p>
<blockquote>
<p>集合迭代器 </p>
</blockquote>
<p>ES6中有三种集合对象：数组、Map和Set，这三种类型都拥有默认的迭代器：</p>
<ul>
<li>entries()：返回一个包含键值对的迭代器；</li>
<li>values()：返回一个包含集合中的值的迭代器；</li>
<li>keys()：返回一个包含集合中的键的迭代器；</li>
</ul>
<ol>
<li>调用entries()迭代器会在每次调用next()方法返回一个双项数组，此数组代表集合数据项中的键和值：对于数组来说，第一项是数组索引；对于Set来说，第一项是值（因为Set的键和值相同），对于Map来说，就是键值对的值；</li>
<li>values()迭代器能够返回集合中的每一个值；</li>
<li>keys()迭代器能够返回集合中的每一个键；</li>
</ol>
<blockquote>
<p>集合的默认迭代器 </p>
</blockquote>
<p>当for-of循环没有显式指定迭代器时，集合对象会有默认的迭代器。values()方法是数组和Set默认的迭代器，而entries()方法是Map默认迭代器。</p>
<blockquote>
<p>字符串的迭代器 </p>
</blockquote>
<p>ES6旨在为Unicode提供了完全支持，字符串的默认迭代器就是解决字符串迭代问题的一种尝试，这样一来，借助字符串默认迭代器就能处理字符而非码元：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//字符串默认迭代器</span><br><span class="line">let str =&#x27;A   B&#x27;;</span><br><span class="line">for(let s of str)&#123;</span><br><span class="line">	console.log(s); //A  B</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>扩展运算符与非数组的可迭代对象</p>
</blockquote>
<p>扩展运算符能作用于所有可迭代对象，并且会使用默认迭代器来判断需要哪些值。在数组字面量中可以使用扩展运算符将可迭代对象填充到数组中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//扩展运算符可作用到所有可迭代对象</span><br><span class="line">let arr = [1,2,3];</span><br><span class="line">let array = [...arr];</span><br><span class="line">console.log(array); [1,2,3]</span><br></pre></td></tr></table></figure>

<p>并且，可以不限次数在数组字面量中使用扩展运算符，而且可以在任意位置用扩展运算符将可迭代对象填充到数组中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let arr = [1,2,3];</span><br><span class="line">let arr2 = [7,8,9];</span><br><span class="line">let array = [...arr,5,...arr2];</span><br><span class="line">console.log(array); //1,2,3,5,7,8,9</span><br></pre></td></tr></table></figure>

<h3 id="迭代器高级功能"><a href="#迭代器高级功能" class="headerlink" title="迭代器高级功能"></a>迭代器高级功能</h3><p>能够通过next()方法向迭代器传递参数<strong>，当一个参数传递给next()方法时，该参数就会成为生成器内部yield语句中的变量值。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//迭代器的高级功能</span></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> first = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">let</span> second = <span class="keyword">yield</span> first+<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">let</span> third = <span class="keyword">yield</span> second+<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>(<span class="number">4</span>)); <span class="comment">//&#123;value: 6, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>(<span class="number">5</span>)); <span class="comment">//&#123;value: 8, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<p>示例代码中，当通过next()方法传入参数时，会赋值给yield语句中的变量。</p>
<blockquote>
<p>在迭代器中抛出错误</p>
</blockquote>
<p>能传递给迭代器的不仅是数据，还可以是错误，迭代器可以选择一个<code>throw()</code>方法，用于指示迭代器应在恢复执行时抛出一个错误：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//迭代器抛出错误</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> first = <span class="keyword">yield</span> <span class="number">1</span>;		</span><br><span class="line">	<span class="keyword">let</span> second = <span class="keyword">yield</span> first+<span class="number">2</span>;		</span><br><span class="line">	<span class="keyword">let</span> third = <span class="keyword">yield</span> second+<span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>(<span class="number">4</span>)); <span class="comment">//&#123;value: 6, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="keyword">throw</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Error!&#x27;</span>))); <span class="comment">//Uncaught Error: Error!</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//不会执行</span></span><br></pre></td></tr></table></figure>

<p>在生成器中同样可以使用<code>try-catch</code>来捕捉错误：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> first = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">let</span> second;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		second = <span class="keyword">yield</span> first+<span class="number">2</span>;</span><br><span class="line">	&#125;<span class="keyword">catch</span>(ex)&#123;</span><br><span class="line">		second = <span class="number">6</span></span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="keyword">let</span> third = <span class="keyword">yield</span> second+<span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">generator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>(<span class="number">4</span>)); <span class="comment">//&#123;value: 6, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="keyword">throw</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Error!&#x27;</span>))); <span class="comment">//&#123;value: 9, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>()); <span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>生成器的return语句</p>
</blockquote>
<p>由于生成器是函数，你可以在它内部使用 <code>return</code> 语句，既可以让生成器早一点退出执行，也可以指定在 <code>next()</code> 方法最后一次调用时的返回值。大多数情况，迭代器上的<br><code>next()</code> 的最后一次调用都返回了 <code>undefined</code> ，但你还可以像在其他函数中那样，使用<br><code>return</code> 来指定另一个返回值。在生成器内， return 表明所有的处理已完成，因此 done<br>属性会被设为 true ，而如果提供了返回值，就会被用于 value 字段。比如，利用return让生成器更早的退出：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">gene</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">gene</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<p>由于使用return语句，能够让生成器更早结束，因此在第二次以及第三次调用next()方法时，返回结果对象为：<code>&#123;value: undefined, done: true&#125;</code>。</p>
<p>还可以使用return语句指定最后返回值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">gene</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;finish&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">gene</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: &quot;finish&quot;, done: true&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<p>当第二次调用next()方法时，返回了设置的返回值：<code>finish</code>。第三次调用 <code>next()</code> 返回了一个对象，其 <code>value</code> 属性再次变回<code>undefined</code> ，你在 <code>return</code> 语句中指定的任意值都只会在结果对象中出现一次，此后 <code>value</code> 字段就会被重置为 <code>undefined</code> 。</p>
<blockquote>
<p>生成器委托</p>
</blockquote>
<p>生成器委托是指：将生成器组合起来使用，构成一个生成器。组合生成器的语法需要<code>yield</code>和<code>*</code>，<code>*</code>落在<code>yield</code>关键字与生成器函数名之间即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> * <span class="title function_">gene1</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="string">&#x27;green&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gene2</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">combined</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> * <span class="title function_">gene1</span>();</span><br><span class="line">	<span class="keyword">yield</span> * <span class="title function_">gene2</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">combined</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: &quot;red&quot;, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: &quot;green&quot;, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 2, done: true&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<p>此例中将生成器gene1和gene2组合而成生成器combined，每次调用combined的next()方法时，实际上会委托到具体的生成器中，当gene1生成器中所有的yield执行完退出之后，才会继续执行gene2，当gene2执行完退出之后，也就意味着combined生成器执行结束。</p>
<p>在使用生成器委托组合新的生成器时，前一个执行的生成器返回值可以作为下一个生成器的参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用生成器返回值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gene1</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">gene2</span>(<span class="params">count</span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;count;i++)&#123;</span><br><span class="line">		<span class="keyword">yield</span> <span class="string">&#x27;repeat&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">combined</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> result = <span class="keyword">yield</span> * <span class="title function_">gene1</span>();</span><br><span class="line">	<span class="keyword">yield</span> result;</span><br><span class="line">	<span class="keyword">yield</span>*<span class="title function_">gene2</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="title function_">combined</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: 2, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: &quot;repeat&quot;, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: &quot;repeat&quot;, done: false&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>());<span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>

<p>此例中，生成器gene1的返回值，就作为了生成器gene2的参数。</p>
<h3 id="异步任务"><a href="#异步任务" class="headerlink" title="异步任务"></a>异步任务</h3><blockquote>
<p>一个简单的任务运行器</p>
</blockquote>
<p>生成器函数中yield能暂停运行，当再次调用next()方法时才会重新往下运行。一个简单的任务执行器，就需要传入一个生成器函数，然后每一次调用next()方法就会“一步步”往下执行函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//任务执行器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">taskDef</span>) &#123;</span><br><span class="line">	<span class="comment">// 创建迭代器，让它在别处可用</span></span><br><span class="line">	<span class="keyword">let</span> task = <span class="title function_">taskDef</span>();</span><br><span class="line">	<span class="comment">// 启动任务</span></span><br><span class="line">	<span class="keyword">let</span> result = task.<span class="title function_">next</span>();</span><br><span class="line">	<span class="comment">// 递归使用函数来保持对 next() 的调用</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">step</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="comment">// 如果还有更多要做的</span></span><br><span class="line">	<span class="keyword">if</span> (!result.<span class="property">done</span>) &#123;</span><br><span class="line">		result = task.<span class="title function_">next</span>();</span><br><span class="line">		<span class="title function_">step</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="comment">// 开始处理过程</span></span><br><span class="line">	<span class="title function_">step</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">run</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">yield</span>;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">	<span class="keyword">yield</span>;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>run()</code> 函数接受一个任务定义（即一个生成器函数） 作为参数，它会调用生成器来创建一个<br>迭代器，并将迭代器存放在 <code>task</code> 变量上。第一次对 <code>next()</code> 的调用启动<br>了迭代器，并将结果存储下来以便稍后使用。<code> step()</code> 函数查看<code> result.done</code> 是否为 <code>false</code>，如果是就在递归调用自身之前调用 <code>next()</code> 方法。每次调用 <code>next()</code> 都会把返回的结果保<br>存在 <code>result</code> 变量上，它总是会被最新的信息所重写。对于 <code>step()</code> 的初始调用启动了处理<br>过程，该过程会查看 <code>result.done</code> 来判断是否还有更多要做的工作。</p>
<blockquote>
<p>能够传递数据的任务运行器</p>
</blockquote>
<p>如果需要传递数据的话，也很容易，也就是将上一次<code>yield</code>的值，传递给下一次<code>next()</code>调用即可，仅仅只需要传送结果对象的<code>value</code>属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//任务执行器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">taskDef</span>) &#123;</span><br><span class="line">	<span class="comment">// 创建迭代器，让它在别处可用</span></span><br><span class="line">	<span class="keyword">let</span> task = <span class="title function_">taskDef</span>();</span><br><span class="line">	<span class="comment">// 启动任务</span></span><br><span class="line">	<span class="keyword">let</span> result = task.<span class="title function_">next</span>();</span><br><span class="line">	<span class="comment">// 递归使用函数来保持对 next() 的调用</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">step</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="comment">// 如果还有更多要做的</span></span><br><span class="line">		<span class="keyword">if</span> (!result.<span class="property">done</span>) &#123;</span><br><span class="line">			result = task.<span class="title function_">next</span>(result.<span class="property">value</span>);				</span><br><span class="line">			<span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">value</span>); <span class="comment">//6 undefined</span></span><br><span class="line">			<span class="title function_">step</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="comment">// 开始处理过程</span></span><br><span class="line">	<span class="title function_">step</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">run</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">	<span class="keyword">let</span> value = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">yield</span> value+<span class="number">5</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<blockquote>
<p>异步任务</p>
</blockquote>
<p>上面的例子是简单的任务处理器，甚至还是同步的。实现任务器也主要是迭代器在每一次调用<code>next()</code>方法时彼此间传递静态参数。如果要将上面的任务处理器改装成异步任务处理器的话，就需要<code>yield</code>能够返回一个<strong>能够执行回调函数的函数，并且回调参数为该函数的参数</strong>即可。</p>
<p><strong>什么是有回调函数的函数？</strong></p>
<p>有这样的示例代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">		<span class="title function_">callback</span>(<span class="literal">null</span>, <span class="string">&quot;Hi!&quot;</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数<code>fetchData</code>返回的是一个函数，并且所返回的函数能够接受一个函数callback。当执行返回的函数时，实际上是调用回调函数<code>callback</code>。但目前而言，回调函数callback还是同步的，可以改造成异步函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">			<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">				<span class="title function_">callback</span>(<span class="literal">null</span>, <span class="string">&quot;Hi!&quot;</span>);</span><br><span class="line">		&#125;, <span class="number">50</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>一个简单的异步任务处理器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//异步任务处理器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">taskDef</span>)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//执行生成器，创建迭代器</span></span><br><span class="line">	<span class="keyword">let</span> task = <span class="title function_">taskDef</span>();</span><br><span class="line">	<span class="comment">//启动任务</span></span><br><span class="line">	<span class="keyword">let</span> result = task.<span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">step</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">while</span>(!result.<span class="property">done</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_">typeof</span>(result.<span class="property">value</span>)===<span class="string">&#x27;function&#x27;</span> )&#123;</span><br><span class="line">				result.<span class="title function_">value</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">					<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;					</span><br><span class="line">			result = task.<span class="title function_">next</span>();</span><br><span class="line">			<span class="title function_">step</span>();</span><br><span class="line">		&#125;			</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">step</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​<br>​<br>​    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">run</span>(<span class="keyword">function</span> *()&#123;</span><br><span class="line">	<span class="comment">//返回一个能够返回执行回调函数的函数，并且回调函数还是该</span></span><br><span class="line">	<span class="comment">//函数的参数</span></span><br><span class="line">	<span class="keyword">yield</span> <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">		<span class="built_in">setTimeout</span>(callback,<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>上面的示例代码就是一个简单的异步任务处理器，有这样几点要点：</p>
<ol>
<li>使用生成器构造迭代器，所以在<code>run</code>方法中传入的是生成器函数；</li>
<li>生成器函数中<code>yield</code>关键字，返回的是<strong>一个能够执行回调函数的函数，并且回调函数是该函数的一个参数</strong>；</li>
</ol>
<h3 id="总结-5"><a href="#总结-5" class="headerlink" title="总结"></a>总结</h3><ol>
<li>使用迭代器可以用来遍历集合对象包含的数据，调用迭代器的<code>next()</code>方法可以返回一个结果对象，其中<code>value</code>属性代表值，<code>done</code>属性用来表示集合对象是否已经到了最后一项，如果集合对象的值全部遍历完后，<code>done</code>属性为<code>true</code>；</li>
<li><code>Symbol.iterator</code>属性被用于定义对象的默认迭代器，使用该属性可以为对象自定义迭代器。当<code>Symbol.iterator</code>属性存在时，该对象可以被认为是可迭代对象；</li>
<li>可迭代对象可以使用for-of循环，for-of循环不需要关注集合对象的索引，更能专注于对内容的处理；</li>
<li>数组、Set、Map以及字符串都具有默认的迭代器；</li>
<li>扩展运算符可以作用于任何可迭代对象，让可迭代对象转换成数组，并且扩展运算符可以用于数组字面量中任何位置中，让可迭代对象的数据项一次填入到新数组中；</li>
<li>生成器是一个特殊的函数，语法上使用了<code>*</code>，yield能够返回结果，并能暂停继续往下执行，直到调用next()方法后，才能继续往下执行。使用生成器委托能够将两个生成器合并组合成一个生成器；</li>
<li>能够使用生成器构造异步任务处理器；</li>
</ol>
<h3 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		//生成器</span><br><span class="line"></span><br><span class="line">		// function*generator()&#123;</span><br><span class="line"></span><br><span class="line">		// 	yield 1;</span><br><span class="line">		// 	yield 2;</span><br><span class="line">		// 	yield 3;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// let iterator = generator();</span><br><span class="line">		// console.log(iterator.next().value);</span><br><span class="line">		// console.log(iterator.next().value);</span><br><span class="line"></span><br><span class="line">		// let arr = [1,2,3];</span><br><span class="line">		// // for(let num of arr)&#123;</span><br><span class="line">		// // 	console.log(num);</span><br><span class="line">		// // &#125;</span><br><span class="line"></span><br><span class="line">		// //访问默认迭代器</span><br><span class="line"></span><br><span class="line">		// let iterator = arr[Symbol.iterator]();</span><br><span class="line">		// console.log(iterator.next().value);</span><br><span class="line">		// console.log(iterator.next().value);</span><br><span class="line"></span><br><span class="line">		//创建可迭代对象</span><br><span class="line"></span><br><span class="line">		// let obj = &#123;</span><br><span class="line">		// 	items:[],</span><br><span class="line"></span><br><span class="line">		// 	*[Symbol.iterator]()&#123;</span><br><span class="line">		// 		for(let item of this.items)&#123;</span><br><span class="line">		// 			yield item;</span><br><span class="line">		// 		&#125;</span><br><span class="line">		// 	&#125;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// obj.items.push(1);</span><br><span class="line">		// obj.items.push(2);</span><br><span class="line"></span><br><span class="line">		// for(let num of obj)&#123;</span><br><span class="line">		// 	console.log(num);</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		//字符串默认迭代器</span><br><span class="line">		// let str =&#x27;A   B&#x27;;</span><br><span class="line">		// for(let s of str)&#123;</span><br><span class="line">		// 	console.log(s);</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		//扩展运算符可作用到所有可迭代对象</span><br><span class="line">		// let arr = [1,2,3];</span><br><span class="line">		// let arr2 = [7,8,9];</span><br><span class="line">		// let array = [...arr,5,...arr2];</span><br><span class="line">		// console.log(array);</span><br><span class="line"></span><br><span class="line">		//迭代器的高级功能,next()方法传递参数</span><br><span class="line">		// function * generator()&#123;</span><br><span class="line">		// 	let first = yield 1;		</span><br><span class="line">		// 	let second = yield first+2;		</span><br><span class="line">		// 	let third = yield second+3;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// let iterator = generator();</span><br><span class="line">		// console.log(iterator.next()); //&#123;value: 1, done: false&#125;</span><br><span class="line">		// console.log(iterator.next(4)); //&#123;value: 6, done: false&#125;</span><br><span class="line">		// console.log(iterator.next(5)); //&#123;value: 8, done: false&#125;</span><br><span class="line">		// console.log(iterator.next()); //&#123;value: undefined, done: true&#125;</span><br><span class="line"></span><br><span class="line">		//迭代器抛出错误</span><br><span class="line"></span><br><span class="line">		// function * generator()&#123;</span><br><span class="line">		// 	let first = yield 1;</span><br><span class="line">		// 	let second;</span><br><span class="line">		// 	try&#123;</span><br><span class="line">		// 		second = yield first+2;</span><br><span class="line">		// 	&#125;catch(ex)&#123;</span><br><span class="line">		// 		second = 6</span><br><span class="line">		// 	&#125;	</span><br><span class="line">		// 	let third = yield second+3;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		// let iterator = generator();</span><br><span class="line">		// console.log(iterator.next()); //&#123;value: 1, done: false&#125;</span><br><span class="line">		// console.log(iterator.next(4)); //&#123;value: 6, done: false&#125;</span><br><span class="line">		// console.log(iterator.throw(new Error(&#x27;Error!&#x27;))); //&#123;value: 9, done: false&#125;</span><br><span class="line">		// console.log(iterator.next()); //&#123;value: undefined, done: true&#125;</span><br><span class="line"></span><br><span class="line">		//生成器的return语句</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		// function * gene()&#123;</span><br><span class="line">		// 	yield 1;</span><br><span class="line">		// 	return &#x27;finish&#x27;;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// let iterator = gene();</span><br><span class="line">		// console.log(iterator.next());//&#123;value: 1, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: &quot;finish&quot;, done: true&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: undefined, done: true&#125;</span><br><span class="line"></span><br><span class="line">		//生成器委托</span><br><span class="line"></span><br><span class="line">		// function * gene1()&#123;</span><br><span class="line">		// 	yield &#x27;red&#x27;;</span><br><span class="line">		// 	yield &#x27;green&#x27;;</span><br><span class="line"></span><br><span class="line">		// &#125;</span><br><span class="line">		// function * gene2()&#123;</span><br><span class="line">		// 	yield 1;</span><br><span class="line">		// 	yield 2;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// function * combined()&#123;</span><br><span class="line">		// 	yield * gene1();</span><br><span class="line">		// 	yield * gene2();</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// let iterator = combined();</span><br><span class="line">		// console.log(iterator.next());//&#123;value: &quot;red&quot;, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: &quot;green&quot;, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: 1, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: 2, done: true&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: undefined, done: true&#125;</span><br><span class="line"></span><br><span class="line">		// //利用生成器返回值</span><br><span class="line"></span><br><span class="line">		// function * gene1()&#123;</span><br><span class="line">		// 	yield 1;</span><br><span class="line">		// 	return 2;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// function * gene2(count)&#123;</span><br><span class="line"></span><br><span class="line">		// 	for(let i=0;i&lt;count;i++)&#123;</span><br><span class="line">		// 		yield &#x27;repeat&#x27;;</span><br><span class="line">		// 	&#125;</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line">		// function * combined()&#123;</span><br><span class="line">		// 	let result = yield * gene1();</span><br><span class="line">		// 	yield result;</span><br><span class="line">		// 	yield*gene2(result);</span><br><span class="line">		// &#125;</span><br><span class="line">		// let iterator = combined();</span><br><span class="line">		// console.log(iterator.next());//&#123;value: 1, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: 2, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: &quot;repeat&quot;, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: &quot;repeat&quot;, done: false&#125;</span><br><span class="line">		// console.log(iterator.next());//&#123;value: undefined, done: true&#125;</span><br><span class="line"></span><br><span class="line">		// //任务执行器</span><br><span class="line">		// function run(taskDef) &#123;</span><br><span class="line">		// 	// 创建迭代器，让它在别处可用</span><br><span class="line">		// 	let task = taskDef();</span><br><span class="line">		// 	// 启动任务</span><br><span class="line">		// 	let result = task.next();</span><br><span class="line">		// 	// 递归使用函数来保持对 next() 的调用</span><br><span class="line">		// 	function step() &#123;</span><br><span class="line">		// 		// 如果还有更多要做的</span><br><span class="line">		// 		if (!result.done) &#123;</span><br><span class="line">		// 			result = task.next(result.value);				</span><br><span class="line">		// 			console.log(result.value);</span><br><span class="line">		// 			step();</span><br><span class="line">		// 		&#125;</span><br><span class="line">		// 	&#125; </span><br><span class="line">		// 	// 开始处理过程</span><br><span class="line">		// 	step();</span><br><span class="line">		// &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		// run(function*() &#123;</span><br><span class="line">		// 	let value = yield 1;</span><br><span class="line">		// 	yield value+5;</span><br><span class="line">		// &#125;);</span><br><span class="line"></span><br><span class="line">		//异步任务处理器</span><br><span class="line"></span><br><span class="line">		function run(taskDef)&#123;</span><br><span class="line"></span><br><span class="line">			//执行生成器，创建迭代器</span><br><span class="line">			let task = taskDef();</span><br><span class="line">			//启动任务</span><br><span class="line">			let result = task.next();</span><br><span class="line"></span><br><span class="line">			function step()&#123;</span><br><span class="line">				while(!result.done)&#123;</span><br><span class="line">					if(typeof(result.value)===&#x27;function&#x27; )&#123;</span><br><span class="line">						result.value(()=&gt;&#123;</span><br><span class="line">							console.log(&#x27;hello world&#x27;);</span><br><span class="line">						&#125;)</span><br><span class="line">					&#125;					</span><br><span class="line">					result = task.next();</span><br><span class="line">					step();</span><br><span class="line">				&#125;			</span><br><span class="line">			&#125;</span><br><span class="line">			step();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		run(function *()&#123;</span><br><span class="line">			//返回一个能够返回执行回调函数的函数，并且回调函数还是该</span><br><span class="line">			//函数的参数</span><br><span class="line">			yield function(callback)&#123;</span><br><span class="line">				setTimeout(callback,3000);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="推荐blue老师的库源码—"><a href="#推荐blue老师的库源码—" class="headerlink" title="推荐blue老师的库源码—"></a>推荐blue老师的库源码—</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=runner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">runner</span>(<span class="params">_gen</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> gen=<span class="title function_">_gen</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">_next</span>();</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_next</span>(<span class="params">_last_res</span>)&#123;</span><br><span class="line">      <span class="keyword">var</span> res=gen.<span class="title function_">next</span>(_last_res);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(!res.<span class="property">done</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> obj=res.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)&#123;</span><br><span class="line">          obj.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">_next</span>(res);</span><br><span class="line">          &#125;, <span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span> obj==<span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">          <span class="keyword">if</span>(obj.<span class="property">constructor</span>.<span class="title function_">toString</span>().<span class="title function_">startsWith</span>(<span class="string">&#x27;function GeneratorFunction()&#x27;</span>))&#123;</span><br><span class="line">            <span class="title function_">runner</span>(obj).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span><span class="title function_">_next</span>(res), reject);</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_">_next</span>(<span class="title function_">obj</span>());</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="title function_">_next</span>(obj);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">resolve</span>(res.<span class="property">value</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>简单使用</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> runner=<span class="built_in">require</span>(<span class="string">&#x27;./index&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">gen</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> a=<span class="keyword">yield</span> <span class="number">12</span>;</span><br><span class="line">  <span class="keyword">var</span> b=<span class="keyword">yield</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">runner</span>(<span class="keyword">function</span>* ()&#123;</span><br><span class="line">  <span class="keyword">var</span> num=<span class="keyword">yield</span> gen;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(num);   <span class="comment">//excepted 17</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="类的声明"><a href="#类的声明" class="headerlink" title="类的声明"></a>类的声明</h2><blockquote>
<p>基本的类声明</p>
</blockquote>
<p>类声明以<code>class</code>关键字开始，其后是类的名称；类中的方法就像是对象字面量中的方法简写，并且方法之间不需要使用逗号：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PersonClass</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">sayName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">PersonClass</span>(<span class="string">&quot;hello class&quot;</span>);</span><br><span class="line">person.<span class="title function_">sayName</span>();</span><br></pre></td></tr></table></figure>

<p>类声明语法允许使用<code>constructor</code>直接定义一个构造器，而不需要先定义一个函数，再把它当做构造器来使用。类中的方法使用的函数简写语法，省略了关键字<code>function</code>。</p>
<p>使用class关键字来定义一个类型，有这样几个要点：</p>
<ol>
<li>类声明不会被提升，这与ES6之前通过函数定义不同。类声明与使用<code>let</code>定义一样，因此也存在暂时性死区；</li>
<li>类声明中的所有代码会自动运行在严格模式下，并且无法退出严格模式；</li>
<li>类的所有方法都是不可枚举的；</li>
<li>类的所有内部方法都没有<code>[[Constructor]]</code>，因此使用<code>new</code>来调用他们会抛出错误；</li>
<li>调用类构造器时不使用<code>new</code>，会抛出错误；</li>
<li>试图在类的内部方法中重写类名，会抛出错误；</li>
</ol>
<h3 id="类表达式"><a href="#类表达式" class="headerlink" title="类表达式"></a>类表达式</h3><p>类与函数有相似之处，都有两种形式：声明与表达式。函数声明与类声明都以关键词开始（分别是function和class），之后就是标识符（即函数名或者类名）。如果需要定义匿名函数，则function后面就无需有函数名，类似的，如果采用类表达式，关键是class后也无需有类名；</p>
<blockquote>
<p>基本的类表达式</p>
</blockquote>
<p>使用类表达式，将上例改成如下形式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">PersonClass</span> = <span class="keyword">class</span> &#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">sayName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">PersonClass</span>(<span class="string">&quot;hello class&quot;</span>);</span><br><span class="line">person.<span class="title function_">sayName</span>(); <span class="comment">//hello  class</span></span><br></pre></td></tr></table></figure>

<p><strong>示例代码中就定义了一个匿名的类表达式，如果需要定义一个具名的类表达式，只需要像定义具名函数一样，在class关键字后面写上类名即可。</strong></p>
<h3 id="类的重要要点"><a href="#类的重要要点" class="headerlink" title="类的重要要点"></a>类的重要要点</h3><blockquote>
<p>作为一级公民的类</p>
</blockquote>
<p>在编程中，<strong>能够被当作值来使用的就成为一级公民（first-class citizen）</strong>。既然都当作值使用，就说明它能够作为参数传递给函数、能作为函数的返回值也能用来给变量赋值。JS中的函数是一等公民，类也是一等公民。</p>
<p>例如，将类作为参数传递给函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function createObj(classDef)&#123;</span><br><span class="line">	return new classDef();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let obj = createObj(class&#123;</span><br><span class="line">	sayName()&#123;</span><br><span class="line">		console.log(&#x27;hello&#x27;); //hello</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">obj.sayName();</span><br></pre></td></tr></table></figure>

<p><strong>类表达式另一个重要用途是实现立即调用类构造器以创建单例。</strong>语法是使用<code>new</code>来配合类表达式使用，并在表达式后面添加括号()：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//立即调用构造器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="keyword">class</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">sayName</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line"></span><br><span class="line">person.<span class="title function_">sayName</span>(); <span class="comment">//hello world</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>访问器属性</p>
</blockquote>
<p>自有属性需要在类构造器中创建，而类还允许创建访问器属性。为了创建一个<code>getter</code>，要使用<code>get</code>关键字，并要与后面的标识符之间留出空格；创建<code>setter</code>使用相同的方式，只需要将关键字换成<code>set</code>即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PersonClass</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">get</span> <span class="title function_">name</span>()&#123;</span><br><span class="line">		<span class="keyword">return</span> name; <span class="comment">//不要使用this.name会导致无限递归</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">set</span> <span class="title function_">name</span>(<span class="params">value</span>)&#123;</span><br><span class="line">		name=value; <span class="comment">//不要使用this.value会导致无限递归</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">PersonClass</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">// hello</span></span><br><span class="line">person.<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">//world</span></span><br><span class="line"><span class="keyword">let</span> descriptor = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(<span class="title class_">PersonClass</span>.<span class="property"><span class="keyword">prototype</span></span>,<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;get&#x27;</span> <span class="keyword">in</span> descriptor); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>需计算属性名</p>
</blockquote>
<p>对象字面量和类之间的相似点有很多，类方法与类访问器属性都能使用需计算属性名的方式，语法与对象字面量中需计算属性名一样，都是使用方括号[]来包裹表达式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需计算属性名</span></span><br><span class="line"><span class="keyword">let</span> methodName =<span class="string">&#x27;sayName&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> propertyName = <span class="string">&#x27;name&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonClass</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	get [propertyName]()&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	set [propertyName](value)&#123;</span><br><span class="line">		name = value;</span><br><span class="line">	&#125;</span><br><span class="line">	[methodName]()&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">PersonClass</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">person.<span class="title function_">sayName</span>(); <span class="comment">//hello world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">//hello world</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>生成器方法</p>
</blockquote>
<p>在对象字面量中定义一个生成器：只需要在方法名前附加一个星号<code>*</code>即可，这一语法对类同样有效，允许将类的任意内部方法编程生成器方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成器方法：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GeneClass</span>&#123;</span><br><span class="line"></span><br><span class="line">	*<span class="title function_">generator</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">yield</span> <span class="number">2</span>;				</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title class_">GeneClass</span>();</span><br><span class="line"><span class="keyword">let</span> iterator = obj.<span class="title function_">generator</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">//2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(iterator.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>

<p>可迭代对象用于<code>Symbol.iterator</code>属性，并且该属性指向生成器函数。因此，在类定义中同样可以使用<code>Symbol.iterator</code>属性来定义生成器方法，从而定义出类的默认迭代器。同时也可以通过生成器委托的方式，将数组、Set、Map等迭代器委托给自定义类的迭代器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Collection</span> &#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">items</span> = [];</span><br><span class="line">	&#125; </span><br><span class="line">	*[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">items</span>)&#123;</span><br><span class="line">			<span class="keyword">yield</span> item;</span><br><span class="line">		&#125;				</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> collection = <span class="keyword">new</span> <span class="title class_">Collection</span>();</span><br><span class="line">collection.<span class="property">items</span>.<span class="title function_">push</span>(<span class="number">1</span>);</span><br><span class="line">collection.<span class="property">items</span>.<span class="title function_">push</span>(<span class="number">2</span>);</span><br><span class="line">collection.<span class="property">items</span>.<span class="title function_">push</span>(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> collection) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">输出：<span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>静态成员</p>
</blockquote>
<p>ES6的类简化了静态成员的创建，只要在方法与访问器属性的名称前添加<code>static</code>关键字即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PersonClass</span> &#123;</span><br><span class="line">	<span class="comment">// 等价于 PersonType 构造器</span></span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">static</span> <span class="title function_">create</span>(<span class="params">name</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PersonClass</span>(name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="title class_">PersonClass</span>.<span class="title function_">create</span>(<span class="string">&quot;Nicholas&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>通过在方法前加上<code>static</code>关键字，使其转换成静态方法。能在类中的任何方法与访问器属性上使用 <code>static</code> 关键字，唯一限制是不能将它用于 <code>constructor</code> 方法的定义。<strong>静态成员不能用实例来进行访问，始终需要用类自身才能访问它们。</strong></p>
<blockquote>
<p>类继承</p>
</blockquote>
<p>使用关键字extends可以完成类继承，同时使用super关键字可以在派生类上访问到基类上的方法，包括构造器方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类继承</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rec</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">width,height</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">width</span> = width;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">height</span> = height;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="title function_">getArea</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">width</span>*<span class="variable language_">this</span>.<span class="property">height</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Rec</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">width,height</span>)&#123;</span><br><span class="line">		<span class="variable language_">super</span>(width,height);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> square = <span class="keyword">new</span> <span class="title class_">Square</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(square.<span class="title function_">getArea</span>()); <span class="comment">//10000</span></span><br></pre></td></tr></table></figure>

<p>关于类继承，还有这样几个要点：</p>
<ol>
<li><strong>在派生类中方法会覆盖掉基类中的同名方法，</strong>例如在派生类<code>Square</code>中有<code>getArea()</code>方法的话就会覆盖掉基类<code>Rec</code>中的<code>getArea()</code>方法；</li>
<li>如果基类中包含了静态成员，那么这些静态成员在派生类中也是可以使用的。注意：<strong>静态成员只能通过类名进行访问，而不是使用对象实例进行访问</strong>；</li>
</ol>
<blockquote>
<p>从表达式中派生类</p>
</blockquote>
<p>在ES6中派生类<strong>最大的能力就是能够从表达式中派生类</strong>，只要一个表达式能够返回的对象具有<code>[[Constructor]]</code>属性以及原型，你就可以对该表达式使用<code>extends</code>进行继承。<strong>由于extends后面能够接收任意类型的表达式，这就带来了巨大的可能性，可以动态决定基类，因此一种对象混入的方式：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从表达式中派生类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">SerializableMixin</span> = &#123;</span><br><span class="line">	<span class="title function_">serialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> <span class="title class_">AreaMixin</span> = &#123;</span><br><span class="line">	<span class="title function_">getArea</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">length</span> * <span class="variable language_">this</span>.<span class="property">width</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mixin</span>(<span class="params">...mixins</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> base = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line">	<span class="title class_">Object</span>.<span class="title function_">assign</span>(base.<span class="property"><span class="keyword">prototype</span></span>, ...mixins);</span><br><span class="line">	<span class="keyword">return</span> base;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">mixin</span>(<span class="title class_">AreaMixin</span>, <span class="title class_">SerializableMixin</span>) &#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">length</span>) &#123;</span><br><span class="line">	<span class="variable language_">super</span>();</span><br><span class="line">	<span class="variable language_">this</span>.<span class="property">length</span> = length;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="property">width</span> = length;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="title class_">Square</span>(<span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x.<span class="title function_">getArea</span>()); <span class="comment">// 9</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x.<span class="title function_">serialize</span>()); <span class="comment">// &quot;&#123;&quot;length&quot;:3,&quot;width&quot;:3&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>mixin() </code>函数接受代表混入对象的任意数量的参数，它创建了一个名为 <code>base</code> 的函数，并将每个混入对象的属性都赋值到新函数的原型上。此函数随后被返回，于是 <code>Square</code> 就能够对其使用 <code>extends</code> 关键字了。注意由于仍然使用了 <code>extends</code> ，你就必须在构造器内调用 <code>super()</code>。若多个混入对象拥有相同的属性，则只有最后添加<br>的属性会被保留。</p>
<h3 id="继承内置对象"><a href="#继承内置对象" class="headerlink" title="继承内置对象"></a>继承内置对象</h3><p>在E6中能够通过<code>extends</code>继承JS中内置对象，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyArray</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Array</span> &#123;</span><br><span class="line"><span class="comment">// 空代码块</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> colors = <span class="keyword">new</span> <span class="title class_">MyArray</span>();</span><br><span class="line">colors[<span class="number">0</span>] = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors.<span class="property">length</span>); <span class="comment">// 1</span></span><br><span class="line">colors.<span class="property">length</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors[<span class="number">0</span>]); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Symbol.species</p>
</blockquote>
<p>属性<code>Symbol.species</code>被用于<strong>定义静态访问器属性</strong>，该属性值<strong>用来指定类的构造器</strong>。当创建一个新的对象实例时，就需要通过<code>Symbol.species</code>属性获取到构造器，从而新建对象实例。</p>
<p>下面内置对象都定义了<code>Symbol.species</code>属性：</p>
<ul>
<li>Array;</li>
<li>ArrayBuffer;</li>
<li>Map;</li>
<li>Promise;</li>
<li>RegExp;</li>
<li>Set;</li>
<li>类型化数组</li>
</ul>
<p>例如在自定义类型中，使用<code>Symbol.species</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">	<span class="keyword">static</span> get [<span class="title class_">Symbol</span>.<span class="property">species</span>]() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">value</span> = value;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="title function_">clone</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable language_">this</span>.<span class="property">constructor</span>[<span class="title class_">Symbol</span>.<span class="property">species</span>](<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDerivedClass1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">MyClass</span> &#123;</span><br><span class="line">	<span class="comment">// 空代码块</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDerivedClass2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">MyClass</span> &#123;</span><br><span class="line">	<span class="keyword">static</span> get [<span class="title class_">Symbol</span>.<span class="property">species</span>]() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="title class_">MyClass</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> instance1 = <span class="keyword">new</span> <span class="title class_">MyDerivedClass1</span>(<span class="string">&quot;foo&quot;</span>),</span><br><span class="line">clone1 = instance1.<span class="title function_">clone</span>(),</span><br><span class="line">instance2 = <span class="keyword">new</span> <span class="title class_">MyDerivedClass2</span>(<span class="string">&quot;bar&quot;</span>),</span><br><span class="line">clone2 = instance2.<span class="title function_">clone</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clone1 <span class="keyword">instanceof</span> <span class="title class_">MyClass</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clone1 <span class="keyword">instanceof</span> <span class="title class_">MyDerivedClass1</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clone2 <span class="keyword">instanceof</span> <span class="title class_">MyClass</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clone2 <span class="keyword">instanceof</span> <span class="title class_">MyDerivedClass2</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>此处, <code>MyDerivedClass1</code> 继承了 <code>MyClass</code> ，并且未修改 <code>Symbol.species</code> 属性。由于<br><code>this.constructor[Symbol.species]</code> 会返回 <code>MyDerivedClass1</code> ，当 <code>clone()</code> 被调用时，它就<br>返回了 <code>MyDerivedClass1</code> 的一个实例。 <code>MyDerivedClass2</code> 类也继承了 <code>MyClass</code> ，但重写了<br><code>Symbol.species </code>，让其返回 <code>MyClass</code> 。当 <code>clone()</code> 在 <code>MyDerivedClass2</code> 的一个实例上被调<br>用时，返回值就变成 <code>MyClass</code> 的一个实例。使用 <code>Symbol.species </code>，任意派生类在调用应当<br>返回实例的方法时，都可以判断出需要返回什么类型的值。</p>
<blockquote>
<p>在类构造器中使用new.target</p>
</blockquote>
<p>使用<code>new.target</code>属性能够判断当前实例对象是由哪个类构造器进行创建的，简单的情况下，<code>new.target</code>属性就等于该类的构造器函数，同时new.target属性也只能在构造器内被定义。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Rec</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span>.<span class="property">target</span>===<span class="title class_">Rec</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Rec</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rec = <span class="keyword">new</span> <span class="title class_">Rec</span>();</span><br><span class="line"><span class="keyword">let</span> square = <span class="keyword">new</span> <span class="title class_">Square</span>();</span><br><span class="line"></span><br><span class="line">输出：<span class="literal">true</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>当创建<code>Rec</code>对象实例时，<code>new.target</code>指代的是<code>Rec</code>自身的构造器，因此<code>new.target===Rec</code>会返回<code>true</code>，而<code>Rec</code>的派生类<code>Square</code>的<code>new.target</code>会指向它自身的构造器，因此<code>new.target===Rec</code>会返回false;</p>
<p><strong>可以使用new.target来创建一个抽象基类：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Rec</span>&#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">new</span>.<span class="property">target</span>===<span class="title class_">Rec</span>)&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;abstract class&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Rec</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rec = <span class="keyword">new</span> <span class="title class_">Rec</span>(); <span class="comment">//Uncaught Error: abstract class</span></span><br><span class="line"><span class="keyword">let</span> square = <span class="keyword">new</span> <span class="title class_">Square</span>(); <span class="comment">//不会报错</span></span><br></pre></td></tr></table></figure>

<p>当试图创建一个Rec实例对象时，会抛出错误，因此Rec可以当做一个抽象基类。</p>
<h3 id="总结-6"><a href="#总结-6" class="headerlink" title="总结"></a>总结</h3><ol>
<li>ES6中的类使用关键字class进行定义，即可以采用类声明的方式也可以采用类表达式进行定义。 此外，类构造器被调用时不能缺少 new ，确保了不能意外地将类作为函数来调用用。 </li>
<li>基于类的继承允许你从另一个类、函数或表达式上派生新的类。这种能力意味着你可以调用一个函数来判断需要继承的正确基类，也允许你使用混入或其他不同的组合模式来创建一个新类。新的继承方式让继承内置对象（例如数组） 也变为可能，并且其工作符合预期。</li>
<li>可以使用<code>new.target</code>来判断创建实例对象时所用的类构造器。利用<code>new.target</code>可以用来创建一个抽象基类；</li>
</ol>
<p>总之，类是 JS 的一项新特性，它提供了更简洁的语法与更好的功能，通过安全一致的方式来自定义一个对象类型。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//类表达式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let PersonClass = class &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(name)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	sayName()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		console.log(this.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = new PersonClass(&quot;hello class&quot;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person.sayName();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//类作为参数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// function createObj(classDef)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return new classDef();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let obj = createObj(class&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	sayName()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		console.log(&#x27;hello&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// obj.sayName();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//立即调用构造器</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = new class&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(name)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	sayName()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		console.log(this.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;(&#x27;hello world&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person.sayName(); //hello world</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//访问器属性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class PersonClass&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(name)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	get name()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	set name(value)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		name=value;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = new PersonClass(&#x27;hello&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(person.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person.name = &#x27;world&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(person.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let descriptor = Object.getOwnPropertyDescriptor(PersonClass.prototype,&#x27;name&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(&#x27;get&#x27; in descriptor);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //需计算属性名</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let methodName =&#x27;sayName&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let propertyName = &#x27;name&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class PersonClass&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(name)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	get [propertyName]()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	set [propertyName](value)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		name = value;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	[methodName]()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return console.log(this.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = new PersonClass(&#x27;hello world&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// person.sayName();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(person.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //生成器方法：</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class GeneClass&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	*generator()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		yield 1;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		yield 2;				</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let obj = new GeneClass();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let iterator = obj.generator();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(iterator.next().value); //1</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(iterator.next().value); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(iterator.next().value); //undefined</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//自定义类的默认迭代器</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class Collection &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.items = [];</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	*[Symbol.iterator]() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		for(let item of this.items)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			yield item;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;				</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let collection = new Collection();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// collection.items.push(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// collection.items.push(2);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// collection.items.push(3);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// for (let x of collection) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(x);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//静态成员</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class PersonClass &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	// 等价于 PersonType 构造器</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(name) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.name = name;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	static create(name) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return new PersonClass(name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let person = PersonClass.create(&quot;Nicholas&quot;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //类继承</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class Rec&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(width,height)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.width = width;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.height = height;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	getArea()&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return this.width*this.height;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class Square extends Rec&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(width,height)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		super(width,height);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let square = new Square(100,100);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(square.getArea()); //10000</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //从表达式中派生类</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let SerializableMixin = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// serialize() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return JSON.stringify(this);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let AreaMixin = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	getArea() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return this.length * this.width;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// function mixin(...mixins) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	var base = function() &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	Object.assign(base.prototype, ...mixins);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return base;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class Square extends mixin(AreaMixin, SerializableMixin) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(length) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	super();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	this.length = length;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	this.width = length;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let x = new Square(3);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(x.getArea()); // 9</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(x.serialize()); // &quot;&#123;&quot;length&quot;:3,&quot;width&quot;:3&#125;&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//继承内置对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class MyArray extends Array &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// // 空代码块</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let colors = new MyArray();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// colors[0] = &quot;red&quot;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(colors.length); // 1</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// colors.length = 0;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(colors[0]); // undefined</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Symbol.species</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class MyClass &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	static get [Symbol.species]() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return this;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	constructor(value) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		this.value = value;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	clone() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return new this.constructor[Symbol.species](this.value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class MyDerivedClass1 extends MyClass &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	// 空代码块</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// class MyDerivedClass2 extends MyClass &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	static get [Symbol.species]() &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return MyClass;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let instance1 = new MyDerivedClass1(&quot;foo&quot;),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// clone1 = instance1.clone(),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// instance2 = new MyDerivedClass2(&quot;bar&quot;),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// clone2 = instance2.clone();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(clone1 instanceof MyClass); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(clone1 instanceof MyDerivedClass1); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(clone2 instanceof MyClass); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(clone2 instanceof MyDerivedClass2); // false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//new.target</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">class</span> <span class="title class_">Rec</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="keyword">if</span>(<span class="keyword">new</span>.<span class="property">target</span>===<span class="title class_">Rec</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;abstract class&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Rec</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> rec = <span class="keyword">new</span> <span class="title class_">Rec</span>(); <span class="comment">//Uncaught Error: abstract class</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> square = <span class="keyword">new</span> <span class="title class_">Square</span>(); <span class="comment">//不会报错</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>





<h2 id="数组新方法"><a href="#数组新方法" class="headerlink" title="数组新方法"></a>数组新方法</h2><p>在 ES6 之前创建数组主要存在两种方式： <code>Array</code> 构造器与数组字面量写法。这两种方式都需要将数组的项分别列出，并且还要受到其他限制。将“类数组对象”（即：拥有数值类型索引与长度属性的对象） 转换为数组也并不自由，经常需要书写额外的代码。为了使数组更易创建，ES6 新增了<code> Array.of()</code> 与 <code>Array.from()</code> 方法。</p>
<blockquote>
<p>Array.of()方法</p>
</blockquote>
<p>Array.of()方法会将方法的传入参数全部作为数组里的数据内容，而不管参数的数量与类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let items = Array.of(1,&#x27;2&#x27;);</span><br><span class="line">console.log(items); //Array(2)</span><br><span class="line">console.log(items.length); //2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Array.from()方法</p>
</blockquote>
<p>可使用Array.from()方法可以将类数组对象和可迭代对象转换成数组。该方法接收三个参数：</p>
<ol>
<li>待转换的可迭代对象或者类数组对象（具有数值索引和长度属性的对象）；</li>
<li>可选的映射函数；</li>
<li>指定映射函数内部的 <code>this</code> 值；</li>
</ol>
<p><strong>映射转换</strong></p>
<p>如果你想实行进一步的数组转换，你可以向 Array.from() 方法传递一个映射用的函数作为第二个参数。此函数会将类数组对象的每一个值转换为目标形式，并将其存储在目标数组的对应位置上。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function trans(values)&#123;</span><br><span class="line">	return Array.from(arguments,item=&gt;item+1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(trans(1,2,3)); //[2, 3, 4]</span><br></pre></td></tr></table></figure>

<p><strong>可迭代对象上使用</strong></p>
<p><code>Array.from()</code> 方法不仅可用于类数组对象，也可用于可迭代对象，也就是说可以将任意包含 <code>Symbol.iterator</code> 属性的对象转换成数组，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let obj = &#123;</span><br><span class="line">	*[Symbol.iterator]()&#123;</span><br><span class="line">		yield 1;</span><br><span class="line">		yield 2;</span><br><span class="line">		yield 3;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(Array.from(obj)); //[1, 2, 3]</span><br></pre></td></tr></table></figure>



<h3 id="find-和findIndex-方法"><a href="#find-和findIndex-方法" class="headerlink" title="find()和findIndex()方法"></a>find()和findIndex()方法</h3><p><code> indexOf()</code>和<code>lastIndexOf()</code>方法用于查找特定值在数组中的位置，而如果需要查找在数组中满足特定条件的元素就需要使用<code>find()</code>和<code>findIndex()</code>方法。</p>
<p><code>find()</code> 方法和 <code>findIndex()</code> 方法均接受两个参数：一个是回调函数、一个是可选的指定回调函数中的 <code>this</code> 值。回调函数中有三个参数：</p>
<ol>
<li>数组中的数据项元素；</li>
<li>元素在数组中的索引位置；</li>
<li>数组实例对象本身；</li>
</ol>
<p>回调函数与 <code>map()</code> 和 <code>forEach()</code> 等方法的回调函数中的参数一致。例如，需要找到在数组中大于5的元素：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = <span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">find</span>(<span class="function"><span class="params">item</span>=&gt;</span>item&gt;<span class="number">5</span>)); <span class="comment">//8</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span>=&gt;</span>item&gt;<span class="number">5</span>)); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p>可以看出，<code>find() </code>方法返回的是满足特定条件的数据项，而 <code>findIndex()</code> 方法返回的是满足特定条件的元素索引。</p>
<h3 id="fill-方法"><a href="#fill-方法" class="headerlink" title="fill()方法"></a>fill()方法</h3><p><code>fill() </code>方法能使用特定值填充数组中的一个或多个元素。当只使用一个参数的时候，该方法会用该参数的值填充整个数组。若你不想改变数组中的所有元素，而只想改变其中一部分，那么可以使用<strong>可选的起始位置参数与结束位置参数（不包括结束位置的那个元素）</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = <span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">fill</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>)); <span class="comment">//[1, 5, 1, 1]</span></span><br></pre></td></tr></table></figure>

<p>若只给定起始位置，不指定结束位置的话，默认结束位置为数组末尾。</p>
<h3 id="copyWithin-方法"><a href="#copyWithin-方法" class="headerlink" title="copyWithin()方法"></a>copyWithin()方法</h3><p><code>copyWithin()</code> 方法与 <code>fill()</code> 类似，可以一次性修改数组的多个元素。不过，与 <code>fill()</code> 使用单个值来填充数组不同， <code>copyWithin()</code> 方法允许你在数组内部复制自身元素。为此你需要传递两个参数给 <code>copyWithin()</code> 方法：从什么位置开始进行填充，以及被用来复制的数据的起始位置索引，以及可选的复制结束的位置（不包含该位置）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//copyWithin()</span></span><br><span class="line"><span class="keyword">let</span> arr = <span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">9</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">copyWithin</span>(<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>)); <span class="comment">//[1, 5, 1, 5]</span></span><br></pre></td></tr></table></figure>

<h3 id="案例-4"><a href="#案例-4" class="headerlink" title="案例"></a>案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let arr = Array.of(1,5,8,9);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr.find(item=&gt;item&gt;5)); //8</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr.findIndex(item=&gt;item&gt;5)); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//fill()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let arr = Array.of(1,5,8,9);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr.fill(1,2,4)); //[1, 5, 1, 1]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //copyWithin()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(arr.copyWithin(2,0,2)); //[1, 5, 1, 5]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let buffer = new ArrayBuffer(10);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(buffer.byteLength); //10</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let buf = buffer.slice(4,8);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(buf.byteLength); //4</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let buffer = new ArrayBuffer(2),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// view = new DataView(buffer);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// view.setInt8(0,1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(view.getInt8(0)); //1</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="title class_">Int8Array</span>(<span class="number">2</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">length</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		arr[<span class="number">3</span>] = <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">3</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h2 id="类型化数组"><a href="#类型化数组" class="headerlink" title="类型化数组"></a>类型化数组</h2><p>ES6 采纳了类型化数组，将其作为语言的一个正式部分，以确保在 JS 引擎之间有更好的兼容性，并确保与 JS 数组有更好的互操作性。</p>
<h3 id="数值数据类型"><a href="#数值数据类型" class="headerlink" title="数值数据类型"></a>数值数据类型</h3><p>JS 数值使用 IEEE 754 标准格式存储，使用 64 位来存储一个数值的浮点数表示形式，该格式在 JS 中被同时用来表示整数与浮点数；当值改变时，可能会频繁发生整数与浮点数之间的格式转换。而类型化数组则允许存储并操作八种不同的数值类型：</p>
<ol>
<li>8 位有符号整数（int8）</li>
<li>8 位无符号整数（uint8）</li>
<li>16 位有符号整数（int16）</li>
<li>16 位无符号整数（uint16）</li>
<li>32 位有符号整数（int32）</li>
<li>32 位无符号整数（uint32）</li>
<li>32 位浮点数（float32）</li>
<li>64 位浮点数（float64）</li>
</ol>
<p>所有与类型化数组相关的操作和对象都围绕着这八种数据类型。为了使用它们，要先创建一个数组缓冲区用于存储数据。</p>
<h3 id="数组缓冲区"><a href="#数组缓冲区" class="headerlink" title="数组缓冲区"></a>数组缓冲区</h3><p>数组缓冲区（array buffer） 是内存中包含一定数量字节的区域，而所有的类型化数组都基于数组缓冲区。创建数组缓冲区使用 ArrayBuffer 构造器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">10</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(buffer.<span class="property">byteLength</span>); <span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<p>调用 <code>ArrayBuffer</code> 构造器时，只需要传入单个数值用于指定缓冲区包含的字节数，而本例就创建了一个 10 字节的缓冲区。当数组缓冲区被创建完毕后，你就可以通过检查 <code>byteLength</code>属性来获取缓冲区的字节数。</p>
<p>还可以使用<code>slice()</code>方法来创建一个包含已有缓冲区部分内容的数组缓冲区，其中<code>slice()</code>方法可以使用起始位置和结束位置（不包含结束位置）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">let</span> buf = buffer.<span class="title function_">slice</span>(<span class="number">4</span>,<span class="number">8</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(buf.<span class="property">byteLength</span>); <span class="comment">//4</span></span><br></pre></td></tr></table></figure>

<p>仅仅创建一个数组缓冲器不能写入数据，是没有任何意义的。要想写入数据，需要创建视图（view）。</p>
<h3 id="使用视图操作数组缓冲区"><a href="#使用视图操作数组缓冲区" class="headerlink" title="使用视图操作数组缓冲区"></a>使用视图操作数组缓冲区</h3><p>数组缓冲区代表了一块内存区域，而视图（views） 则是你操作这块区域的接口。视图工作在数组缓冲区或其子集上，可以读写某种数值数据类型的数据。 DataView 类型是数组缓冲区的通用视图，允许你对前述所有八种数值数据类型进行操作。</p>
<p>创建视图，需要使用 DataView() 构造器，可以指定可选参数-字节偏移量以及所要包含的字节数。如果不指定所要包含的字节数，则默认为从字节偏移量直到数组缓冲区的末尾。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jslet buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">10</span>),</span><br><span class="line">view = <span class="keyword">new</span> <span class="title class_">DataView</span>(buffer, <span class="number">5</span>, <span class="number">2</span>);js</span><br></pre></td></tr></table></figure>

<p>此例中的 <code>view</code> 只能使用索引值为 5 与 6 的字节。使用这种方式，你可以在同一个数组缓冲区上创建多个不同的视图，这样有助于将单块内存区域供给整个应用使用，而不必每次在有需要时才动态分配内存。</p>
<blockquote>
<p>获取视图信息</p>
</blockquote>
<p>可以通过视图的可读属性来获取视图的信息：</p>
<ul>
<li>buffer ：该视图所绑定的数组缓冲区；</li>
<li>byteOffset ：传给 DataView 构造器的第二个参数，如果当时提供了的话（默认值为0）;</li>
<li>byteLength ：传给 DataView 构造器的第三个参数，如果当时提供了的话（默认值为该缓冲区的 byteLength 属性。</li>
</ul>
<blockquote>
<p>读取或写入数据</p>
</blockquote>
<p>对应于 JS 所有八种数值数据类型， <code>DataView</code> 视图的原型分别提供了在数组缓冲区上写入数据的一个方法、以及读取数据的一个方法。所有方法名都以“set”或“get”开始，其后跟随着对应数据类型的缩写。下面列出了能够操作 <code>int8</code> 或 <code>uint8</code> 类型的读取/写入方法：</p>
<ul>
<li>getInt8(byteOffset, littleEndian) ：从 byteOffset 处开始读取一个 int8 值；</li>
<li>setInt8(byteOffset, value, littleEndian) ：从 byteOffset 处开始写入一个 int8 值；</li>
<li>getUint8(byteOffset, littleEndian) ：从 byteOffset 处开始读取一个无符号 int8 值；</li>
<li>setUint8(byteOffset, value, littleEndian) ：从 byteOffset 处开始写入一个无符号int8 值。</li>
</ul>
<p>get”方法接受两个参数：开始进行读取的字节偏移量、以及一个可选的布尔值，后者用于指定读取的值是否采用低字节优先方式（注：默认值为 false ） 。“set”方法则接受三个参数：开始进行写入的字节偏移量、需要写入的数据值、以及一个可选的布尔值用于指定是否采用低字节优先方式存储数据。</p>
<p><strong>如果针对的是16位或者32位整数的话，只需要将上面的方法中的8，相应的改变成16或者32，就可以操作16位或者32值。</strong></p>
<p><strong>操作浮点数，提供了下面这些方法：</strong></p>
<ul>
<li>getFloat32(byteOffset, littleEndian) ：从 byteOffset 处开始读取一个 32 位的浮点数；</li>
<li>setFloat32(byteOffset, value, littleEndian) ：从 byteOffset 处开始写入一个 32 位的浮点数；</li>
<li>getFloat64(byteOffset, littleEndian) ：从 byteOffset 处开始读取一个 64 位的浮点数；</li>
<li>setFloat64(byteOffset, value, littleEndian) ：从 byteOffset 处开始写入一个 64 位的浮点数；</li>
</ul>
<p>例如使用上述这些视图上的方法来进行操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(<span class="number">2</span>),</span><br><span class="line">view = <span class="keyword">new</span> <span class="title class_">DataView</span>(buffer);</span><br><span class="line"></span><br><span class="line">view.<span class="title function_">setInt8</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(view.<span class="title function_">getInt8</span>(<span class="number">0</span>)); <span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<h3 id="类型化数组就是视图"><a href="#类型化数组就是视图" class="headerlink" title="类型化数组就是视图"></a>类型化数组就是视图</h3><p>ES6 的类型化数组实际上也是针对数组缓冲区的特定类型视图，你可以使用这些数组对象来处理特定的数据类型，而不必使用通用的 DataView 对象。一共存在八种特定类型视图，对应着八种数值数据类型。类型化数组的构造器有：Int8Array、Uint8Array、Uint8ClampedArray、Int16Array、Uint16Array、Int32Array、Uint32Array、Float32Array、Float64Array。</p>
<blockquote>
<p>创建特定类型视图</p>
</blockquote>
<p>创建特定类型视图有三种方式：</p>
<ol>
<li><p>第一种方式是使用与创建 DataView 时相同的参数，即：一个数组缓冲区、一个可选的字节偏移量、以及一个可选的字节数量；</p>
</li>
<li><p>第二种方式是传递单个数值给类型化数组的构造器，此数值表示该数组包含的元素数量（而不是分配的字节数） 。构造器将会创建一个新的缓冲区，分配正确的字节数以便容纳指定数量的数组元素，而你也可以使用 length 属性来获取这个元素数量；</p>
</li>
<li><p>第三种方式是向构造器传递单个对象参数，可以是下列四种对象之一：</p>
<ol>
<li>类型化数组：数组所有元素都会被复制到新的类型化数组中。例如，如果你传递一个 int8类型的数组给 Int16Array 构造器，这些 int8 的值会被复制到 int16 数组中。新的类型化数组与原先的类型化数组会使用不同的数组缓冲区。</li>
<li>可迭代对象：该对象的迭代器会被调用以便将数据插入到类型化数组中。如果其中包含了不匹配视图类型的值，那么构造器就会抛出错误。</li>
<li>数组：该数组的元素会被插入到新的类型化数组中。如果其中包含了不匹配视图类型的值，那么构造器就会抛出错误。</li>
<li>类数组对象：与传入数组的表现一致。</li>
</ol>
<p>//第一种方式<br>let buffer = new ArrayBuffer(10),<br>view1 = new Int8Array(buffer),<br>view2 = new Int8Array(buffer, 5, 2);</p>
<p>//第二种方式<br>let ints = new Int16Array(2),<br>floats = new Float32Array(5);</p>
<p>//第三种方式<br>let ints1 = new Int16Array([25, 50]),<br>ints2 = new Int32Array(ints1);</p>
</li>
</ol>
<h3 id="类型化数组与常规数组的相似点"><a href="#类型化数组与常规数组的相似点" class="headerlink" title="类型化数组与常规数组的相似点"></a>类型化数组与常规数组的相似点</h3><p>类型化数组在很多场景中都可以像常规数组那样被使用。例如，你可以使用 length 属性来获取类型化数组包含的元素数量，还可以使用数值类型的索引值来直接访问类型化数组的元素。它们二者具有的相似点：</p>
<blockquote>
<ol>
<li>公共方法</li>
</ol>
</blockquote>
<p>类型化数组拥有大量与常规数组等效的方法：</p>
<ul>
<li>copyWithin()</li>
<li>entries()</li>
<li>fill()</li>
<li>filter()</li>
<li>find()</li>
<li>findIndex()</li>
<li>forEach()</li>
<li>indexOf()</li>
<li>join()</li>
<li>keys()</li>
<li>lastIndexOf()</li>
<li>map()</li>
<li>reduce()</li>
<li>reduceRight()</li>
<li>reverse()</li>
<li>slice()</li>
<li>some()</li>
<li>sort()</li>
<li>values()</li>
</ul>
<blockquote>
<p>相同的迭代器</p>
</blockquote>
<p>与常规数组相同，类型化数组也拥有三个迭代器，它们是 <code>entries()</code> 方法、 <code>keys() </code>方法与<code>values()</code> 方法。这就意味着你可以对类型化数组使用扩展运算符，或者对其使用 <code>for-of</code> 循环，就像对待常规数组。</p>
<blockquote>
<p>of()和from()方法</p>
</blockquote>
<p>所有的类型化数组都包含静态的<code> of()</code> 与 <code>from()</code> 方法，作用类似于 <code>Array.of()</code> 与<code>Array.from()</code> 方法。其中的区别是类型化数组的版本会返回类型化数组，而不返回常规数组。</p>
<h3 id="类型化数组与常规数组的差异"><a href="#类型化数组与常规数组的差异" class="headerlink" title="类型化数组与常规数组的差异"></a>类型化数组与常规数组的差异</h3><p>二者最重要的区别就是类型化数组并不是常规数组，类型化数组并不是从 Array 对象派生的，使用 <code>Array.isArray()</code> 去检测会返回 <code>false</code> 。</p>
<blockquote>
<p>行为差异</p>
</blockquote>
<p>常规数组可以被伸展或是收缩，然而类型化数组却会<strong>始终保持自身大小不变</strong>。你可以对常规数组一个不存在的索引位置进行赋值，但在类型化数组上这么做则会被忽略。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="title class_">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints.<span class="property">length</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints[<span class="number">1</span>]); <span class="comment">// 50</span></span><br><span class="line">ints[<span class="number">2</span>] = <span class="number">5</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints.<span class="property">length</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints[<span class="number">2</span>]); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>在本例中，尽管对索引值 2 的位置进行了赋值为 5 的操作，但 ints 数组却完全没有被伸展，数组的长度属性保持不变，所赋的值也被丢弃了。</p>
<p><strong>类型化数组也会对数据类型进行检查以保证只使用有效的值，当无效的值被传入时，将会被替换为 0</strong> 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="title class_">Int16Array</span>([<span class="string">&quot;hi&quot;</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints.<span class="property">length</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints[<span class="number">0</span>]); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

<p>这段代码试图用字符串值 “hi” 创建一个 Int16Array ，而字符串对于类型化数组来说当然是无效的值，因此该字符串被替换为 0 并插入数组。此数组的长度仅仅是 1 ，而 ints[0]只包含了 0 这个值。</p>
<p><strong>所有在类型化数组上修改项目值的方法都会受到相同的限制，例如当 map() 方法使用的映射函数返回一个无效值的时候，类型化数组会使用 0 来代替返回值</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="title class_">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]),</span><br><span class="line">mapped = ints.<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="string">&quot;hi&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapped.<span class="property">length</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapped[<span class="number">0</span>]); <span class="comment">// 0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapped[<span class="number">1</span>]); <span class="comment">// 0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapped <span class="keyword">instanceof</span> <span class="title class_">Int16Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapped <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>由于字符串值 “hi” 并不是一个 16 位整数，它在结果数组中就被替换成为 0 。</p>
<blockquote>
<p>遗漏的方法</p>
</blockquote>
<p>尽管类型化数组拥有常规数组的很多同名方法，但仍然缺少了几个数组方法，包括下列这些：</p>
<ul>
<li>concat()</li>
<li>pop()</li>
<li>push()</li>
<li>shift()</li>
<li>splice()</li>
<li>unshift()</li>
</ul>
<blockquote>
<p>附加的方法</p>
</blockquote>
<p>类型化数组还有两个常规数组所不具备的方法： <code>set()</code> 方法与 <code>subarray()</code> 方法。这两个方法作用相反： <code>set()</code> 方法从另一个数组中复制元素到当前的类型化数组，而 <code>subarray()</code> 方法则是将当前类型化数组的一部分提取为新的类型化数组。</p>
<p>**set() 方法接受一个数组参数（无论是类型化的还是常规的） 、以及一个可选的偏移量参数，后者指示了从什么位置开始插入数据（默认值为 0 ） **。数组参数中的数据会被复制到目标类型化数组中，并会确保数据值有效。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="title class_">Int16Array</span>(<span class="number">4</span>);</span><br><span class="line">ints.<span class="title function_">set</span>([<span class="number">25</span>, <span class="number">50</span>]);</span><br><span class="line">ints.<span class="title function_">set</span>([<span class="number">75</span>, <span class="number">100</span>], <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ints.<span class="title function_">toString</span>()); <span class="comment">// 25,50,75,100</span></span><br></pre></td></tr></table></figure>

<p>这段代码创建了一个包含四个元素的 <code>Int16Array</code> ；第一次调用 <code>set()</code> 复制了两个值到数组起始的两个位置；而第二次调用<code> set()</code> 则使用了一个值为 2 的偏移量参数，指明应当从数组的第三个位置（索引 2 ） 开始放置所复制的数据。</p>
<p><code>subarray()</code> 方法接受一个可选的开始位置索引参数、以及一个可选的结束位置索引参数（像<code>slice()</code> 方法一样，结束位置的元素不会被包含在结果中） ，并会返回一个新的类型化数组。你可以同时省略这两个参数，从而创建原类型化数组的一个复制品。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="title class_">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">100</span>]),</span><br><span class="line">subints1 = ints.<span class="title function_">subarray</span>(),</span><br><span class="line">subints2 = ints.<span class="title function_">subarray</span>(<span class="number">2</span>),</span><br><span class="line">subints3 = ints.<span class="title function_">subarray</span>(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(subints1.<span class="title function_">toString</span>()); <span class="comment">// 25,50,75,100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(subints2.<span class="title function_">toString</span>()); <span class="comment">// 75,100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(subints3.<span class="title function_">toString</span>()); <span class="comment">// 50,75</span></span><br></pre></td></tr></table></figure>

<p>本例中利用 <code>ints</code> 数组创建了三个类型化数组。 <code>subints1</code> 数组是 <code>ints</code> 的一个复制品，包含了原数组的所有信息；而 <code>subints2</code> 则从原数组的索引 2 位置开始复制，因此包含了原数组的最末两个元素（即 75 与 100 ） ；最后的 <code>subints3</code> 数组值包含了原数组的中间两个元素，因为调用 <code>subarray()</code> 时同时使用了起始位置与结束位置参数。</p>
<h3 id="总结-7"><a href="#总结-7" class="headerlink" title="总结"></a>总结</h3><ol>
<li>ES6 延续了 ES5 的工作以便让数组更加有用。新增了两种创建数组的方式： Array.of() 方法、以及 Array.from() 方法，其中后者可以将可迭代对象或类数组对象转换为正规数组；</li>
<li>fill() 方法与 copyWithin() 方法允许你替换数组内的元素。 find() 方法与 findIndex() 方法在数组中查找满足特定条件的元素时会非常有用，其中前者会返回满足条件的第一个元素，而后者会返回该元素的索引位置；</li>
<li>类型化数组并不是严格的数组，它们并没有继承 Array 对象，但它们的外观和行为都与数组有许多相似点。类型化数组包含的数据类型是八种数值数据类型之一，基于数组缓冲区对象建立，用于表示按位存储的一个数值或一系列数值。类型化数组能够明显提升按位运算的性能，因为它不像 JS 的常规数值类型那样需要频繁进行格式转换。</li>
</ol>
<h2 id="Promise基础"><a href="#Promise基础" class="headerlink" title="Promise基础"></a>Promise基础</h2><blockquote>
<p>什么是回调地狱？</p>
</blockquote>
<p>当使用回调函数来进行事件处理的时候，如果嵌套多层回调函数的时候，就会出现回调地狱，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">method1</span>(<span class="keyword">function</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="keyword">throw</span> err;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="title function_">method2</span>(<span class="keyword">function</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (err) &#123;</span><br><span class="line">			<span class="keyword">throw</span> err;</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="title function_">method3</span>(<span class="keyword">function</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (err) &#123;</span><br><span class="line">				<span class="keyword">throw</span> err;</span><br><span class="line">			&#125; </span><br><span class="line">			<span class="title function_">method4</span>(<span class="keyword">function</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (err) &#123;</span><br><span class="line">					<span class="keyword">throw</span> err;</span><br><span class="line">				&#125; </span><br><span class="line">				<span class="title function_">method5</span>(result);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>像本例一样嵌套多个方法调用会创建错综复杂的代码，会难以理解与调试。当想要实现更复<br>杂的功能时，回调函数也会存在问题。要是你想让两个异步操作并行运行，并且在它们都结<br>束后提醒你，那该怎么做？要是你想同时启动两个异步操作，但只采用首个结束的结果，那<br>又该怎么做？而使用Promise就能避免回调地狱的情况。</p>
<p>Promise可以当做是一个占位符，表示异步操作的执行结果。函数可以返回一个Promise，而不必订阅一个事件或者向函数传递一个回调函数。</p>
<blockquote>
<p>Promise的生命周期</p>
</blockquote>
<p>每个 Promise 都会经历一个短暂的生命周期，初始为挂起状态（pending state） ，这表示异步操作尚未结束。一个挂起的 Promise 也被认为是未决的（unsettled )。一旦异步操作结束， Promise就会被认为是已决的（settled ） ，并进入两种可能状态之一：</p>
<ol>
<li><strong>已完成（fulfilled ）</strong> ： Promise 的异步操作已成功结束；</li>
<li><strong>已拒绝（rejected ）</strong> ： Promise 的异步操作未成功结束，可能是一个错误，或由其他原因导致。</li>
</ol>
<p>内部的<code> [[PromiseState]]</code> 属性会被设置为<code> &quot;pending&quot;</code> 、 <code>&quot;fulfilled&quot;</code> 或 “rejected”<code>，以反映</code>Promise<code> 的状态。该属性并未在 Promise 对象上被暴露出来，</code>因此你无法以编程方式判断 <code>Promise</code> 到底处于哪种状态。不过你可以使用<code>then()</code>方法在 Promise 的状态改变时执行一些特定操作。</p>
<ol>
<li><p><strong>then()方法</strong></p>
<p><code>then() </code>方法在所有的 Promise 上都存在，并且接受两个参数。第一个参数是 Promise 被完成时要调用的函数，异步操作的结果数据都会被传入这个完成函数。第二个参数则是 Promise 被拒绝时要调用的函数，与完成函数相似，拒绝函数会被传入与拒绝相关联的任何附加数据。then()方法的两个参数是可选的，因此可以自由组合监听完成和失败的处理函数；</p>
</li>
<li><p><strong>catch()方法</strong></p>
<p>Promise有catch()方法，等同于只传递拒绝处理函数给then()方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">promise.catch(function(err) &#123;</span><br><span class="line">	// 拒绝</span><br><span class="line">	console.error(err.message);</span><br><span class="line">&#125;);</span><br><span class="line">// 等同于：</span><br><span class="line">promise.then(null, function(err) &#123;</span><br><span class="line">	// 拒绝</span><br><span class="line">	console.error(err.message);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>创建未决的Promise</p>
</blockquote>
<p>使用Promise构造器可以创建一个Promise实例，此构造器接收一个参数：一个被称之为执行器（excutor）的函数，该函数包含了<code>resolve()</code>函数和<code>reject()</code>函数这两个参数。<code>resolve()</code>函数在异步任务执行成功时调用，而<code>reject()</code>函数在异步任务执行失败时调用。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">let promise = new Promise(function(resolve,reject)&#123;</span><br><span class="line">	console.log(&#x27;hi, promise&#x27;);</span><br><span class="line">	resolve();</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.then(()=&gt;&#123;</span><br><span class="line">	console.log(&#x27;hi, then&#x27;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&#x27;hi&#x27;);</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">hi, promise</span><br><span class="line">hi</span><br><span class="line">hi then</span><br></pre></td></tr></table></figure>

<p>从输出结果可以看出，Promise构造器中的代码是最先执行的，而<code>then()</code>代码是最后执行的，这是因为只有在Promise中的处理器函数执行结束之后，then()方法中的完成处理函数或者拒绝处理函数才会添加到作业队列的尾部。</p>
<blockquote>
<p>创建已决的Promise</p>
</blockquote>
<ol>
<li>使用<code>Promise.resolve()</code></li>
</ol>
<p><code>Promise.resolve()</code>方法接收一个参数，并会返回一个处于已完成状态的 <code>Promise</code> ，在<code>then()</code>方法中使用完成处理函数才能提取该完成态的<code>Promise</code>传递的值，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let promise = Promise.resolve(&#x27;hi&#x27;);</span><br><span class="line">promise.then((value)=&gt;&#123;</span><br><span class="line">	console.log(value); //hi</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用Promise.reject()</li>
</ol>
<p>可以使用<code>Promise.reject()</code>方法来创建一个已拒绝状态的<code>Promise</code>，同样只有在拒绝处理函数中或者<code>catch()</code>方法中才能接受<code>reject()</code>方法传递的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let reject = Promise.reject(&#x27;reject&#x27;);</span><br><span class="line"></span><br><span class="line">reject.catch((value)=&gt;&#123;</span><br><span class="line">	console.log(value); //reject</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>非Promise的thenable</p>
</blockquote>
<p>当一个对象拥有一个能接受<code>resolve</code>与<code>reject</code>参数的<code>then()</code>方法时，该对象就会被认为是一个非<code>Promise</code>的<code>thenable</code>，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let thenable = &#123;</span><br><span class="line"></span><br><span class="line">	then:function(resolve,reject)&#123;</span><br><span class="line">		resolve(&#x27;hi&#x27;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Promise.resolve()</code>与<code>Promise.reject()</code>方法都能够接受非Promise的thenable作为参数，当传入了非Promise的thenable时，这些方法会创建一个新的Promise，并且可以使用then()方法对不同状态进行操作：</p>
<p>创建一个已完成的Promise</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let thenable = &#123;</span><br><span class="line"></span><br><span class="line">	then:function(resolve,reject)&#123;</span><br><span class="line">		resolve(&#x27;hi&#x27;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let promise = Promise.resolve(thenable);</span><br><span class="line">promise.then((value)=&gt;&#123;</span><br><span class="line">	console.log(value); //hi</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>同样利用thenable可以创建一个已拒绝的Promise:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let thenable = &#123;</span><br><span class="line"></span><br><span class="line">	then:function(resolve,reject)&#123;</span><br><span class="line">		reject(&#x27;hi&#x27;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let promise = Promise.resolve(thenable);</span><br><span class="line">promise.then(null,(value)=&gt;&#123;</span><br><span class="line">	console.log(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>执行器错误</p>
</blockquote>
<p>当执行器内部抛出错误，那么Promise的拒绝处理函数就会被调用，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">let promise = new Promise(function(resolve,reject)&#123;</span><br><span class="line">	throw new Error(&#x27;Error!&#x27;);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.catch(function(msg)&#123;</span><br><span class="line">	console.log(msg); //error</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Promise链"><a href="#Promise链" class="headerlink" title="Promise链"></a>Promise链</h3><p>除了使用单个Promise外，多个Promise可以进行级联使用，实际上<code>then()</code>方法或者<code>catch()</code>方法会返回一个新的Promise，仅当前一个Promise被决议之后，后一个Promise才会进行处理。</p>
<blockquote>
<p>串联Promise</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="string">&#x27;hi&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Error!&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>可以看出当p1的<code>then()</code>方法执行结束后会返回一个Promise，因此，在此基础上可以继续执行<code>catch()</code>方法。同时，<strong>Promise链允许捕获前一个Promise的错误</strong>。</p>
<blockquote>
<p>Promise链中传递值</p>
</blockquote>
<p><strong>Promise链的另一个重要方面是能从一个Promise传递数据给另一个Promise的能力。</strong>前一个Promise的完成处理函数的返回值，传递到下一个Promise中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Promise链传递值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>value+<span class="number">1</span>)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>p1的完成处理函数返回了<code>value+1</code>，也就是<code>2</code>，会传入到下一个Promise的完成处理函数，因此，第二个<code>then()</code>方法中的完成处理函数就会输出<code>2</code>。拒绝处理函数同样可以被用于在Promise链中传递数据。</p>
<blockquote>
<p>Promise链中传递Promise</p>
</blockquote>
<p>在完成或者拒绝处理函数中可以返回基本类型值，从而可以在Promise链中传递。另外，在Promise链中也可以传递对象，如果传递的是Promise对象，就需要额外的处理：</p>
<p><strong>传递已完成状态的Promise</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">	<span class="keyword">return</span> p2;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br><span class="line">输出：<span class="number">1</span>  <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>p1中返回了Promise对象<code>p2</code>，当<code>p2</code>完成时，才会调用第二个<code>then()</code>方法，将值<code>value</code>传到完成处理函数中。若<code>Promise</code>对象<code>p2</code>被拒绝后，第二个<code>then()</code>方法中的完成处理函数就不会执行，只能通过拒绝处理函数才能接收到p2传递的值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">reject</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">	<span class="keyword">return</span> p2;</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="响应多个Promise"><a href="#响应多个Promise" class="headerlink" title="响应多个Promise"></a>响应多个Promise</h3><p>如果想监视多个Promise的状态，从而决定下一步动作，可以使用ES6提供的两个方法：<code>Promise.all()</code>和<code>Promise.race()</code>；</p>
<blockquote>
<p>Promise.all()</p>
</blockquote>
<p>Promise.all()方法能接受单个可迭代对象（如数组）作为参数，可迭代对象的元素都是Promise。该方法会返回一个Promise，只有传入所有的Promise都已完成，所返回的Promise才会完成，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">js<span class="comment">//Promise.all()</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">3</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="title class_">Promise</span>.<span class="title function_">all</span>([p1,p2,p3]);</span><br><span class="line">p4.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)); <span class="comment">//true</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//[1,2,3]</span></span><br><span class="line">&#125;)js</span><br></pre></td></tr></table></figure>

<p>对 <code>Promise.all()</code> 的调用创建了新的<code>Promise p4 </code>，在 <code>p1</code> 、 <code>p2</code> 与 <code>p3</code> 都被完成后， <code>p4</code> 最终会也被完成。传递给 <code>p4</code> 的完成处理函数的结果是一个包含每个决议值（1 、 2 与 3 ） 的数组，这些值的存储顺序保持了待决议的 <code>Promise</code> 的顺序（与完成的先后顺序无关） ，因此你可以将结果匹配到每个<code>Promise</code>。</p>
<p><strong>若传递给<code> Promise.all()</code> 的某个 Promise 被拒绝了，那么方法所返回的 Promise 就会立刻被拒绝，而不必等待其他的 Promise 结束</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Promise.all()</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">reject</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">3</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="title class_">Promise</span>.<span class="title function_">all</span>([p1,p2,p3]);</span><br><span class="line">p4.<span class="title function_">catch</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)); <span class="comment">//true</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//2</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在此例中， p2 被使用数值 2 进行了拒绝，则 p4 的拒绝处理函数就立刻被调用，而不会<br>等待 p1 或 p3 结束执行（它们仍然会各自结束执行，只是 p4 不等它们） 。</p>
<p><strong>拒绝处理函数总会接受到单个值，而不是一个数组。该值是被拒绝的Promise所返回的拒绝值。</strong></p>
<blockquote>
<p>Promise.race()</p>
</blockquote>
<p><code>Promise.race()</code>方法接收一个元素是Promise的可迭代对象，并返回一个新的Promise。一旦传入<code>Promise.race()</code>的可迭代对象中有一个Promise是已决状态，那么返回的Promise对象就会立刻成为已决状态。</p>
<p>而<code>Promise.all()</code>方法得必须等到所有传入的Promise全部变为已决状态，所返回的Promise才会已决。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve,reject</span>)&#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">3</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="title class_">Promise</span>.<span class="title function_">race</span>([p1,p2,p3]);</span><br><span class="line">p4.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)); <span class="comment">//false</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">//1</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Promise.race() 方法传入的Promise中哪一个Promise先变成已完成状态，就会将值传递给所返回的Promise对象的完成处理函数中。若哪一个Promise最先变成已拒绝状态，同样的，会将值传递给<code>p4</code>的拒绝处理函数中。</p>
<h3 id="继承Promise"><a href="#继承Promise" class="headerlink" title="继承Promise"></a>继承Promise</h3><p>可以继承Promise实现自定义的Promise，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyPromise</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Promise</span> &#123;</span><br><span class="line">	<span class="comment">// 使用默认构造器</span></span><br><span class="line">	<span class="title function_">success</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(resolve, reject);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="title function_">failure</span>(<span class="params">reject</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">catch</span>(reject);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">	<span class="title function_">resolve</span>(<span class="number">42</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">success</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// 42</span></span><br><span class="line">&#125;).<span class="title function_">failure</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在此例中， MyPromise 从 Promise 上派生出来，并拥有两个附加方法。 <code>success()</code> 方法模拟了 <code>resolve()</code> ， <code>failure()</code> 方法则模拟了 <code>reject()</code> 。</p>
<h3 id="总结-8"><a href="#总结-8" class="headerlink" title="总结"></a>总结</h3><ol>
<li>Promise 具有三种状态：挂起、已完成、已拒绝。一个 <code>Promise</code> 起始于挂起态，并在成功时转为完成态，或在失败时转为拒绝态。 <code>then()</code> 方法允许你绑定完成处理函数与拒绝处理函数，而 <code>catch()</code> 方法则只允许你绑定拒绝处理函数；</li>
<li>能够将多个Promise串联起来组成Promise链，并且能够在中间传递值，甚至是传递Promise对象。 then() 的调用都创建并返回了一个新的 Promise ，只有在前一个 Promise 被决议过，新 Promise 也会被决议。 同时也可以使用Promise.all()和Promise.race()方法来管理多个Promise。</li>
</ol>
<h3 id="案例-5"><a href="#案例-5" class="headerlink" title="案例"></a>案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//创建未决的Promise</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let promise = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(&#x27;hi, promise&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// promise.then(()=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(&#x27;hi, then&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(&#x27;hi&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//创建已决的Promise</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let promise = Promise.resolve(&#x27;hi&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// promise.then((value)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let reject = Promise.reject(&#x27;reject&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// reject.catch((value)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//非Promise的thenable</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let thenable = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	then:function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		reject(&#x27;hi&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let promise = Promise.resolve(thenable);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// promise.then(null,(value)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//执行器错误</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let promise = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	throw new Error(&#x27;Error!&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// promise.catch(function(msg)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(msg);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//串联Promise</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p1 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(&#x27;hi&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// p1.then((value)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	throw new Error(&#x27;Error!&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;).catch(function(error)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(error);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //Promise链传递值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p1 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// p1.then(value=&gt;value+1)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// .then(value=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//Promise链中传递Promise对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p1 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p2 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	reject(2);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// p1.then(value=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return p2;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;).catch(value=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //Promise.all()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p1 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p2 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	reject(2);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p3 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(3);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p4 = Promise.all([p1,p2,p3]);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// p4.catch(value=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(Array.isArray(value)); //true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value); //2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//Promise.race()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p1 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(1);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p2 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(2);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p3 = new Promise(function(resolve,reject)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	resolve(3);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let p4 = Promise.race([p1,p2,p3]);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// p4.then(value=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(Array.isArray(value)); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	console.log(value); //1</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//继承Promise</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">class</span> <span class="title class_">MyPromise</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Promise</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 使用默认构造器</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="title function_">success</span>(<span class="params">resolve, reject</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(resolve, reject);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125; </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="title function_">failure</span>(<span class="params">reject</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">catch</span>(reject);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125; </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="title function_">resolve</span>(<span class="number">42</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		promise.<span class="title function_">success</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// 42</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;).<span class="title function_">failure</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h2 id="代理和反射"><a href="#代理和反射" class="headerlink" title="代理和反射"></a>代理和反射</h2><blockquote>
<p>代理是什么？</p>
</blockquote>
<p>通过调用 <code>new Proxy()</code> ，你可以创建一个代理用来替代另一个对象（被称之为目目标对象） ，这个代理对目标对象进行了虚拟，因此该代理与该目标对象表面上可以被当作同一个对象来对待。</p>
<p>代理允许你拦截目标对象上的底层操作，而这本来是JS引擎的内部能力，拦截行为适用了一个能响应特定操作的函数（被称之为陷阱）；</p>
<blockquote>
<p>反射是什么？</p>
</blockquote>
<p>被<code>Reflect</code>对象所代表的反射接口，<strong>是给底层操作提供默认行为的方法的集合，这些操作是能够被代理重写的</strong>。每个代理陷阱都有一个对应的反射方法，每个方法都与对应的陷阱函数同名，并且接收的参数也与之一致。</p>
<blockquote>
<p>创建一个简单的代理</p>
</blockquote>
<p>使用Proxy构建可以创建一个简单的代理对象，需要传递两个参数：<strong>目标对象以及一个处理器，后者是定义一个或多个陷阱函数的对象</strong>。如果不定义陷阱函数，则依然使用目标对象的默认行为。</p>
<h3 id="常用陷阱函数"><a href="#常用陷阱函数" class="headerlink" title="常用陷阱函数"></a>常用陷阱函数</h3><h3 id="基本陷阱函数"><a href="#基本陷阱函数" class="headerlink" title="基本陷阱函数"></a>基本陷阱函数</h3><p><strong>1.使用Set陷阱函数验证属性值</strong></p>
<p>假如有这样一个场景，必须要求对象的属性值必须只能是数值，这就意味着该对象每个新增属性时都要被验证，并且在属性不为数值属性时就应该抛出错误。因此就需要使用<code>set</code>陷阱函数来重写<code>set</code>函数的默认行为，<code>set</code>陷阱函数接收四个参数：</p>
<ol>
<li>trapTarget：代理的目标对象；</li>
<li>key：需要写入的属性的键；</li>
<li>value：被写入属性的值；</li>
<li>receiver：操作发生的对象（通常是代理对象）</li>
</ol>
<p><code>Reflect.set()</code>是<code>set</code>陷阱函数对应的反射方法，同时也是<code>set</code>操作的默认行为，<code>Reflect.set()</code>方法与<code>set</code>陷阱函数一样，能够接受四个参数。</p>
<p>针对上述场景，示例代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//set陷阱函数</span><br><span class="line">let target = &#123;</span><br><span class="line">	name:&#x27;target&#x27;</span><br><span class="line">&#125;</span><br><span class="line">let proxy = new Proxy(target,&#123;</span><br><span class="line">	set(tarpTarget,key,value,receiver)&#123;</span><br><span class="line"></span><br><span class="line">		if(!tarpTarget.hasOwnProperty(key))&#123;</span><br><span class="line">			if(isNaN(value))&#123;</span><br><span class="line">				throw new Error(&#x27;property must be number&#x27;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return Reflect.set(tarpTarget,key,value,receiver);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">proxy.msg=&#x27;hello proxy&#x27;; //Uncaught Error: property must be number</span><br></pre></td></tr></table></figure>

<p>通过set陷阱函数就可以检测设置属性时属性值的类型，当属性值不是数字时，就会抛出错误。</p>
<p><strong>2.使用get陷阱函数进行对象外形验证</strong></p>
<p><strong>对象外形（Object Shape）指的是对象已有的属性与方法的集合。</strong>能够使用代理很方便进行对象外形验证。由于使用属性验证只需要在读取属性时被触发，因此只需要使用<code>get陷阱函数</code>。该函数接受三个参数：</p>
<ol>
<li>trapTarget：代理的目标对象；</li>
<li>key：需要读取的属性的键；</li>
<li>receiver：操作发生的对象（通常是代理对象）；</li>
</ol>
<p>相应的<code>Reflect.get()</code>方法同样拥有这三个参数。进行对象外形验证的示例代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//get陷阱函数</span><br><span class="line"></span><br><span class="line">let target=&#123;</span><br><span class="line">	name:&#x27;hello world&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let proxy = new Proxy(target,&#123;</span><br><span class="line">		get(tarpTarget,key,receiver)&#123;</span><br><span class="line">			if(!(key in tarpTarget))&#123;</span><br><span class="line">				throw new Error(&#x27;不存在该对象&#x27;);</span><br><span class="line">			&#125;</span><br><span class="line">			return Reflect.get(tarpTarget,key,receiver);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">console.log(proxy.name); //hello world</span><br><span class="line">console.log(proxy.age); // Uncaught Error: 不存在该对象</span><br></pre></td></tr></table></figure>

<p>使用<code>get陷阱函数</code>进行对象外形验证，由于<code>target</code>对象存在<code>name</code>属性，所以可以正常返回，当获取<code>age</code>属性时，由于该属性并不存在，所以会抛出错误。</p>
<p><strong>3.使用has陷阱函数隐藏属性</strong></p>
<p><code>in </code>运算符用于判断指定对象中是否存在某个属性，如果对象的属性名与指定的字符串或符号值相匹配，那么<code>in</code>运算符就会返回<code>true</code>。无论该属性是对象自身的属性还是其原型的属性。</p>
<p><code>has陷阱函数</code>会在使用<code>in</code>运算符的情况下被调用，控制in运算符返回不同的结果，<code>has陷阱函数</code>会传入两个参数：</p>
<ol>
<li>trapTarget：代理的目标对象；</li>
<li>key：属性键；</li>
</ol>
<p><code>Reflect.has()</code>方法接收相同的参数，并向<code>in</code>运算符返回默认的响应结果，用于返回默认响应结果。</p>
<p>例如想要隐藏value属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//has陷阱函数</span><br><span class="line">let target = &#123;</span><br><span class="line">	value:&#x27;hello world&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let proxy = new Proxy(target,&#123;</span><br><span class="line">	has(tarpTarget,key)&#123;</span><br><span class="line">		if(Object.is(key,&#x27;value&#x27;))&#123;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">		Reflect.has(tarpTarget,key);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">console.log(&#x27;value&#x27; in proxy); //false</span><br></pre></td></tr></table></figure>

<p>使用<code>has陷阱函数</code>，能够控制<code>in</code>运算符的结果，<code>value</code>属性在<code>target对象</code>中存在，通过代理的<code>has陷阱函数</code>使得在检查<code>value</code>属性时返回<code>false</code>，达到隐藏属性的效果。</p>
<p><strong>4.使用deleteProperty陷阱函数避免属性被删除</strong></p>
<p><code>deleteProperty</code> 陷阱函数会在使用<code>delete</code> 运算符删除对象属性时被调用，该方法接收两个参数：</p>
<ol>
<li>trapTarget：代理的目标对象；</li>
<li>key：需要删除的键；</li>
</ol>
<p><code>Reflect.deleteProperty()</code> 方法也接受这两个参数，并提供了 <code>deleteProperty</code> 陷阱函数的默认实现。你可以结合 <code>Reflect.deleteProperty() </code>方法以及 <code>deleteProperty</code> 陷阱函数，来修改 <code>delete</code> 运算符的行为。例如，能确保 value 属性不被删除：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">let target = &#123;</span><br><span class="line">	name: &quot;target&quot;,</span><br><span class="line">	value: 42</span><br><span class="line">&#125;;</span><br><span class="line">let proxy = new Proxy(target, &#123;</span><br><span class="line">	deleteProperty(trapTarget, key) &#123;</span><br><span class="line">		if (key === &quot;value&quot;) &#123;</span><br><span class="line">			return false;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return Reflect.deleteProperty(trapTarget, key);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 尝试删除 proxy.value</span><br><span class="line">console.log(&quot;value&quot; in proxy); // true</span><br><span class="line">let result1 = delete proxy.value;</span><br><span class="line">console.log(result1); // false</span><br></pre></td></tr></table></figure>

<h3 id="原型代理上的陷阱函数"><a href="#原型代理上的陷阱函数" class="headerlink" title="原型代理上的陷阱函数"></a>原型代理上的陷阱函数</h3><p>在调用Object.setPrototypeOf()和getPrototypeOf()方法时，可以使用<code>setPrototypeOf</code>和<code>getPrototypeOf</code>陷阱函数来影响Object上相应的两个方法的效果。setPrototypeOf陷阱函数接收两个参数：</p>
<ol>
<li>trapTarget：代理的目标对象；</li>
<li>proto：需要被用作原型的对象；</li>
</ol>
<p><code>setPrototypeOf()</code>方法与<code>Reflect.setPrototypeOf()</code>传入相同的参数。另外，getPrototypeOf陷阱函数只接收<code>trapTarget</code>参数，<code>Reflect.getPrototype</code>也只接收一个参数。</p>
<p>例如，通过返回 null 隐藏了代理对象的原型，并且使得该原型不可被修改：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//原型代理上的陷阱函数</span><br><span class="line"></span><br><span class="line">let target = &#123;&#125;;</span><br><span class="line">let proxy = new Proxy(target, &#123;</span><br><span class="line">	getPrototypeOf(trapTarget) &#123;</span><br><span class="line">		return null;</span><br><span class="line">	&#125;,</span><br><span class="line">	setPrototypeOf(trapTarget, proto) &#123;</span><br><span class="line">		return false;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">let targetProto = Object.getPrototypeOf(target);</span><br><span class="line">let proxyProto = Object.getPrototypeOf(proxy);</span><br><span class="line">console.log(targetProto === Object.prototype); // true</span><br><span class="line">console.log(proxyProto === Object.prototype); // false</span><br><span class="line">console.log(proxyProto); // null</span><br><span class="line">// 成功</span><br><span class="line">Object.setPrototypeOf(target, &#123;&#125;);</span><br><span class="line">// 抛出错误</span><br><span class="line">Object.setPrototypeOf(proxy, &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>使用 <code>target</code> 对象作为参数调用<code>Object.getPrototypeOf()</code> 会返回一个对象值；而使用 proxy 对象调用该方法则会返回<code>null</code> ，因为 <code>getPrototypeOf</code> 陷阱函数被调用了。类似的，使用 target 去调用<code>Object.setPrototypeOf()</code> 会成功；而由于 <code>setPrototypeOf</code> 陷阱函数的存在，使用 <code>proxy</code>则会引发错误。</p>
<p>2.3 对象可扩展性的陷阱函数</p>
<p>ES5 通过<code> Object.preventExtensions()</code> 与 <code>Object.isExtensible()</code> 方法给对象增加了可扩展性。而 ES6 则通过 <code>preventExtensions</code> 与 <code>isExtensible</code> 陷阱函数允许代理拦截对于底层对象的方法调用。这两个陷阱函数都接受名为 <code>trapTarget</code> 的单个参数，此参数代表代理的目标对象。 <code>isExtensible</code> 陷阱函数必须返回一个布尔值用于表明目标对象是否可被扩展，而 <code>preventExtensions</code> 陷阱函数也需要返回一个布尔值，用于表明操作是否已成功。同时也存在<code>Reflect.preventExtensions()</code> 与<code> Reflect.isExtensible()</code> 方法，用于实现默认的行为。这两个方法都返回布尔值，因此它们可以在对应的陷阱函数内直接使用。</p>
<p>例如，不想让代理对象的<code>Object.preventExtensios()</code>操作成功，可以强制<code>preventExtensions</code>陷阱函数返回<code>false</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//对象可扩展性的陷阱函数</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let target = &#123;&#125;;</span><br><span class="line">let proxy = new Proxy(target, &#123;</span><br><span class="line">	isExtensible(trapTarget) &#123;</span><br><span class="line">	return Reflect.isExtensible(trapTarget);</span><br><span class="line">	&#125;,</span><br><span class="line">	preventExtensions(trapTarget) &#123;</span><br><span class="line">	return false</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">console.log(Object.isExtensible(target)); // true</span><br><span class="line">console.log(Object.isExtensible(proxy)); // true</span><br><span class="line">Object.preventExtensions(proxy);</span><br><span class="line">console.log(Object.isExtensible(target)); // true</span><br><span class="line">console.log(Object.isExtensible(proxy)); // true</span><br></pre></td></tr></table></figure>

<h3 id="属性描述符的陷阱函数"><a href="#属性描述符的陷阱函数" class="headerlink" title="属性描述符的陷阱函数"></a>属性描述符的陷阱函数</h3><p>ES5 最重要的特征之一就是引入了<code>Object.defineProperty()</code>方法用于定义属性的特性。在JS 之前的版本中，没有方法可以定义一个访问器属性，也不能让属性变成只读或是不可枚举。而这些特性都能够利用 <code>Object.defineProperty() </code>方法来实现，并且你还可以利用<code>Object.getOwnPropertyDescriptor() </code>方法来检索这些特性。代理允许你使用 <code>defineProperty</code> 与 <code>getOwnPropertyDescriptor</code> 陷阱函数，来分别拦截对于<code>Object.defineProperty()</code> 与 <code>Object.getOwnPropertyDescriptor()</code> 的调用。 <code>defineProperty</code><br>陷阱函数接受下列三个参数：</p>
<ol>
<li>trapTarget ：需要被定义属性的对象（即代理的目标对象） ；</li>
<li>key ：属性的键（字符串类型或符号类型） ；</li>
<li>descriptor ：为该属性准备的描述符对象。</li>
</ol>
<p><code>defineProperty</code> 陷阱函数要求你在操作成功时返回 <code>true</code> ，否则返回 <code>false</code> 。<code>getOwnPropertyDescriptor</code> 陷阱函数则只接受 <code>trapTarget</code> 与 <code>key</code> 这两个参数，并会返回对应的描述符。 <code>Reflect.defineProperty()</code> 与 <code>Reflect.getOwnPropertyDescriptor()</code> 方法作为上述陷阱函数的对应方法，接受与之相同的参数。</p>
<p><code>defineProperty</code> 陷阱函数要求你返回一个布尔值用于表示操作是否已成功。当它返回 <code>true</code>时， <code>Object.defineProperty()</code> 会正常执行；而如果它返回了 <code>false</code> ，则<code>Object.defineProperty() </code>会抛出错误。 你可以使用该功能来限制哪些属性可以被<code>Object.defineProperty()</code> 方法定义。</p>
<p><code>etOwnPropertyDescriptor</code> 陷阱函数有一个微小差异，要求返回值必须是 <code>null</code> 、<br><code>undefined</code> ，或者是一个对象。如果返回值是一个对象，则只允许该对象拥有 <code>enumerable</code><br>、 <code>configurable</code> 、 <code>value</code> 、 <code>writable</code> 、 <code>get</code> 或 <code>set</code> 这些自有属性</p>
<h3 id="ownKeys陷阱函数"><a href="#ownKeys陷阱函数" class="headerlink" title="ownKeys陷阱函数"></a>ownKeys陷阱函数</h3><p><code>ownKeys</code> 代理陷阱拦截了内部方法 <code>[[OwnPropertyKeys]]</code> ，并允许你返回一个数组用于重写该行为。返回的这个数组会被用于四个方法： <code>Object.keys()</code> 方法、<code>Object.getOwnPropertyNames()</code> 方法、<code>Object.getOwnPropertySymbols()</code>方法与<code>Object.assign()</code> 方法，其中 <code>Object.assign()</code> 方法会使用该数组来决定哪些属性会被复制。</p>
<p><code>ownKeys</code> 陷阱函数接受单个参数，即目标对象，同时必须返回一个数组或者一个类数组对象。你可以使用 <code>ownKeys</code> 陷阱函数去过滤特定的属性，以避免这些属性被<code> Object.keys()</code> 方法、<code> Object.getOwnPropertyNames()</code> 方法、<code>Object.getOwnPropertySymbols()</code> 方法或 <code>Object.assign()</code> 方法使用。</p>
<h3 id="apply与construct陷阱函数"><a href="#apply与construct陷阱函数" class="headerlink" title="apply与construct陷阱函数"></a>apply与construct陷阱函数</h3><p>只有 <code>apply</code> 与 <code>construct</code> 要求代理目标对象必须是一个函数。函数拥有两个内部方法：<code> [[Call]]</code> 与 <code>[[Construct]]</code> ，前者会在函数被直接调用时执行，而后者会在函数被使用 <code>new</code> 运算符调用时执行。 <code>apply</code> 与 <code>construct</code>陷阱函数对应着这两个内部方法，并允许你对其进行重写。<code>apply</code> 陷阱函数会接收到下列三个参数（ <code>Reflect.apply()</code> 也会接收这些参数） ：</p>
<ol>
<li>trapTarget ：被执行的函数（即代理的目标对象） ；</li>
<li>thisArg ：调用过程中函数内部的 this 值；</li>
<li>argumentsList ：被传递给函数的参数数组。</li>
</ol>
<p>当使用 <code>new</code> 去执行函数时， <code>construct</code> 陷阱函数会被调用并接收到下列两个参数：</p>
<ol>
<li>trapTarget ：被执行的函数（即代理的目标对象） ；</li>
<li>argumentsList ：被传递给函数的参数数组。</li>
</ol>
<p><code>Reflect.construct() </code>方法同样会接收到这两个参数，还会收到可选的第三参数 <code>newTarget</code>，如果提供了此参数，则它就指定了函数内部的 <code>new.target</code> 值。</p>
<p>使用apply和construct陷阱函数有这样一些应用场景：</p>
<blockquote>
<p>验证函数的参数</p>
</blockquote>
<p>假如需要保证所有参数都是某个特定类型，可使用 <code>apply</code> 陷阱函数进行验证：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//apply和construct陷阱函数</span><br><span class="line"></span><br><span class="line">let sum = function (arr=[]) &#123;</span><br><span class="line">	return arr.reduce((previous,current)=&gt;previous+current);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let proxy = new Proxy(sum,&#123;</span><br><span class="line">	apply(trapTarget,thisArg,argumentList)&#123;</span><br><span class="line">		argumentList[0].forEach((item)=&gt;&#123;</span><br><span class="line">			if(typeof item != &#x27;number&#x27;)&#123;</span><br><span class="line">				throw new Error(&#x27;不是数字类型&#x27;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">		return Reflect.apply(trapTarget,thisArg,argumentList);</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	construct(trapTarget,argumentList)&#123;</span><br><span class="line">		throw new Error(&#x27;不能使用new&#x27;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>​    </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">console.log(proxy([1,2,3,4])); // 10</span><br><span class="line">console.log(proxy([1, &quot;2&quot;, 3, 4]));//Uncaught Error: 不是数字类型Uncaught Error: 不是数字类型</span><br><span class="line">let result = new proxy(); //Uncaught Error: 不能使用new</span><br></pre></td></tr></table></figure>

<h3 id="可被撤销的代理"><a href="#可被撤销的代理" class="headerlink" title="可被撤销的代理"></a>可被撤销的代理</h3><p>在被创建之后，代理通常就不能再从目标对象上被解绑。有的情况下你可能想撤销一个代理以便让它不能再被使用。当你想通过公共接口向外提供一个安全的对象，并且要求要随时都能切断对某些功能的访问，这种情况下可被撤销的代理就会非常有用。<br>你可以使用<code>Proxy.revocable()</code>方法来创建一个可被撤销的代理，该方法接受的参数与<code>Proxy</code> 构造器的相同：一个目标对象、一个代理处理器，而返回值是包含下列属性的一个对象：</p>
<ol>
<li>proxy ：可被撤销的代理对象；</li>
<li>revoke ：用于撤销代理的函数；</li>
</ol>
<p>当 <code>revoke()</code> 函数被调用后，就不能再对该 <code>proxy</code> 对象进行更多操作。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">let target = &#123;</span><br><span class="line">	name: &quot;target&quot;</span><br><span class="line">&#125;;</span><br><span class="line">let &#123; proxy, revoke &#125; = Proxy.revocable(target, &#123;&#125;);</span><br><span class="line">console.log(proxy.name); // &quot;target&quot;</span><br><span class="line">revoke();</span><br><span class="line">// 抛出错误</span><br><span class="line">console.log(proxy.name);</span><br></pre></td></tr></table></figure>

<p>这个例子创建了一个可被撤销的代理，它对<code>Proxy.revocable()</code>方法返回的对象进行了解构<br>赋值，把同名属性的值赋给了 <code>proxy</code> 与 <code>revoke</code> 变量。此时 <code>proxy</code> 对象和代理的目标对象一样，于是 <code>proxy.name</code> 属性的值就是 <code>&quot;target&quot;</code> ，因为它直接传递了<br><code>target.name</code> 的值。然而一旦<code> revoke()</code> 函数被调用， 代理对象就和所代理的目标对象就解除“绑定”关系，之后试图访问 <code>proxy.name</code> 会抛出错误。</p>
<h3 id="将代理对象作为原型使用"><a href="#将代理对象作为原型使用" class="headerlink" title="将代理对象作为原型使用"></a>将代理对象作为原型使用</h3><p><strong>代理对象可以被作为原型使用，在把代理对象作为原型时，仅当操作的默认行为会按惯例追踪原型时，代理陷阱才会被调用。</strong>因此，将代理对象作为原型时，常见的应用场景有：</p>
<p><strong>1.在原型上使用get陷阱函数</strong></p>
<p>当内部方法 <code>[[Get]]</code> 被调用以读取属性时，该操作首先会查找对象的自有属性；如果指定名称的属性没有找到，则会继续在对象的原型上进行属性查找；这个流程会一直持续到没有原型可供查找为止。得益于这个流程，若你设置了一个 <code>get</code> 代理陷阱，则只有在对象不存在指定名称的自有属性时，该陷阱函数才会在对象的原型上被调用。当所访问的属性无法保证存在时，你可以使用 <code>get</code> 陷阱函数来阻止预期外的行为。例如，创建了一个对象，当你尝试去访问一个不存在的属性时，它会抛出错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//原型上使用get陷阱函数</span><br><span class="line"></span><br><span class="line">let target = &#123;&#125;;</span><br><span class="line">let newTarget  = Object.create(new Proxy(</span><br><span class="line">	target,&#123;</span><br><span class="line">		get(trapTarget,key,receiver)&#123;</span><br><span class="line">			throw new Error(&#x27;不存在该属性&#x27;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">newTarget.name = &#x27;hello world&#x27;;</span><br><span class="line">console.log(newTarget.name); //hello world</span><br><span class="line"></span><br><span class="line">console.log(newTarget.age); //Uncaught Error: 不存在该属性</span><br></pre></td></tr></table></figure>

<p>由于 <code>name</code> 属性存在，所以不会调用 <code>get</code> 陷阱函数，而 <code>age</code> 属性在对象上并不存在，所以，会从原型上去找该属性，因此，会触发 <code>get</code> 陷阱函数，从而抛出错误。</p>
<p><strong>2.在原型上使用 <code>set</code> 陷阱函数</strong></p>
<p>内部方法 <code>[[Set]]</code> 同样会查找对象的自有属性，并在必要时继续对该对象的原型进行查找。当你对一个对象属性进行赋值时，如果指定名称的自有属性存在，值就会被赋在该属性上；而若该自有属性不存在，则会继续检查对象的原型，但默认情况下它会在对象实例（而非原型） 上创建一个新的属性用于赋值，无论同名属性是否存在于原型上。</p>
<p><strong>3.在原型上使用has陷阱函数</strong></p>
<p> <code>has</code> 陷阱函数会拦截对象上 <code>in</code> 运算符的使用。 <code>in</code> 运算符首先查找对象上指定名称的自有属性；如果不存在同名自有属性，则会继续查找对象的原型；如果原型上也不存在同名自有属性，那么就会沿着原型链一直查找下去，直到找到该属性、或者没有更<br>多原型可供查找时为止。<code>has</code> 陷阱函数只在原型链查找触及原型对象的时候才会被调用。</p>
<p><strong>当使用代理作为原型时，这只会在指定名称的自有属性不存在时，才会触发 <code>has</code> 陷阱函数。</strong></p>
<h3 id="将代理作为类的原型"><a href="#将代理作为类的原型" class="headerlink" title="将代理作为类的原型"></a>将代理作为类的原型</h3><p>代理对象不能直接作为类的原型，因为类的 <code>prototype</code> 属性是不可写入的。但是，可以使用继承来实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//代理对象作为类的原型</span><br><span class="line"></span><br><span class="line">function NoSuchProperty() &#123;</span><br><span class="line">	// empty</span><br><span class="line">&#125; </span><br><span class="line">NoSuchProperty.prototype = new Proxy(&#123;&#125;, &#123;</span><br><span class="line">	get(trapTarget, key, receiver) &#123;</span><br><span class="line">		throw new ReferenceError(`$&#123;key&#125; doesn&#x27;t exist`);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">class Square extends NoSuchProperty &#123;</span><br><span class="line">	constructor(length, width) &#123;</span><br><span class="line">		super();</span><br><span class="line">		this.length = length;</span><br><span class="line">		this.width = width;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line">let shape = new Square(2, 6);</span><br><span class="line">let area1 = shape.length * shape.width;</span><br><span class="line">console.log(area1); // 12</span><br><span class="line">// 由于 &quot;wdth&quot; 不存在而抛出了错误</span><br><span class="line">let area2 = shape.length * shape.wdth;</span><br></pre></td></tr></table></figure>

<p><code>Square</code> 类继承了 <code>NoSuchProperty</code> 类，因此该代理就被加入了 <code>Square</code> 类的原型链。随后<code>shape</code> 对象被创建为 <code>Square</code> 类的一个实例，让它拥有两个属性： <code>length</code> 与 <code>width</code> 。由于 <code>get</code> 陷阱函数永远不会被调用，因此能够成功读取这两个属性的值。只有访问 <code>shape</code> 上不存在的属性时（例如这里的 <code>shape.wdth</code> 拼写错误） ，才触发了 <code>get</code> 陷阱函数并导致错误被抛出。</p>
<h3 id="总结-9"><a href="#总结-9" class="headerlink" title="总结"></a>总结</h3><ol>
<li>在 ES6 之前，特定对象（例如数组） 会显示出一些非常规的、无法被开发者复制的行为，而代理的出现改变了这种情况。代理允许你为一些 JS 底层操作自行定义非常规行为，因此你就可以通过代理陷阱来复制 JS 内置对象的所有行为。在各种不同操作发生时（例如对于 <code>in</code>运算符的使用） ，这些代理陷阱会在后台被调用。</li>
<li>反射接口也是在 ES6 中引入的，允许开发者为每个代理陷阱实现默认的行为。每个代理陷阱在 <code>Reflect</code> 对象（ES6 的另一个新特性） 上都有一个同名的对应方法。将代理陷阱与反射接口方法结合使用，就可以在特定条件下让一些操作有不同的表现，有别于默认的内置行为。</li>
<li>可被撤销的代理是一种特殊的代理，可以使用 <code>revoke()</code> 函数去有效禁用。 <code>revoke()</code> 函数终结了代理的所有功能，因此在它被调用之后，所有与代理属性交互的意图都会导致抛出错误。</li>
<li>尽管直接使用代理是最有力的使用方式，但你也可以把代理用作另一个对象的原型。但只有很少的代理陷阱能在作为原型的代理上被有效使用，包括 <code>get</code> 、 <code>set</code> 与 <code>has</code> 这几个，这让这方面的用例变得十分有限</li>
</ol>
<h3 id="案例-6"><a href="#案例-6" class="headerlink" title="案例"></a>案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //set陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	name:&#x27;target&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	set(tarpTarget,key,value,receiver)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		if(!tarpTarget.hasOwnProperty(key))&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			if(isNaN(value))&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 				throw new Error(&#x27;property must be number&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return Reflect.set(tarpTarget,key,value,receiver);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// proxy.msg=&#x27;hello proxy&#x27;; //Uncaught Error: property must be number</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //get陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target=&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	name:&#x27;hello world&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		get(tarpTarget,key,receiver)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			if(!(key in tarpTarget))&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 				throw new Error(&#x27;不存在该对象&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return Reflect.get(tarpTarget,key,receiver);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.name); //hello world</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.age); // Uncaught Error: 不存在该对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //has陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	value:&#x27;hello world&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	has(tarpTarget,key)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		if(Object.is(key,&#x27;value&#x27;))&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return false;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		Reflect.has(tarpTarget,key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(&#x27;value&#x27; in proxy); //false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//deleteProperty陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	name: &quot;target&quot;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	value: 42</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	deleteProperty(trapTarget, key) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		if (key === &quot;value&quot;) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return false;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125; else &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			return Reflect.deleteProperty(trapTarget, key);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// // 尝试删除 proxy.value</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(&quot;value&quot; in proxy); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let result1 = delete proxy.value;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(result1); // false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //原型代理上的陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	getPrototypeOf(trapTarget) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return null;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	setPrototypeOf(trapTarget, proto) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return false;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let targetProto = Object.getPrototypeOf(target);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxyProto = Object.getPrototypeOf(proxy);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(targetProto === Object.prototype); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxyProto === Object.prototype); // false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxyProto); // null</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// // 成功</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Object.setPrototypeOf(target, &#123;&#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// // 抛出错误</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Object.setPrototypeOf(proxy, &#123;&#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//对象可扩展性的陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(target, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	isExtensible(trapTarget) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return Reflect.isExtensible(trapTarget);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	preventExtensions(trapTarget) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Object.isExtensible(target)); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Object.isExtensible(proxy)); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Object.preventExtensions(proxy);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Object.isExtensible(target)); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(Object.isExtensible(proxy)); // true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//defineProperty</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(&#123;&#125;, &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	defineProperty(trapTarget, key, descriptor) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	if (!isNaN(key)) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return false;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return Reflect.defineProperty(trapTarget, key, descriptor);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Object.defineProperty(proxy,&#x27;name&#x27;,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	value:&#x27;hello world&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.name); // &quot;proxy&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// Object.defineProperty(proxy,&#x27;age&#x27;,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	value:20</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.age); // &quot;proxy&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// //apply和construct陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let sum = function (arr=[]) &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	return arr.reduce((previous,current)=&gt;previous+current);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let proxy = new Proxy(sum,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	apply(trapTarget,thisArg,argumentList)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		argumentList[0].forEach((item)=&gt;&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			if(typeof item != &#x27;number&#x27;)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 				throw new Error(&#x27;不是数字类型&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;)</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		return Reflect.apply(trapTarget,thisArg,argumentList);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;,</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	construct(trapTarget,argumentList)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		throw new Error(&#x27;不能使用new&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy([1,2,3,4])); // 10</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy([1, &quot;2&quot;, 3, 4]));//Uncaught Error: 不是数字类型Uncaught Error: 不是数字类型</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let result = new proxy(); //Uncaught Error: 不能使用new</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//可被插销的代理</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	name: &quot;target&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// &#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let &#123; proxy, revoke &#125; = Proxy.revocable(target, &#123;&#125;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.name); // &quot;target&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// revoke();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// // 抛出错误</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(proxy.name);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//原型上使用get陷阱函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let target = &#123;&#125;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// let newTarget  = Object.create(new Proxy(</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	target,&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		get(trapTarget,key,receiver)&#123;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 			throw new Error(&#x27;不存在该属性&#x27;);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 		&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 	&#125;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// ));</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// newTarget.name = &#x27;hello world&#x27;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(newTarget.name); //hello world</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// console.log(newTarget.age); //Uncaught Error: 不存在该属性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">//代理对象作为类的原型</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">function</span> <span class="title function_">NoSuchProperty</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="comment">// empty</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125; </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="title class_">NoSuchProperty</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="title function_">get</span>(<span class="params">trapTarget, key, receiver</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ReferenceError</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> doesn&#x27;t exist`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_ inherited__">NoSuchProperty</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="title function_">constructor</span>(<span class="params">length, width</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="variable language_">super</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="variable language_">this</span>.<span class="property">length</span> = length;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="variable language_">this</span>.<span class="property">width</span> = width;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125; </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> shape = <span class="keyword">new</span> <span class="title class_">Square</span>(<span class="number">2</span>, <span class="number">6</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> area1 = shape.<span class="property">length</span> * shape.<span class="property">width</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="variable language_">console</span>.<span class="title function_">log</span>(area1); <span class="comment">// 12</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="comment">// 由于 &quot;wdth&quot; 不存在而抛出了错误</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">let</span> area2 = shape.<span class="property">length</span> * shape.<span class="property">wdth</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>





<h2 id="什么是模块？"><a href="#什么是模块？" class="headerlink" title="什么是模块？"></a>什么是模块？</h2><p>模块（Modules ） 是使用不同方式加载的 JS 文件（与 JS 原先的脚本加载方式相对） 。这种不同模式很有必要，因为它与脚本（script ） 有大大不同的语义：</p>
<ol>
<li>模块代码自动<strong>运行在严格模式</strong>下，并且没有任何办法跳出严格模式；</li>
<li>在模块的顶级作用域创建的变量，<strong>不会被自动添加到共享的全局作用域</strong>，它们只会在<strong>模块顶级作用域</strong>的内部存在；</li>
<li>模块顶级作用域的 <code>this</code> 值为 <code>undefined</code> ；</li>
<li>模块不允许在代码中使用 HTML 风格的注释（这是 JS 来自于早期浏览器的历史遗留特性） ；</li>
<li>对于需要让模块外部代码访问的内容，模块必须导出它们；</li>
<li>允许模块从其他模块导入绑定；</li>
</ol>
<h3 id="基本的导出"><a href="#基本的导出" class="headerlink" title="基本的导出"></a>基本的导出</h3><p>可以使用 <code>export</code> 关键字将已发布代码部分公开给其他模块。最简单方法就是将 <code>export</code>放置在<strong>任意变量、函数或类声明</strong>之前：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 导出数据</span><br><span class="line">export var color = &quot;red&quot;;</span><br><span class="line">export let name = &quot;Nicholas&quot;;</span><br><span class="line">export const magicNumber = 7;</span><br><span class="line">// 导出函数</span><br><span class="line">export function sum(num1, num2) &#123;</span><br><span class="line">		return num1 + num1;</span><br><span class="line">&#125; </span><br><span class="line">// 导出类</span><br><span class="line">export class Rectangle &#123;</span><br><span class="line">	constructor(length, width) &#123;</span><br><span class="line">	this.length = length;</span><br><span class="line">	this.width = width;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line">// 此函数为模块私有</span><br><span class="line">function subtract(num1, num2) &#123;</span><br><span class="line">		return num1 - num2;</span><br><span class="line">&#125; </span><br><span class="line">// 定义一个函数……</span><br><span class="line">function multiply(num1, num2) &#123;</span><br><span class="line">		return num1 * num2;</span><br><span class="line">&#125; </span><br><span class="line">// ……导出一个函数引用</span><br><span class="line">export &#123; multiply &#125;;</span><br></pre></td></tr></table></figure>

<p>此例中有几点需要注意。首先，除了 <code>export</code> 关键字之外，每个声明都与正常形式完全一样。<strong>每个被导出的函数或类都有名称，这是因为导出的函数声明与类声明必须要有名称</strong>。你不能使用这种语法来导出匿名函数或匿名类，除非使用了 <code>default</code> 关键字 。其次，细看一下 <code>multiply()</code> 函数，它并没有在定义时被导出。这是因为你不仅能导出声明，还可以导出引用（即代码最后一行） 。最后请注意，此例并未导出<code>subtract()</code> 函数。此函数在模块外部不可访问，因为任意没有被显式导出的变量、函数或类都会在模块内保持私有。</p>
<h3 id="基本的导入"><a href="#基本的导入" class="headerlink" title="基本的导入"></a>基本的导入</h3><p>一旦你有了包含导出的模块，就能在其他模块内使用 <code>import</code> 关键字来访问已被导出的功能。 import 语句有两个部分，<strong>一是需要导入的标识符，二是需导入的标识符</strong>的来源模块。此处是导入语句的基本形式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; identifier1, identifier2 &#125; from &quot;./example.js&quot;;</span><br></pre></td></tr></table></figure>

<p>在 <code>import</code> 之后的花括号指明了从给定模块导入对应的绑定， <code>from</code> 关键字则指明了需要导入的模块。模块由一个表示模块路径的字符串（被称为模块说明符， module specifier ） 来指定。</p>
<p>当从模块导入了一个绑定时，该绑定表现得就像使用了 <code>const</code> 的定义。这意味着你不能再定义另一个同名变量（包括导入另一个同名绑定） ，也不能在对应的 <code>import</code> 语句之前使用此标识符（也就是要受暂时性死区限制） ，更不能修改它的值。</p>
<blockquote>
<p>导入单个绑定</p>
</blockquote>
<p>实现导入单个绑定时，仅仅只需要使用一个标识符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 单个导入</span><br><span class="line">import &#123; sum &#125; from &quot;./example.js&quot;;</span><br><span class="line">console.log(sum(1, 2)); // 3</span><br><span class="line">sum = 1; // 出错</span><br></pre></td></tr></table></figure>

<p>对于已导入的绑定再重新赋值，则会导致错误。</p>
<blockquote>
<p>导入多个绑定</p>
</blockquote>
<p>如果你想从 <code>example</code> 模块导入多个绑定，你可以像下面这样显式的列出它们：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 多个导入</span><br><span class="line">import &#123; sum, multiply, magicNumber &#125; from &quot;./example.js&quot;;</span><br><span class="line">console.log(sum(1, magicNumber)); // 8</span><br><span class="line">console.log(multiply(1, 2)); // 2</span><br></pre></td></tr></table></figure>

<p>此处从 <code>example</code> 模块导入了三个绑定： <code>sum</code> 、 <code>multiply</code> 与 <code>magicNumber</code> 。</p>
<blockquote>
<p>完全导入一个模块</p>
</blockquote>
<p>还有一种特殊情况，即允许你将整个模块当作单一对象进行导入，该<strong>模块的所有导出都会作为对象的属性存在</strong>。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 完全导入</span><br><span class="line">import * as example from &quot;./example.js&quot;;</span><br><span class="line">console.log(example.sum(1,</span><br><span class="line">example.magicNumber)); // 8</span><br><span class="line">console.log(example.multiply(1, 2)); // 2</span><br></pre></td></tr></table></figure>

<p>在此代码中， <code>example.js</code> 中所有导出的绑定都被加载到一个名为 <code>example</code> 的对象中，具名导出（ <code>sum()</code> 函数、 <code>multiple()</code> 函数与 <code>magicNumber</code> ） 都成为 <code>example</code> 的<strong>可用属性</strong>。这种导入格式被称为命名空间导入（namespace import ） ，这是因为该 <code>example</code> 对象并不存在于 <code>example.js</code> 文件中，而是作为一个命名空间对象被创建使用，其中包含了<code>example.js</code> 的所有导出成员。</p>
<p><strong>需要注意的是：无论对同一个模块使用了多少次 <code>import</code> 语句，该模块都只会被执行一次。在导出模块的代码执行之后，已被实例化的模块就被保留在内存中，并随时都能被其他 <code>import</code> 所引用</strong></p>
<blockquote>
<p>导入绑定无法修改原始值</p>
</blockquote>
<p>ES6 的 <code>import</code> 语句为变量、函数与类创建了只读绑定，而不像普通变量那样简单引用了原始绑定。<strong>尽管导入绑定的模块无法修改绑定的值，但是可以在导出模块中对原始值做出修改，导入绑定会自动反映出修改的变化</strong>，例如：</p>
<p>导出模块：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export var name = &quot;Nicholas&quot;;</span><br><span class="line">export function setName(newName) &#123;</span><br><span class="line">	name = newName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>导入模块：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#123; name, setName &#125; from &quot;./example.js&quot;;</span><br><span class="line">console.log(name); // &quot;Nicholas&quot;</span><br><span class="line">setName(&quot;Greg&quot;);</span><br><span class="line">console.log(name); // &quot;Greg&quot;</span><br><span class="line">name = &quot;Nicholas&quot;; // error</span><br></pre></td></tr></table></figure>

<p>调用 <code>setName(&quot;Greg&quot;</code>) 会回到导出 <code>setName()</code> 的模块内部，并在那里执行，从而将 <code>name</code> 设置为 “<code>Greg</code>“ 。注意这个变化会自动反映到所导入的 <code>name</code> 绑定上。</p>
<h3 id="重命名的导出与导入"><a href="#重命名的导出与导入" class="headerlink" title="重命名的导出与导入"></a>重命名的导出与导入</h3><blockquote>
<p>在导出模块中进行重命名</p>
</blockquote>
<p>如果想用不同的名称来导出，可以使用 <code>as</code> 关键字来定义新的名称：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function sum(num1, num2) &#123;</span><br><span class="line">	return num1 + num2;</span><br><span class="line">&#125; </span><br><span class="line">export &#123; sum as add &#125;;</span><br></pre></td></tr></table></figure>

<p>此处的 <code>sum()</code> 函数被作为 <code>add()</code> 导出，前者是<strong>本地名称（local name ）</strong> ，后者则是<strong>导出名称（exported name ）</strong> 。这意味着当另一个模块要导入此函数时，它必须改用 <code>add</code> 这个名称：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;add&#125; from &#x27;./example.js&#x27;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在导入时重命名</p>
</blockquote>
<p>在导入时同样可以使用 <code>as</code> 关键字进行重命名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; add as sum &#125; from &#x27;./example.js&#x27;</span><br><span class="line">console.log(typeof add); // &quot;undefined&quot;</span><br><span class="line">console.log(sum(1, 2)); // 3</span><br></pre></td></tr></table></figure>

<p>此代码导入了<code> add(</code>) 函数，并使用了导入名称（import name ） 将其重命名为 <code>sum()</code>（本地名称） 。这意味着在此模块中并不存在名为 <code>add</code> 的标识符。</p>
<h3 id="模块的默认值"><a href="#模块的默认值" class="headerlink" title="模块的默认值"></a>模块的默认值</h3><p>模块的默认值（ default value ） 是使用 <code>default</code> 关键字所指定的单个变量、函数或类，而你在每个模块中<strong>只能设置一个默认导出</strong>，将 <code>default</code> 关键字用于多个导出会是语法错误。</p>
<h4 id="导出默认值"><a href="#导出默认值" class="headerlink" title="导出默认值"></a>导出默认值</h4><p>导出默认值一共有三种形式：</p>
<blockquote>
<ol>
<li>不使用标识符</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export default function(num1,num2)&#123;</span><br><span class="line">	return num1+num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此模块将一个函数作为默认值进行了导出， <code>default</code> 关键字标明了这是一个默认导出，此函数并不需要有名称。</p>
<blockquote>
<ol start="2">
<li>使用标识符</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function sum(num1, num2) &#123;</span><br><span class="line">	return num1 + num2;</span><br><span class="line">&#125; </span><br><span class="line">export default sum;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="3">
<li>使用重命名语法</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function sum(num1, num2) &#123;</span><br><span class="line">	return num1 + num2;</span><br><span class="line">&#125; </span><br><span class="line">export &#123;sum as default&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="4">
<li>既导出了默认值，又导出非默认值</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export let color = &#x27;red&#x27;;</span><br><span class="line">export default function(num1,num2)&#123;</span><br><span class="line">	return num1+num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="导入默认值"><a href="#导入默认值" class="headerlink" title="导入默认值"></a>导入默认值</h4><blockquote>
<p>只导入默认值</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import sum from &#x27;./example.js&#x27;;</span><br><span class="line">console.log(sum(1,2));</span><br></pre></td></tr></table></figure>

<p>这个导入语句从 <code>example.js</code> 模块导入了其默认值。与之前在非默认的导入中看到的不同,注意此处并未使用花括号。本地名称 <code>sum</code> 被用于代表目标模块所默认导出的函数。</p>
<blockquote>
<p>既导入默认值，又导入非默认值</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sum, &#123; color &#125; from &#x27;./example.js&#x27;;</span><br><span class="line">console.log(sum(1,2));</span><br><span class="line">console.log(color);</span><br></pre></td></tr></table></figure>

<p><strong>逗号将默认的本地名称与非默认的名称分隔开，非默认值仍旧被花括号所包裹。要记住在 <code>import</code> 语句中默认名称必须位于非默认名称之前。</strong></p>
<blockquote>
<p>对导入默认值重命名</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import &#123;default as sum, color&#125; from &#x27;./example.js&#x27;</span><br><span class="line"></span><br><span class="line">console.log(sum(1,2));</span><br><span class="line">console.log(color);</span><br></pre></td></tr></table></figure>

<p>在此代码中，默认的导出（ <code>default</code> ） 被重命名为 <code>sum</code> ，并且附加的 <code>color</code> 导出也被一并导入了。</p>
<h4 id="对已导入的内容再导出"><a href="#对已导入的内容再导出" class="headerlink" title="对已导入的内容再导出"></a>对已导入的内容再导出</h4><p>如果在当前模块中对已导入的内容在导出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export &#123;sum&#125; from &#x27;./example.js&#x27;;</span><br></pre></td></tr></table></figure>

<p>这种形式的 <code>export</code> 会进入指定模块查看 sum 的定义，随后将其导出。在导出时同样也可以进行重命名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export &#123; sum as add &#125; from &#x27;./example.js&#x27;</span><br></pre></td></tr></table></figure>

<p>如果想将<code>另一个模块</code>中的所有值完全导出，可以使用 <code>*</code> 号模式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export * from &#x27;./example.js&#x27;;</span><br></pre></td></tr></table></figure>

<p>用完全导出，就可以导出目标模块的默认值及其所有具名导出，但这可能影响你从当前模<br>块所能导出的值。例如，假设 example.js 具有一个默认导出，当你使用这种语法时，你就无法为当前模块另外再定义一个默认导出。</p>
<h4 id="无绑定的导入"><a href="#无绑定的导入" class="headerlink" title="无绑定的导入"></a>无绑定的导入</h4><p>有些模块也许没有进行任何导出，相反只是<strong>修改全局作用域的对象</strong>。尽管这种模块的<strong>顶级变量、函数或类最终并不会自动被加入全局作用域</strong>，但这并不意味着该模块无法访问全局作用域。诸如 <code>Array</code> 与 <code>Object</code> 之类的内置对象的共享定义在模块内部是可访问的，并且对于这些对象的修改会反映到其他模块中。</p>
<h4 id="总结-10"><a href="#总结-10" class="headerlink" title="总结"></a>总结</h4><ol>
<li>ES6 为 JS 语言添加了模块，作为打包与封装功能的方式。模块的行为异于脚本，它们<strong>不会用自身顶级作用域的变量、函数或类去修改全局作用域</strong>，而模块的 <code>this</code> 值为 <code>undefined</code> ；</li>
<li>可以在模块中使用 <code>export</code> 关键字<strong>导出，变量、函数与类都可以</strong>，并且每个模块允许存在一个<strong>默认导出</strong>。在导出之后，另一个模块就能导入该模块所导出的一个或多个导出值。这些导入的名称就像是被 <code>const</code> 所定义的，会被当作块级绑定，并且不允在同一模块内重复声明；</li>
<li>由于模块必须用与脚本不同的方式运行，浏览器就引入了 <code>&lt;script type=&quot;module&quot;&gt;</code> ，以表示资源文件或内联代码需要作为模块来执行。使用 <script type="module"> 加载的模块文件会默认应用 <code>defer</code> 属性。一旦包含模块的页面文档完全被解析，模块就会按照它们在文档中的出现顺序依次执行。</li>
</ol>
<h2 id="ES7-预览"><a href="#ES7-预览" class="headerlink" title="ES7 预览"></a>ES7 预览</h2><ul>
<li>数组<ul>
<li><code>arr.includes()</code> 数组是否包含某个东西</li>
<li>数组的 arr.keys(), arr,entries()</li>
<li>for … in 遍历数组 下标 key</li>
<li>for … of 遍历数组 值 value, 不能用于json</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">includes</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i) <span class="comment">// 循环的时下标 key</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i) <span class="comment">// 循环的是值 value</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr.<span class="title function_">keys</span>()) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&gt;&#x27;</span>+i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> arr.<span class="title function_">entries</span>()) &#123;	<span class="comment">//结构赋值</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&gt;&#x27;</span> + key + value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> json = &#123; <span class="attr">a</span>: <span class="number">12</span>, <span class="attr">b</span>: <span class="number">5</span>, <span class="attr">c</span>: <span class="number">7</span> &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> json) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>数字<ul>
<li>求幂  3**8   代表：3的8次方</li>
</ul>
</li>
<li>字符串<ul>
<li>padStart()/padEnd() 指定宽度，不够就补空格或指定字符</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;=&#x27;</span> + <span class="string">&#x27;abcd&#x27;</span>.<span class="title function_">padStart</span>(<span class="number">6</span>, <span class="string">&#x27;0&#x27;</span>) + <span class="string">&#x27;=&#x27;</span>)	<span class="comment">//补几位  第二个参数补什么东西</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;=&#x27;</span> + <span class="string">&#x27;abcd&#x27;</span>.<span class="title function_">padEnd</span>(<span class="number">6</span>, <span class="string">&#x27;0&#x27;</span>) + <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">=00abcd=</span><br><span class="line">=abcd00=</span><br></pre></td></tr></table></figure>

<ul>
<li>容忍度<ul>
<li>[1, 2, 3,] 老版数组最后不能有逗号，新的可以有</li>
<li>函数参数最后多的逗号也可以</li>
</ul>
</li>
<li>async await<ul>
<li>和 generator yield 类似</li>
<li>generator 不可以写成箭头函数， async 可以</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">await</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1148567490@qq.com">Mc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mcweblog.com/2019/06/28/ES6/">https://mcweblog.com/2019/06/28/ES6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mcweblog.com" target="_blank">My Web Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JavaScript%E6%96%B0%E8%AF%AD%E6%B3%95/">JavaScript新语法</a></div><div class="post_share"><div class="social-share" data-image="https://miaochen.mcweblog.com/img%2Fwq5m26.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/06/28/ES7/"><img class="prev-cover" src="https://miaochen.mcweblog.com/img%2Fwq5m26.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ES7</div></div></a></div><div class="next-post pull-right"><a href="/2019/06/27/css%E5%9F%BA%E7%A1%80/"><img class="next-cover" src="https://miaochen.mcweblog.com/img%2Fwq5m26.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CSS基础</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/06/28/ES7/" title="ES7"><img class="cover" src="https://miaochen.mcweblog.com/img%2Fwq5m26.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-06-28</div><div class="title">ES7</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://miaochen.mcweblog.com/img%2F2020_09_11_22_32_IMG_6232.JPG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Mc</div><div class="author-info__description">Have a nice day!</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/miaonima123" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1148567490@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Building...😓</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript%E7%9A%84ES6%E6%80%8E%E4%B9%88%E6%9D%A5%E7%9A%84"><span class="toc-number">1.</span> <span class="toc-text">JavaScript的ES6怎么来的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-number">2.</span> <span class="toc-text">ES6兼容性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#let%E5%A3%B0%E6%98%8E"><span class="toc-number">2.1.</span> <span class="toc-text">let声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#const%E5%A3%B0%E6%98%8E"><span class="toc-number">2.2.</span> <span class="toc-text">const声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#let%E4%B8%8Econst%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">2.3.</span> <span class="toc-text">let与const的比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#console-log-window-RegExp-RegExp-RegExp%E8%A6%86%E7%9B%96%E6%8E%89window%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84RegExp%E5%B1%9E%E6%80%A7"><span class="toc-number">3.</span> <span class="toc-text">console.log(window.RegExp&#x3D;&#x3D;&#x3D;RegExp); &#x2F;&#x2F;RegExp覆盖掉window对象中的RegExp属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%97%E7%BA%A7%E7%BB%91%E5%AE%9A%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">3.1.</span> <span class="toc-text">块级绑定的使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">3.2.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">3.3.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">字符串处理方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="toc-number">4.1.</span> <span class="toc-text">模板字面量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%A0%87%E7%AD%BE"><span class="toc-number">4.2.</span> <span class="toc-text">模板标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%94%B9%E5%8A%A8"><span class="toc-number">4.3.</span> <span class="toc-text">正则表达式的改动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-1"><span class="toc-number">4.4.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9B%B8%E5%85%B3"><span class="toc-number">5.</span> <span class="toc-text">函数相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">剩余参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.2.</span> <span class="toc-text">扩展运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#new-target%E5%B1%9E%E6%80%A7"><span class="toc-number">5.3.</span> <span class="toc-text">new.target属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%97%E7%BA%A7%E5%87%BD%E6%95%B0"><span class="toc-number">5.4.</span> <span class="toc-text">块级函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="toc-number">5.5.</span> <span class="toc-text">箭头函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%BE%E8%B0%83%E7%94%A8%E4%BC%98%E5%8C%96"><span class="toc-number">5.6.</span> <span class="toc-text">尾调用优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-2"><span class="toc-number">5.7.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%88%AB"><span class="toc-number">6.</span> <span class="toc-text">对象类别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%AD%97%E9%9D%A2%E9%87%8F%E8%AF%AD%E6%B3%95%E7%9A%84%E6%89%A9%E5%B1%95"><span class="toc-number">6.1.</span> <span class="toc-text">对象字面量语法的扩展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E5%BC%BA%E5%A4%A7%E7%9A%84%E5%8E%9F%E5%9E%8B"><span class="toc-number">6.2.</span> <span class="toc-text">更强大的原型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">6.3.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-3"><span class="toc-number">6.4.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84"><span class="toc-number">7.</span> <span class="toc-text">解构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84"><span class="toc-number">7.1.</span> <span class="toc-text">数组结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%84"><span class="toc-number">7.2.</span> <span class="toc-text">参数解构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">7.3.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">7.4.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Symbol%E5%9F%BA%E7%A1%80"><span class="toc-number">8.</span> <span class="toc-text">Symbol基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%AC%A6%E5%8F%B7%E5%80%BC"><span class="toc-number">8.1.</span> <span class="toc-text">创建符号值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%A6%E5%8F%B7%E5%80%BC"><span class="toc-number">8.2.</span> <span class="toc-text">使用符号值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E5%80%BC%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.3.</span> <span class="toc-text">符号值的转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E7%AC%A6%E5%8F%B7%E5%B1%9E%E6%80%A7"><span class="toc-number">8.4.</span> <span class="toc-text">检索符号属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E5%90%8D%E7%AC%A6%E5%8F%B7"><span class="toc-number">9.</span> <span class="toc-text">知名符号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-hasInstance%E5%B1%9E%E6%80%A7"><span class="toc-number">9.1.</span> <span class="toc-text">Symbol.hasInstance属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-isConcatSpreadable%E5%B1%9E%E6%80%A7"><span class="toc-number">9.2.</span> <span class="toc-text">Symbol.isConcatSpreadable属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-toPrimitive"><span class="toc-number">9.3.</span> <span class="toc-text">Symbol.toPrimitive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-toStringTag"><span class="toc-number">9.4.</span> <span class="toc-text">Symbol.toStringTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbol-unscopables"><span class="toc-number">9.5.</span> <span class="toc-text">Symbol.unscopables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-3"><span class="toc-number">9.6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-1"><span class="toc-number">9.7.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6%E4%B8%AD%E7%9A%84Set"><span class="toc-number">10.</span> <span class="toc-text">ES6中的Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6%E4%B8%AD%E7%9A%84Map"><span class="toc-number">11.</span> <span class="toc-text">ES6中的Map</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-4"><span class="toc-number">11.1.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-2"><span class="toc-number">11.2.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">12.</span> <span class="toc-text">迭代器和迭代器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">12.1.</span> <span class="toc-text">生成器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%AF%B9%E8%B1%A1%E4%B8%8Efor-of%E5%BE%AA%E7%8E%AF"><span class="toc-number">12.2.</span> <span class="toc-text">可迭代对象与for-of循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">12.3.</span> <span class="toc-text">内置的迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">12.4.</span> <span class="toc-text">迭代器高级功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">12.5.</span> <span class="toc-text">异步任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-5"><span class="toc-number">12.6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-3"><span class="toc-number">12.7.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E8%8D%90blue%E8%80%81%E5%B8%88%E7%9A%84%E5%BA%93%E6%BA%90%E7%A0%81%E2%80%94"><span class="toc-number">12.8.</span> <span class="toc-text">推荐blue老师的库源码—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="toc-number">13.</span> <span class="toc-text">类的声明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">13.1.</span> <span class="toc-text">类表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E9%87%8D%E8%A6%81%E8%A6%81%E7%82%B9"><span class="toc-number">13.2.</span> <span class="toc-text">类的重要要点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1"><span class="toc-number">13.3.</span> <span class="toc-text">继承内置对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-6"><span class="toc-number">13.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%96%B0%E6%96%B9%E6%B3%95"><span class="toc-number">14.</span> <span class="toc-text">数组新方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#find-%E5%92%8CfindIndex-%E6%96%B9%E6%B3%95"><span class="toc-number">14.1.</span> <span class="toc-text">find()和findIndex()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fill-%E6%96%B9%E6%B3%95"><span class="toc-number">14.2.</span> <span class="toc-text">fill()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#copyWithin-%E6%96%B9%E6%B3%95"><span class="toc-number">14.3.</span> <span class="toc-text">copyWithin()方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-4"><span class="toc-number">14.4.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8C%96%E6%95%B0%E7%BB%84"><span class="toc-number">15.</span> <span class="toc-text">类型化数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">15.1.</span> <span class="toc-text">数值数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">15.2.</span> <span class="toc-text">数组缓冲区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE%E6%93%8D%E4%BD%9C%E6%95%B0%E7%BB%84%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">15.3.</span> <span class="toc-text">使用视图操作数组缓冲区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8C%96%E6%95%B0%E7%BB%84%E5%B0%B1%E6%98%AF%E8%A7%86%E5%9B%BE"><span class="toc-number">15.4.</span> <span class="toc-text">类型化数组就是视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8C%96%E6%95%B0%E7%BB%84%E4%B8%8E%E5%B8%B8%E8%A7%84%E6%95%B0%E7%BB%84%E7%9A%84%E7%9B%B8%E4%BC%BC%E7%82%B9"><span class="toc-number">15.5.</span> <span class="toc-text">类型化数组与常规数组的相似点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8C%96%E6%95%B0%E7%BB%84%E4%B8%8E%E5%B8%B8%E8%A7%84%E6%95%B0%E7%BB%84%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">15.6.</span> <span class="toc-text">类型化数组与常规数组的差异</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-7"><span class="toc-number">15.7.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Promise%E5%9F%BA%E7%A1%80"><span class="toc-number">16.</span> <span class="toc-text">Promise基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Promise%E9%93%BE"><span class="toc-number">16.1.</span> <span class="toc-text">Promise链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%A4%9A%E4%B8%AAPromise"><span class="toc-number">16.2.</span> <span class="toc-text">响应多个Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BFPromise"><span class="toc-number">16.3.</span> <span class="toc-text">继承Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-8"><span class="toc-number">16.4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-5"><span class="toc-number">16.5.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%B0%84"><span class="toc-number">17.</span> <span class="toc-text">代理和反射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.1.</span> <span class="toc-text">常用陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.2.</span> <span class="toc-text">基本陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E4%BB%A3%E7%90%86%E4%B8%8A%E7%9A%84%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.3.</span> <span class="toc-text">原型代理上的陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6%E7%9A%84%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.4.</span> <span class="toc-text">属性描述符的陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ownKeys%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.5.</span> <span class="toc-text">ownKeys陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apply%E4%B8%8Econstruct%E9%99%B7%E9%98%B1%E5%87%BD%E6%95%B0"><span class="toc-number">17.6.</span> <span class="toc-text">apply与construct陷阱函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%A2%AB%E6%92%A4%E9%94%80%E7%9A%84%E4%BB%A3%E7%90%86"><span class="toc-number">17.7.</span> <span class="toc-text">可被撤销的代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E5%8E%9F%E5%9E%8B%E4%BD%BF%E7%94%A8"><span class="toc-number">17.8.</span> <span class="toc-text">将代理对象作为原型使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E4%BB%A3%E7%90%86%E4%BD%9C%E4%B8%BA%E7%B1%BB%E7%9A%84%E5%8E%9F%E5%9E%8B"><span class="toc-number">17.9.</span> <span class="toc-text">将代理作为类的原型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-9"><span class="toc-number">17.10.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-6"><span class="toc-number">17.11.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%A8%A1%E5%9D%97%EF%BC%9F"><span class="toc-number">18.</span> <span class="toc-text">什么是模块？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-number">18.1.</span> <span class="toc-text">基本的导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">18.2.</span> <span class="toc-text">基本的导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AF%BC%E5%85%A5"><span class="toc-number">18.3.</span> <span class="toc-text">重命名的导出与导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">18.4.</span> <span class="toc-text">模块的默认值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">18.4.1.</span> <span class="toc-text">导出默认值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">18.4.2.</span> <span class="toc-text">导入默认值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E5%B7%B2%E5%AF%BC%E5%85%A5%E7%9A%84%E5%86%85%E5%AE%B9%E5%86%8D%E5%AF%BC%E5%87%BA"><span class="toc-number">18.4.3.</span> <span class="toc-text">对已导入的内容再导出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E7%BB%91%E5%AE%9A%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">18.4.4.</span> <span class="toc-text">无绑定的导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-10"><span class="toc-number">18.4.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/18/Markdown%E5%AD%A6%E4%B9%A0/" title="Markdown学习"><img src="https://miaochen.mcweblog.com/img%2Fwq5m26.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Markdown学习"/></a><div class="content"><a class="title" href="/2022/07/18/Markdown%E5%AD%A6%E4%B9%A0/" title="Markdown学习">Markdown学习</a><time datetime="2022-07-18T13:19:45.000Z" title="发表于 2022-07-18 21:19:45">2022-07-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/13/JAVA/" title="JAVA"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fovsmw3s3e.bkt.clouddn.com%2F1572417022639620.jpg&amp;refer=http%3A%2F%2Fovsmw3s3e.bkt.clouddn.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1657715811&amp;t=f530c87402ebfc8717a545c931511fe5" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JAVA"/></a><div class="content"><a class="title" href="/2022/06/13/JAVA/" title="JAVA">JAVA</a><time datetime="2022-06-13T12:36:06.000Z" title="发表于 2022-06-13 20:36:06">2022-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/09/%E5%B7%A5%E4%BD%9C%E5%8F%82%E8%80%83/" title="各项参考"><img src="http://miaochen.mcweblog.com/img/wallhaven-4x76mz.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="各项参考"/></a><div class="content"><a class="title" href="/2022/05/09/%E5%B7%A5%E4%BD%9C%E5%8F%82%E8%80%83/" title="各项参考">各项参考</a><time datetime="2022-05-09T13:09:08.000Z" title="发表于 2022-05-09 21:09:08">2022-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/08/%E5%B7%A5%E4%BD%9C%E8%B5%84%E6%96%99%E5%A4%87%E9%98%85/" title="工作相关"><img src="https://w.wallhaven.cc/full/r2/wallhaven-r211q1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="工作相关"/></a><div class="content"><a class="title" href="/2022/05/08/%E5%B7%A5%E4%BD%9C%E8%B5%84%E6%96%99%E5%A4%87%E9%98%85/" title="工作相关">工作相关</a><time datetime="2022-05-08T06:50:42.000Z" title="发表于 2022-05-08 14:50:42">2022-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/10/30/%E5%90%84%E7%A7%8D%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/" title="各种问题总结 😓"><img src="http://miaochen.mcweblog.com/img/202203282025457.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="各种问题总结 😓"/></a><div class="content"><a class="title" href="/2020/10/30/%E5%90%84%E7%A7%8D%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/" title="各种问题总结 😓">各种问题总结 😓</a><time datetime="2020-10-30T08:25:43.000Z" title="发表于 2020-10-30 16:25:43">2020-10-30</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://miaochen.mcweblog.com/img%2Fwq5m26.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Mc</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi,  welcome  to  my  <a  target="_blank" rel="noopener" href="https://mcweblog.gitee.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'UipdkIx78Se1ldhBUTMUbKNI-gzGzoHsz',
      appKey: 'VnOXxB6sC8ORtP3Enqd16rIF',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":145,"height":315},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>